<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>PKCS10RequestMessage.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Unit Test Aggregator</a> &gt; <a href="../index.html" class="el_bundle">cesecore-common</a> &gt; <a href="index.source.html" class="el_package">org.cesecore.certificates.certificate.request</a> &gt; <span class="el_source">PKCS10RequestMessage.java</span></div><h1>PKCS10RequestMessage.java</h1><pre class="source lang-java linenums">/*************************************************************************
 *                                                                       *
 *  CESeCore: CE Security Core                                           *
 *                                                                       *
 *  This software is free software; you can redistribute it and/or       *
 *  modify it under the terms of the GNU Lesser General Public           *
 *  License as published by the Free Software Foundation; either         *
 *  version 2.1 of the License, or any later version.                    *
 *                                                                       *
 *  See terms of license at gnu.org.                                     *
 *                                                                       *
 *************************************************************************/
package org.cesecore.certificates.certificate.request;

import java.io.IOException;
import java.math.BigInteger;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.cert.Certificate;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import org.apache.log4j.Logger;
import org.bouncycastle.asn1.ASN1Encodable;
import org.bouncycastle.asn1.ASN1Set;
import org.bouncycastle.asn1.ASN1String;
import org.bouncycastle.asn1.DERIA5String;
import org.bouncycastle.asn1.pkcs.Attribute;
import org.bouncycastle.asn1.pkcs.PKCSObjectIdentifiers;
import org.bouncycastle.asn1.x500.AttributeTypeAndValue;
import org.bouncycastle.asn1.x500.DirectoryString;
import org.bouncycastle.asn1.x500.RDN;
import org.bouncycastle.asn1.x500.X500Name;
import org.bouncycastle.asn1.x509.Extension;
import org.bouncycastle.asn1.x509.Extensions;
import org.bouncycastle.cms.CMSSignedGenerator;
import org.bouncycastle.operator.ContentVerifierProvider;
import org.bouncycastle.operator.OperatorCreationException;
import org.bouncycastle.pkcs.PKCS10CertificationRequest;
import org.bouncycastle.pkcs.PKCSException;
import org.bouncycastle.pkcs.jcajce.JcaPKCS10CertificationRequest;
import org.cesecore.util.CeSecoreNameStyle;
import org.cesecore.util.CertTools;

/**
 * Class to handle PKCS10 request messages sent to the CA.
 *
 * @version $Id: PKCS10RequestMessage.java 28214 2018-02-08 10:16:53Z anatom $
 */
public class PKCS10RequestMessage implements RequestMessage {
  /**
   * Determines if a de-serialized file is compatible with this class.
   *
   * &lt;p&gt;Maintainers must change this value if and only if the new version of
   * this class is not compatible with old versions. See Sun docs for &lt;a
   * href=http://java.sun.com/products/jdk/1.1/docs/guide
   * /serialization/spec/version.doc.html&gt; details. &lt;/a&gt;
   */
  static final long serialVersionUID = 3597275157018205137L;

  /** Logger. */
<span class="fc" id="L64">  private static final Logger LOG =</span>
<span class="fc" id="L65">      Logger.getLogger(PKCS10RequestMessage.class);</span>

  /** Raw form of the PKCS10 message. */
  protected byte[] p10msg;

  /** manually set password. */
<span class="fc" id="L71">  protected String password = null;</span>

  /** manually set username. */
<span class="fc" id="L74">  protected String username = null;</span>
  /** End date. */
<span class="fc" id="L76">  protected Date notAfter = null;</span>
  /** Start date. */
<span class="fc" id="L78">  protected Date notBefore = null;</span>

  /**
   * If the CA certificate should be included in the response or not, default to
   * true = yes.
   */
<span class="fc" id="L84">  protected boolean includeCACert = true;</span>

  /** preferred digest algorithm to use in replies, if applicable. */
<span class="fc" id="L87">  private transient String preferredDigestAlg = CMSSignedGenerator.DIGEST_SHA1;</span>

  /** The pkcs10 request message, not serialized. */
<span class="fc" id="L90">  protected transient JcaPKCS10CertificationRequest pkcs10 = null;</span>

  /** Type of error. */
<span class="fc" id="L93">  private int error = 0;</span>

  /** Error text. */
<span class="fc" id="L96">  private String errorText = null;</span>

  /** Extra certs. */
<span class="fc" id="L99">  private List&lt;Certificate&gt; additionalCaCertificates =</span>
      new ArrayList&lt;Certificate&gt;();

  /** Extra certs. */
<span class="fc" id="L103">  private List&lt;Certificate&gt; additionalExtraCertsCertificates =</span>
      new ArrayList&lt;Certificate&gt;();

  /** Constructs a new empty PKCS#10 message handler object. */
<span class="fc" id="L107">  public PKCS10RequestMessage() {</span>
    // No constructor
<span class="fc" id="L109">  }</span>

  /**
   * Constructs a new PKCS#10 message handler object.
   *
   * @param msg The DER encoded PKCS#10 request.
   */
<span class="fc" id="L116">  public PKCS10RequestMessage(final byte[] msg) {</span>
<span class="pc bpc" id="L117" title="1 of 2 branches missed.">    if (LOG.isTraceEnabled()) {</span>
<span class="nc" id="L118">      LOG.trace(&quot;&gt;PKCS10RequestMessage(byte[])&quot;);</span>
    }
<span class="fc" id="L120">    this.p10msg = msg;</span>
<span class="fc" id="L121">    init();</span>
<span class="pc bpc" id="L122" title="1 of 2 branches missed.">    if (LOG.isTraceEnabled()) {</span>
<span class="nc" id="L123">      LOG.trace(&quot;&lt;PKCS10RequestMessage(byte[])&quot;);</span>
    }
<span class="fc" id="L125">  }</span>

  /**
   * Constructs a new PKCS#10 message handler object.
   *
   * @param p10 the PKCS#10 request
   * @throws IOException on fail
   */
  public PKCS10RequestMessage(final JcaPKCS10CertificationRequest p10)
<span class="fc" id="L134">      throws IOException {</span>
<span class="pc bpc" id="L135" title="1 of 2 branches missed.">    if (LOG.isTraceEnabled()) {</span>
<span class="nc" id="L136">      LOG.trace(&quot;&gt;PKCS10RequestMessage(ExtendedPKCS10CertificationRequest)&quot;);</span>
    }
<span class="fc" id="L138">    p10msg = p10.getEncoded();</span>
<span class="fc" id="L139">    pkcs10 = p10;</span>
<span class="pc bpc" id="L140" title="1 of 2 branches missed.">    if (LOG.isTraceEnabled()) {</span>
<span class="nc" id="L141">      LOG.trace(&quot;&lt;PKCS10RequestMessage(ExtendedPKCS10CertificationRequest)&quot;);</span>
    }
<span class="fc" id="L143">  }</span>

  private void init() {
<span class="pc bpc" id="L146" title="1 of 2 branches missed.">    if (p10msg == null) {</span>
<span class="nc" id="L147">      throw new NullPointerException(&quot;Cannot initiate with p10msg == null&quot;);</span>
    }
    try {
<span class="fc" id="L150">      pkcs10 = new JcaPKCS10CertificationRequest(p10msg);</span>
<span class="nc" id="L151">    } catch (IOException e) {</span>
<span class="nc" id="L152">      LOG.warn(&quot;PKCS10 not initiated! &quot; + e.getMessage());</span>
<span class="fc" id="L153">    }</span>
<span class="fc" id="L154">  }</span>

  @Override
  public PublicKey getRequestPublicKey()
      throws InvalidKeyException, NoSuchAlgorithmException {
<span class="fc bfc" id="L159" title="All 2 branches covered.">    if (pkcs10 == null) {</span>
<span class="pc bpc" id="L160" title="1 of 2 branches missed.">      if (p10msg != null) {</span>
<span class="nc" id="L161">        init();</span>
      } else {
<span class="fc" id="L163">        return null;</span>
      }
    }
<span class="fc" id="L166">    return pkcs10.getPublicKey();</span>
  }

  /**
   * force a password, i.e. ignore the challenge password in the request
   *
   * @param pwd password
   */
  public void setPassword(final String pwd) {
<span class="fc" id="L175">    this.password = pwd;</span>
<span class="fc" id="L176">  }</span>

  @Override
  public String getPassword() {
<span class="pc bpc" id="L180" title="1 of 2 branches missed.">    if (password != null) {</span>
<span class="nc" id="L181">      return password;</span>
    }
    try {
<span class="pc bpc" id="L184" title="1 of 2 branches missed.">      if (pkcs10 == null) {</span>
<span class="nc" id="L185">        init();</span>
      }
<span class="nc" id="L187">    } catch (NullPointerException e) {</span>
<span class="nc" id="L188">      LOG.error(&quot;PKCS10 not initated! &quot; + e.getMessage());</span>
<span class="nc" id="L189">      return null;</span>
<span class="fc" id="L190">    }</span>

<span class="fc" id="L192">    String ret = null;</span>
<span class="fc" id="L193">    Attribute[] attributes =</span>
<span class="fc" id="L194">        pkcs10.getAttributes(PKCSObjectIdentifiers.pkcs_9_at_challengePassword);</span>
<span class="fc" id="L195">    ASN1Encodable obj = null;</span>
<span class="fc bfc" id="L196" title="All 2 branches covered.">    if (attributes.length == 0) {</span>
      // See if we have it embedded in an extension request instead
<span class="fc" id="L198">      attributes =</span>
<span class="fc" id="L199">          pkcs10.getAttributes(</span>
              PKCSObjectIdentifiers.pkcs_9_at_extensionRequest);
<span class="pc bpc" id="L201" title="1 of 2 branches missed.">      if (attributes.length == 0) {</span>
<span class="fc" id="L202">        return null;</span>
      }
<span class="nc bnc" id="L204" title="All 2 branches missed.">      if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L205">        LOG.debug(&quot;got extension request&quot;);</span>
      }
<span class="nc" id="L207">      ASN1Set values = attributes[0].getAttrValues();</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">      if (values.size() == 0) {</span>
<span class="nc" id="L209">        return null;</span>
      }
<span class="nc" id="L211">      Extensions exts = Extensions.getInstance(values.getObjectAt(0));</span>
<span class="nc" id="L212">      Extension ext =</span>
<span class="nc" id="L213">          exts.getExtension(PKCSObjectIdentifiers.pkcs_9_at_challengePassword);</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">      if (ext == null) {</span>
<span class="nc bnc" id="L215" title="All 2 branches missed.">        if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L216">          LOG.debug(&quot;no challenge password extension&quot;);</span>
        }
<span class="nc" id="L218">        return null;</span>
      }
<span class="nc" id="L220">      obj = ext.getExtnValue();</span>
<span class="nc" id="L221">    } else {</span>
      // If it is a challengePassword directly, it's just to grab the value
<span class="fc" id="L223">      ASN1Set values = attributes[0].getAttrValues();</span>
<span class="fc" id="L224">      obj = values.getObjectAt(0);</span>
    }

<span class="pc bpc" id="L227" title="1 of 2 branches missed.">    if (obj != null) {</span>
<span class="fc" id="L228">      ASN1String str = null;</span>
      try {
        // Should be any DirectoryString according to RFC2985, preferably a
        // PrintableString or UTF8String
<span class="fc" id="L232">        str = DirectoryString.getInstance((obj));</span>
<span class="fc" id="L233">      } catch (IllegalArgumentException ie) {</span>
        // This was not a DirectoryString type, it could then be IA5string,
        // breaking pkcs#9 v2.0
        // but some version of openssl have been known to produce IA5strings
<span class="fc" id="L237">        str = DERIA5String.getInstance((obj));</span>
<span class="fc" id="L238">      }</span>

<span class="pc bpc" id="L240" title="1 of 2 branches missed.">      if (str != null) {</span>
<span class="fc" id="L241">        ret = str.getString();</span>
      }
    }

<span class="fc" id="L245">    return ret;</span>
  }

  /**
   * force a username, i.e. ignore the DN/username in the request
   *
   * @param aUsername username
   */
  public void setUsername(final String aUsername) {
<span class="fc" id="L254">    this.username = aUsername;</span>
<span class="fc" id="L255">  }</span>

  /**
   * Set the date after which the private key no longer will be valid, or null
   * to use the default validity specified in the certificate profile. The value
   * specified here will only be considered if user-defined validity dates are
   * allowed by the certificate profile, e.g. if Validity override&quot; is enabled.
   *
   * @param aNotAfter expiry
   */
  public void setNotAfter(final Date aNotAfter) {
<span class="nc" id="L266">    this.notAfter = aNotAfter;</span>
<span class="nc" id="L267">  }</span>

  @Override
  public String getUsername() {
<span class="pc bpc" id="L271" title="1 of 2 branches missed.">    if (username != null) {</span>
<span class="nc" id="L272">      return username;</span>
    }
    // Special if the DN contains unstructuredAddress where it becomes:
    // CN=pix.primekey.com + unstructuredAddress=pix.primekey.com
    // We only want the CN and not the oid-part.
    // Luckily for us this is handles automatically by BC X500Name class
<span class="fc" id="L278">    X500Name xname = getRequestX500Name();</span>
<span class="fc" id="L279">    String ret = null;</span>
<span class="pc bpc" id="L280" title="1 of 2 branches missed.">    if (xname == null) {</span>
<span class="nc" id="L281">      LOG.info(</span>
          &quot;No requestDN in request, probably we could not read/parse/decrypt&quot;
              + &quot; request.&quot;);
    } else {
<span class="fc" id="L285">      RDN[] cnValues = xname.getRDNs(CeSecoreNameStyle.CN);</span>
<span class="pc bpc" id="L286" title="1 of 2 branches missed.">      if (cnValues.length == 0) {</span>
<span class="nc" id="L287">        LOG.info(&quot;No CN in DN: &quot; + xname.toString());</span>
      } else {
<span class="fc" id="L289">        AttributeTypeAndValue[] tavs = cnValues[0].getTypesAndValues();</span>
<span class="pc bpc" id="L290" title="1 of 2 branches missed.">        for (AttributeTypeAndValue tav : tavs) {</span>
<span class="fc bfc" id="L291" title="All 2 branches covered.">          if (tav.getType().equals(CeSecoreNameStyle.CN)) {</span>
<span class="fc" id="L292">            ret = tav.getValue().toString();</span>
<span class="fc" id="L293">            break;</span>
          }
        }
        // If we have a CN with a normal name like &quot;Test Testsson&quot; we only want
        // to
        // use the first part as the username
<span class="fc" id="L299">        int index = ret.indexOf(' ');</span>
<span class="fc bfc" id="L300" title="All 2 branches covered.">        if (index &gt; 0) {</span>
<span class="fc" id="L301">          ret = ret.substring(0, index);</span>
        }
      }
    }
<span class="pc bpc" id="L305" title="1 of 2 branches missed.">    if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L306">      LOG.debug(&quot;UserName='&quot; + ret + &quot;'&quot;);</span>
    }
<span class="fc" id="L308">    return ret;</span>
  }

  @Override
  public String getIssuerDN() {
<span class="nc" id="L313">    return null;</span>
  }

  @Override
  public BigInteger getSerialNo() {
<span class="fc" id="L318">    return null;</span>
  }

  @Override
  public String getCRLIssuerDN() {
<span class="nc" id="L323">    return null;</span>
  }

  @Override
  public BigInteger getCRLSerialNo() {
<span class="nc" id="L328">    return null;</span>
  }

  @Override
  public String getRequestDN() {
<span class="fc" id="L333">    String ret = null;</span>
<span class="fc" id="L334">    X500Name name = getRequestX500Name();</span>
<span class="pc bpc" id="L335" title="1 of 2 branches missed.">    if (name != null) {</span>
<span class="fc" id="L336">      String dn = name.toString();</span>
      // We have to make special handling again for Cisco devices.
      // they will submit requests like: SN=FFFFFF+unstructuredName=Router
      // EJBCA does not handle this very well so we will change it to:
      // SN=FFFFFF,unstructuredName=Router
<span class="fc" id="L341">      dn = dn.replace(&quot;+unstructuredName=&quot;, &quot;,unstructuredName=&quot;);</span>
<span class="fc" id="L342">      dn = dn.replace(&quot; + unstructuredName=&quot;, &quot;,unstructuredName=&quot;);</span>
<span class="fc" id="L343">      dn = dn.replace(&quot;+unstructuredAddress=&quot;, &quot;,unstructuredAddress=&quot;);</span>
<span class="fc" id="L344">      dn = dn.replace(&quot; + unstructuredAddress=&quot;, &quot;,unstructuredAddress=&quot;);</span>
<span class="fc" id="L345">      ret = dn;</span>
    }
<span class="pc bpc" id="L347" title="1 of 2 branches missed.">    if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L348">      LOG.debug(&quot;getRequestDN: &quot; + ret);</span>
    }
<span class="fc" id="L350">    return ret;</span>
  }

  @Override
  public X500Name getRequestX500Name() {
    try {
<span class="pc bpc" id="L356" title="1 of 2 branches missed.">      if (pkcs10 == null) {</span>
<span class="nc" id="L357">        init();</span>
      }
<span class="nc" id="L359">    } catch (NullPointerException e) {</span>
<span class="nc" id="L360">      LOG.error(&quot;PKCS10 not inited: &quot; + e.getMessage());</span>
<span class="nc" id="L361">      return null;</span>
<span class="fc" id="L362">    }</span>
<span class="fc" id="L363">    return X500Name.getInstance(new CeSecoreNameStyle(), pkcs10.getSubject());</span>
  }

  @Override
  public String getRequestAltNames() {
<span class="fc" id="L368">    String ret = null;</span>
    try {
<span class="fc" id="L370">      Extensions exts = getRequestExtensions();</span>
<span class="fc bfc" id="L371" title="All 2 branches covered.">      if (exts != null) {</span>
<span class="fc" id="L372">        Extension ext = exts.getExtension(Extension.subjectAlternativeName);</span>
<span class="pc bpc" id="L373" title="1 of 2 branches missed.">        if (ext != null) {</span>
          // Finally read the value
<span class="fc" id="L375">          ret = CertTools.getAltNameStringFromExtension(ext);</span>
        } else {
<span class="nc bnc" id="L377" title="All 2 branches missed.">          if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L378">            LOG.debug(&quot;no subject altName extension&quot;);</span>
          }
        }
      }
<span class="nc" id="L382">    } catch (IllegalArgumentException e) {</span>
<span class="nc bnc" id="L383" title="All 2 branches missed.">      if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L384">        LOG.debug(</span>
            &quot;pkcs_9_extensionRequest does not contain Extensions that it&quot;
                + &quot; should, ignoring invalid encoded extension request.&quot;);
      }
<span class="fc" id="L388">    }</span>
<span class="fc" id="L389">    return ret;</span>
  }

  @Override
  public Date getRequestValidityNotBefore() {
<span class="nc" id="L394">    return notBefore;</span>
  }

  @Override
  public Date getRequestValidityNotAfter() {
<span class="nc" id="L399">    return notAfter;</span>
  }

  @Override
  public Extensions getRequestExtensions() {
    try {
<span class="pc bpc" id="L405" title="1 of 2 branches missed.">      if (pkcs10 == null) {</span>
<span class="nc" id="L406">        init();</span>
      }
<span class="nc" id="L408">    } catch (NullPointerException e) {</span>
<span class="nc" id="L409">      LOG.error(&quot;PKCS10 not inited! &quot; + e.getMessage());</span>
<span class="nc" id="L410">      return null;</span>
<span class="fc" id="L411">    }</span>
<span class="fc" id="L412">    Extensions ret = null;</span>

    // Get attributes
    // The X509 extension is in a a pkcs_9_at_extensionRequest

    // See if we have it embedded in an extension request instead
<span class="fc" id="L418">    Attribute[] attr =</span>
<span class="fc" id="L419">        pkcs10.getAttributes(PKCSObjectIdentifiers.pkcs_9_at_extensionRequest);</span>
<span class="fc bfc" id="L420" title="All 2 branches covered.">    if (attr.length != 0) {</span>
<span class="pc bpc" id="L421" title="1 of 2 branches missed.">      if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L422">        LOG.debug(&quot;got request extension&quot;);</span>
      }
<span class="fc" id="L424">      ASN1Set values = attr[0].getAttrValues();</span>
<span class="pc bpc" id="L425" title="1 of 2 branches missed.">      if (values.size() &gt; 0) {</span>
        try {
<span class="fc" id="L427">          ret = Extensions.getInstance(values.getObjectAt(0));</span>
<span class="nc" id="L428">        } catch (IllegalArgumentException e) {</span>
<span class="nc bnc" id="L429" title="All 2 branches missed.">          if (LOG.isDebugEnabled()) {</span>
<span class="nc" id="L430">            LOG.debug(</span>
                &quot;pkcs_9_extensionRequest does not contain Extensions that it&quot;
                    + &quot; should, ignoring invalid encoded extension request.&quot;);
          }
<span class="fc" id="L434">        }</span>
      }
    }

<span class="fc" id="L438">    return ret;</span>
  }

  /**
   * Gets the underlying BC &lt;code&gt;PKCS10CertificationRequest&lt;/code&gt; object.
   *
   * @return the request object
   */
  public PKCS10CertificationRequest getCertificationRequest() {
    try {
<span class="nc bnc" id="L448" title="All 2 branches missed.">      if (pkcs10 == null) {</span>
<span class="nc" id="L449">        init();</span>
      }
<span class="nc" id="L451">    } catch (NullPointerException e) {</span>
<span class="nc" id="L452">      LOG.error(&quot;PKCS10 not inited! &quot; + e.getMessage());</span>
<span class="nc" id="L453">      return null;</span>
<span class="nc" id="L454">    }</span>

<span class="nc" id="L456">    return pkcs10;</span>
  }

  @Override
  public boolean verify() throws InvalidKeyException, NoSuchAlgorithmException {
<span class="fc" id="L461">    return verify(null);</span>
  }

  /**
   *
   * @param pubKey Key
   * @return Verified
   * @throws InvalidKeyException Key invalid
   * @throws NoSuchAlgorithmException No algo
   */
  public boolean verify(final PublicKey pubKey)
      throws InvalidKeyException, NoSuchAlgorithmException {
<span class="pc bpc" id="L473" title="1 of 2 branches missed.">    if (LOG.isTraceEnabled()) {</span>
<span class="nc" id="L474">      LOG.trace(&quot;&gt;verify()&quot;);</span>
    }
<span class="pc bpc" id="L476" title="1 of 2 branches missed.">    if (pkcs10 == null) {</span>
<span class="nc" id="L477">      init();</span>
    }

    ContentVerifierProvider verifierProvider;
    try {
<span class="fc bfc" id="L482" title="All 2 branches covered.">      if (pubKey == null) {</span>
<span class="fc" id="L483">        verifierProvider =</span>
<span class="fc" id="L484">            CertTools.genContentVerifierProvider(pkcs10.getPublicKey());</span>
      } else {
<span class="fc" id="L486">        verifierProvider = CertTools.genContentVerifierProvider(pubKey);</span>
      }
      try {
<span class="fc" id="L489">        return pkcs10.isSignatureValid(verifierProvider);</span>
<span class="nc" id="L490">      } catch (PKCSException e) {</span>
<span class="nc" id="L491">        LOG.error(&quot;Signature could not be processed.&quot;, e);</span>
      }
<span class="nc" id="L493">    } catch (OperatorCreationException e) {</span>
<span class="nc" id="L494">      LOG.error(&quot;Content verifier provider could not be created.&quot;, e);</span>
    } finally {
<span class="pc bpc" id="L496" title="1 of 2 branches missed.">      if (LOG.isTraceEnabled()) {</span>
<span class="nc" id="L497">        LOG.trace(&quot;&lt;verify()&quot;);</span>
      }
    }
<span class="nc" id="L500">    return false;</span>
  }

  @Override
  public boolean requireKeyInfo() {
<span class="nc" id="L505">    return false;</span>
  }

  @Override
  public void setKeyInfo(final Certificate cert,
          final PrivateKey key, final String provider) {
      // NO-OP
<span class="nc" id="L512">  }</span>

  @Override
  public int getErrorNo() {
<span class="nc" id="L516">    return error;</span>
  }

  @Override
  public String getErrorText() {
<span class="nc" id="L521">    return errorText;</span>
  }

  @Override
  public String getSenderNonce() {
<span class="nc" id="L526">    return null;</span>
  }

  @Override
  public String getTransactionId() {
<span class="nc" id="L531">    return null;</span>
  }

  @Override
  public byte[] getRequestKeyInfo() {
<span class="nc" id="L536">    return null;</span>
  }

  @Override
  public String getPreferredDigestAlg() {
<span class="nc" id="L541">    return preferredDigestAlg;</span>
  }

  @Override
  public boolean includeCACert() {
<span class="nc" id="L546">    return includeCACert;</span>
  }

  @Override
  public int getRequestType() {
<span class="nc" id="L551">    return 0;</span>
  }

  @Override
  public int getRequestId() {
<span class="nc" id="L556">    return 0;</span>
  }

  @Override
  public void setResponseKeyInfo(final PrivateKey key, final String provider) {
    // NOOP
<span class="fc" id="L562">  }</span>

  @Override
  public List&lt;Certificate&gt; getAdditionalCaCertificates() {
<span class="nc" id="L566">    return additionalCaCertificates;</span>
  }

  @Override
  public void setAdditionalCaCertificates(
      final List&lt;Certificate&gt; certificates) {
<span class="nc" id="L572">    this.additionalCaCertificates = certificates;</span>
<span class="nc" id="L573">  }</span>

  @Override
  public List&lt;Certificate&gt; getAdditionalExtraCertsCertificates() {
<span class="nc" id="L577">    return additionalExtraCertsCertificates;</span>
  }

  @Override
  public void setAdditionalExtraCertsCertificates(
      final List&lt;Certificate&gt; aAdditionalExtraCertsCertificates) {
<span class="nc" id="L583">    this.additionalExtraCertsCertificates = aAdditionalExtraCertsCertificates;</span>
<span class="nc" id="L584">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>