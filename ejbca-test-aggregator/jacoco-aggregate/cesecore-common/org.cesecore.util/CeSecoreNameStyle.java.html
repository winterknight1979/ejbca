<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>CeSecoreNameStyle.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">Unit Test Aggregator</a> &gt; <a href="../index.html" class="el_bundle">cesecore-common</a> &gt; <a href="index.source.html" class="el_package">org.cesecore.util</a> &gt; <span class="el_source">CeSecoreNameStyle.java</span></div><h1>CeSecoreNameStyle.java</h1><pre class="source lang-java linenums">/*************************************************************************
 *                                                                       *
 *  EJBCA Community: The OpenSource Certificate Authority                *
 *                                                                       *
 *  This software is free software; you can redistribute it and/or       *
 *  modify it under the terms of the GNU Lesser General Public           *
 *  License as published by the Free Software Foundation; either         *
 *  version 2.1 of the License, or any later version.                    *
 *                                                                       *
 *  See terms of license at gnu.org.                                     *
 *                                                                       *
 *************************************************************************/

package org.cesecore.util;

import java.util.Hashtable;
import org.bouncycastle.asn1.ASN1Encodable;
import org.bouncycastle.asn1.ASN1ObjectIdentifier;
import org.bouncycastle.asn1.DERPrintableString;
import org.bouncycastle.asn1.x500.AttributeTypeAndValue;
import org.bouncycastle.asn1.x500.RDN;
import org.bouncycastle.asn1.x500.X500Name;
import org.bouncycastle.asn1.x500.X500NameStyle;
import org.bouncycastle.asn1.x500.style.BCStyle;
import org.bouncycastle.asn1.x500.style.IETFUtils;

/**
 * Class that determines string representations of DNs. Overrides the default
 * BCStyle in order to: - Be consistent for all future for backwards
 * compatibility (serialnumber) - Be able to add fields that does not (yet)
 * exist in BC (like CABForum Jurisdiction* in BC 1.54)
 *
 * @version $Id: CeSecoreNameStyle.java 26562 2017-09-16 19:07:04Z samuellb $
 */
<span class="fc" id="L35">public class CeSecoreNameStyle extends BCStyle {</span>

    /** Singleton. */
<span class="fc" id="L38">  public static final X500NameStyle INSTANCE = new CeSecoreNameStyle();</span>

  /**
   * EV TLS jurisdictionCountry.
   * https://cabforum.org/wp-content/uploads/EV-V1_5_2Libre.pdf
   */
<span class="fc" id="L44">  public static final ASN1ObjectIdentifier JURISDICTION_COUNTRY =</span>
      new ASN1ObjectIdentifier(&quot;1.3.6.1.4.1.311.60.2.1.3&quot;);
  /**
   * EV TLS jurisdictionState.
   * https://cabforum.org/wp-content/uploads/EV-V1_5_2Libre.pdf
   */
<span class="fc" id="L50">  public static final ASN1ObjectIdentifier JURISDICTION_STATE =</span>
      new ASN1ObjectIdentifier(&quot;1.3.6.1.4.1.311.60.2.1.2&quot;);
  /**
   * EV TLS jurisdictionLocality.
   * https://cabforum.org/wp-content/uploads/EV-V1_5_2Libre.pdf
   */
<span class="fc" id="L56">  public static final ASN1ObjectIdentifier JURISDICTION_LOCALITY =</span>
      new ASN1ObjectIdentifier(&quot;1.3.6.1.4.1.311.60.2.1.1&quot;);
  /**
   * X.520 organizationIdentifier, used by ETSI TS 319 412 (eIDAS).
   * https://www.itu.int/rec/dologin.asp?lang=e&amp;amp;id=T-REC-X.520-201210-S!Cor3!PDF-E&amp;amp;type=items
   */
<span class="fc" id="L62">  public static final ASN1ObjectIdentifier ORGANIZATION_IDENTIFIER =</span>
      new ASN1ObjectIdentifier(&quot;2.5.4.97&quot;);

  /** */
<span class="fc" id="L66">  public static final ASN1ObjectIdentifier DESCRIPTION =</span>
      new ASN1ObjectIdentifier(&quot;2.5.4.13&quot;);

  /**
   * default look up table translating OID values into their common symbols
   * following the convention in RFC 2253 with a few extras.
   */
<span class="fc" id="L73">  public static final Hashtable&lt;ASN1ObjectIdentifier, String&gt; DEFAULT_SYMBOLS =</span>
      new Hashtable&lt;&gt;();

  /** look up table translating common symbols into their OIDS. */
<span class="fc" id="L77">  public static final Hashtable&lt;String, ASN1ObjectIdentifier&gt; DEFAULT_LOOKUP =</span>
      new Hashtable&lt;&gt;();

  /** look up table translating common symbols into their OIDS. */
<span class="fc" id="L81">  public static final Hashtable&lt;String, String&gt; DEFAULT_STRING_STRING_LOKUP =</span>
      new Hashtable&lt;&gt;();

  static {
<span class="fc" id="L85">    DEFAULT_SYMBOLS.put(C, &quot;C&quot;);</span>
<span class="fc" id="L86">    DEFAULT_SYMBOLS.put(O, &quot;O&quot;);</span>
<span class="fc" id="L87">    DEFAULT_SYMBOLS.put(T, &quot;T&quot;);</span>
<span class="fc" id="L88">    DEFAULT_SYMBOLS.put(OU, &quot;OU&quot;);</span>
<span class="fc" id="L89">    DEFAULT_SYMBOLS.put(CN, &quot;CN&quot;);</span>
<span class="fc" id="L90">    DEFAULT_SYMBOLS.put(L, &quot;L&quot;);</span>
<span class="fc" id="L91">    DEFAULT_SYMBOLS.put(ST, &quot;ST&quot;);</span>
<span class="fc" id="L92">    DEFAULT_SYMBOLS.put(SN, &quot;SN&quot;);</span>
<span class="fc" id="L93">    DEFAULT_SYMBOLS.put(EmailAddress, &quot;E&quot;);</span>
<span class="fc" id="L94">    DEFAULT_SYMBOLS.put(DC, &quot;DC&quot;);</span>
<span class="fc" id="L95">    DEFAULT_SYMBOLS.put(UID, &quot;UID&quot;);</span>
<span class="fc" id="L96">    DEFAULT_SYMBOLS.put(STREET, &quot;STREET&quot;);</span>
<span class="fc" id="L97">    DEFAULT_SYMBOLS.put(SURNAME, &quot;SURNAME&quot;);</span>
<span class="fc" id="L98">    DEFAULT_SYMBOLS.put(GIVENNAME, &quot;GIVENNAME&quot;);</span>
<span class="fc" id="L99">    DEFAULT_SYMBOLS.put(INITIALS, &quot;INITIALS&quot;);</span>
<span class="fc" id="L100">    DEFAULT_SYMBOLS.put(GENERATION, &quot;GENERATION&quot;);</span>
<span class="fc" id="L101">    DEFAULT_SYMBOLS.put(UnstructuredAddress, &quot;unstructuredAddress&quot;);</span>
<span class="fc" id="L102">    DEFAULT_SYMBOLS.put(UnstructuredName, &quot;unstructuredName&quot;);</span>
<span class="fc" id="L103">    DEFAULT_SYMBOLS.put(UNIQUE_IDENTIFIER, &quot;UniqueIdentifier&quot;);</span>
<span class="fc" id="L104">    DEFAULT_SYMBOLS.put(DN_QUALIFIER, &quot;DN&quot;);</span>
<span class="fc" id="L105">    DEFAULT_SYMBOLS.put(PSEUDONYM, &quot;Pseudonym&quot;);</span>
<span class="fc" id="L106">    DEFAULT_SYMBOLS.put(POSTAL_ADDRESS, &quot;PostalAddress&quot;);</span>
<span class="fc" id="L107">    DEFAULT_SYMBOLS.put(NAME_AT_BIRTH, &quot;NameAtBirth&quot;);</span>
<span class="fc" id="L108">    DEFAULT_SYMBOLS.put(COUNTRY_OF_CITIZENSHIP, &quot;CountryOfCitizenship&quot;);</span>
<span class="fc" id="L109">    DEFAULT_SYMBOLS.put(COUNTRY_OF_RESIDENCE, &quot;CountryOfResidence&quot;);</span>
<span class="fc" id="L110">    DEFAULT_SYMBOLS.put(GENDER, &quot;Gender&quot;);</span>
<span class="fc" id="L111">    DEFAULT_SYMBOLS.put(PLACE_OF_BIRTH, &quot;PlaceOfBirth&quot;);</span>
<span class="fc" id="L112">    DEFAULT_SYMBOLS.put(DATE_OF_BIRTH, &quot;DateOfBirth&quot;);</span>
<span class="fc" id="L113">    DEFAULT_SYMBOLS.put(POSTAL_CODE, &quot;PostalCode&quot;);</span>
<span class="fc" id="L114">    DEFAULT_SYMBOLS.put(BUSINESS_CATEGORY, &quot;BusinessCategory&quot;);</span>
<span class="fc" id="L115">    DEFAULT_SYMBOLS.put(TELEPHONE_NUMBER, &quot;TelephoneNumber&quot;);</span>
<span class="fc" id="L116">    DEFAULT_SYMBOLS.put(NAME, &quot;Name&quot;);</span>
<span class="fc" id="L117">    DEFAULT_SYMBOLS.put(JURISDICTION_LOCALITY, &quot;JurisdictionLocality&quot;);</span>
<span class="fc" id="L118">    DEFAULT_SYMBOLS.put(JURISDICTION_STATE, &quot;JurisdictionState&quot;);</span>
<span class="fc" id="L119">    DEFAULT_SYMBOLS.put(JURISDICTION_COUNTRY, &quot;JurisdictionCountry&quot;);</span>
<span class="fc" id="L120">    DEFAULT_SYMBOLS.put(ORGANIZATION_IDENTIFIER, &quot;organizationIdentifier&quot;);</span>
<span class="fc" id="L121">    DEFAULT_SYMBOLS.put(DESCRIPTION, &quot;description&quot;);</span>

<span class="fc" id="L123">    DEFAULT_LOOKUP.put(&quot;c&quot;, C);</span>
<span class="fc" id="L124">    DEFAULT_LOOKUP.put(&quot;o&quot;, O);</span>
<span class="fc" id="L125">    DEFAULT_LOOKUP.put(&quot;t&quot;, T);</span>
<span class="fc" id="L126">    DEFAULT_LOOKUP.put(&quot;ou&quot;, OU);</span>
<span class="fc" id="L127">    DEFAULT_LOOKUP.put(&quot;cn&quot;, CN);</span>
<span class="fc" id="L128">    DEFAULT_LOOKUP.put(&quot;l&quot;, L);</span>
<span class="fc" id="L129">    DEFAULT_LOOKUP.put(&quot;st&quot;, ST);</span>
<span class="fc" id="L130">    DEFAULT_LOOKUP.put(&quot;sn&quot;, SN);</span>
<span class="fc" id="L131">    DEFAULT_LOOKUP.put(&quot;serialnumber&quot;, SN);</span>
<span class="fc" id="L132">    DEFAULT_LOOKUP.put(&quot;street&quot;, STREET);</span>
<span class="fc" id="L133">    DEFAULT_LOOKUP.put(&quot;emailaddress&quot;, E);</span>
<span class="fc" id="L134">    DEFAULT_LOOKUP.put(&quot;dc&quot;, DC);</span>
<span class="fc" id="L135">    DEFAULT_LOOKUP.put(&quot;e&quot;, E);</span>
<span class="fc" id="L136">    DEFAULT_LOOKUP.put(&quot;uid&quot;, UID);</span>
<span class="fc" id="L137">    DEFAULT_LOOKUP.put(&quot;surname&quot;, SURNAME);</span>
<span class="fc" id="L138">    DEFAULT_LOOKUP.put(&quot;givenname&quot;, GIVENNAME);</span>
<span class="fc" id="L139">    DEFAULT_LOOKUP.put(&quot;initials&quot;, INITIALS);</span>
<span class="fc" id="L140">    DEFAULT_LOOKUP.put(&quot;generation&quot;, GENERATION);</span>
<span class="fc" id="L141">    DEFAULT_LOOKUP.put(&quot;unstructuredaddress&quot;, UnstructuredAddress);</span>
<span class="fc" id="L142">    DEFAULT_LOOKUP.put(&quot;unstructuredname&quot;, UnstructuredName);</span>
<span class="fc" id="L143">    DEFAULT_LOOKUP.put(&quot;uniqueidentifier&quot;, UNIQUE_IDENTIFIER);</span>
<span class="fc" id="L144">    DEFAULT_LOOKUP.put(&quot;dn&quot;, DN_QUALIFIER);</span>
<span class="fc" id="L145">    DEFAULT_LOOKUP.put(&quot;pseudonym&quot;, PSEUDONYM);</span>
<span class="fc" id="L146">    DEFAULT_LOOKUP.put(&quot;postaladdress&quot;, POSTAL_ADDRESS);</span>
<span class="fc" id="L147">    DEFAULT_LOOKUP.put(&quot;nameofbirth&quot;, NAME_AT_BIRTH);</span>
<span class="fc" id="L148">    DEFAULT_LOOKUP.put(&quot;countryofcitizenship&quot;, COUNTRY_OF_CITIZENSHIP);</span>
<span class="fc" id="L149">    DEFAULT_LOOKUP.put(&quot;countryofresidence&quot;, COUNTRY_OF_RESIDENCE);</span>
<span class="fc" id="L150">    DEFAULT_LOOKUP.put(&quot;gender&quot;, GENDER);</span>
<span class="fc" id="L151">    DEFAULT_LOOKUP.put(&quot;placeofbirth&quot;, PLACE_OF_BIRTH);</span>
<span class="fc" id="L152">    DEFAULT_LOOKUP.put(&quot;dateofbirth&quot;, DATE_OF_BIRTH);</span>
<span class="fc" id="L153">    DEFAULT_LOOKUP.put(&quot;postalcode&quot;, POSTAL_CODE);</span>
<span class="fc" id="L154">    DEFAULT_LOOKUP.put(&quot;businesscategory&quot;, BUSINESS_CATEGORY);</span>
<span class="fc" id="L155">    DEFAULT_LOOKUP.put(&quot;telephonenumber&quot;, TELEPHONE_NUMBER);</span>
<span class="fc" id="L156">    DEFAULT_LOOKUP.put(&quot;name&quot;, NAME);</span>
<span class="fc" id="L157">    DEFAULT_LOOKUP.put(&quot;jurisdictionlocality&quot;, JURISDICTION_LOCALITY);</span>
<span class="fc" id="L158">    DEFAULT_LOOKUP.put(&quot;jurisdictionstate&quot;, JURISDICTION_STATE);</span>
<span class="fc" id="L159">    DEFAULT_LOOKUP.put(&quot;jurisdictioncountry&quot;, JURISDICTION_COUNTRY);</span>
<span class="fc" id="L160">    DEFAULT_LOOKUP.put(&quot;organizationidentifier&quot;, ORGANIZATION_IDENTIFIER);</span>
<span class="fc" id="L161">    DEFAULT_LOOKUP.put(&quot;description&quot;, DESCRIPTION);</span>

<span class="fc" id="L163">    DEFAULT_STRING_STRING_LOKUP.put(&quot;C&quot;, C.getId());</span>
<span class="fc" id="L164">    DEFAULT_STRING_STRING_LOKUP.put(&quot;O&quot;, O.getId());</span>
<span class="fc" id="L165">    DEFAULT_STRING_STRING_LOKUP.put(&quot;T&quot;, T.getId());</span>
<span class="fc" id="L166">    DEFAULT_STRING_STRING_LOKUP.put(&quot;OU&quot;, OU.getId());</span>
<span class="fc" id="L167">    DEFAULT_STRING_STRING_LOKUP.put(&quot;CN&quot;, CN.getId());</span>
<span class="fc" id="L168">    DEFAULT_STRING_STRING_LOKUP.put(&quot;L&quot;, L.getId());</span>
<span class="fc" id="L169">    DEFAULT_STRING_STRING_LOKUP.put(&quot;ST&quot;, ST.getId());</span>
<span class="fc" id="L170">    DEFAULT_STRING_STRING_LOKUP.put(&quot;SN&quot;, SN.getId());</span>
<span class="fc" id="L171">    DEFAULT_STRING_STRING_LOKUP.put(&quot;SERIALNUMBER&quot;, SN.getId());</span>
<span class="fc" id="L172">    DEFAULT_STRING_STRING_LOKUP.put(&quot;STREET&quot;, STREET.getId());</span>
<span class="fc" id="L173">    DEFAULT_STRING_STRING_LOKUP.put(&quot;EMAILADDRESS&quot;, E.getId());</span>
<span class="fc" id="L174">    DEFAULT_STRING_STRING_LOKUP.put(&quot;DC&quot;, DC.getId());</span>
<span class="fc" id="L175">    DEFAULT_STRING_STRING_LOKUP.put(&quot;E&quot;, E.getId());</span>
<span class="fc" id="L176">    DEFAULT_STRING_STRING_LOKUP.put(&quot;UID&quot;, UID.getId());</span>
<span class="fc" id="L177">    DEFAULT_STRING_STRING_LOKUP.put(&quot;SURNAME&quot;, SURNAME.getId());</span>
<span class="fc" id="L178">    DEFAULT_STRING_STRING_LOKUP.put(&quot;GIVENNAME&quot;, GIVENNAME.getId());</span>
<span class="fc" id="L179">    DEFAULT_STRING_STRING_LOKUP.put(&quot;INITIALS&quot;, INITIALS.getId());</span>
<span class="fc" id="L180">    DEFAULT_STRING_STRING_LOKUP.put(&quot;GENERATION&quot;, GENERATION.getId());</span>
<span class="fc" id="L181">    DEFAULT_STRING_STRING_LOKUP.put(</span>
<span class="fc" id="L182">        &quot;UNSTRUCTUREDADDRESS&quot;, UnstructuredAddress.getId());</span>
<span class="fc" id="L183">    DEFAULT_STRING_STRING_LOKUP.put(&quot;UNSTRUCTUREDNAME&quot;,</span>
<span class="fc" id="L184">            UnstructuredName.getId());</span>
<span class="fc" id="L185">    DEFAULT_STRING_STRING_LOKUP.put(</span>
<span class="fc" id="L186">        &quot;UNIQUEIDENTIFIER&quot;, UNIQUE_IDENTIFIER.getId());</span>
<span class="fc" id="L187">    DEFAULT_STRING_STRING_LOKUP.put(&quot;DN&quot;, DN_QUALIFIER.getId());</span>
<span class="fc" id="L188">    DEFAULT_STRING_STRING_LOKUP.put(&quot;PSEUDONYM&quot;, PSEUDONYM.getId());</span>
<span class="fc" id="L189">    DEFAULT_STRING_STRING_LOKUP.put(&quot;POSTALADDRESS&quot;, POSTAL_ADDRESS.getId());</span>
<span class="fc" id="L190">    DEFAULT_STRING_STRING_LOKUP.put(&quot;NAMEOFBIRTH&quot;, NAME_AT_BIRTH.getId());</span>
<span class="fc" id="L191">    DEFAULT_STRING_STRING_LOKUP.put(</span>
<span class="fc" id="L192">        &quot;COUNTRYOFCITIZENSHIP&quot;, COUNTRY_OF_CITIZENSHIP.getId());</span>
<span class="fc" id="L193">    DEFAULT_STRING_STRING_LOKUP.put(</span>
<span class="fc" id="L194">        &quot;COUNTRYOFRESIDENCE&quot;, COUNTRY_OF_RESIDENCE.getId());</span>
<span class="fc" id="L195">    DEFAULT_STRING_STRING_LOKUP.put(&quot;GENDER&quot;, GENDER.getId());</span>
<span class="fc" id="L196">    DEFAULT_STRING_STRING_LOKUP.put(&quot;PLACEOFBIRTH&quot;, PLACE_OF_BIRTH.getId());</span>
<span class="fc" id="L197">    DEFAULT_STRING_STRING_LOKUP.put(&quot;DATEOFBIRTH&quot;, DATE_OF_BIRTH.getId());</span>
<span class="fc" id="L198">    DEFAULT_STRING_STRING_LOKUP.put(&quot;POSTALCODE&quot;, POSTAL_CODE.getId());</span>
<span class="fc" id="L199">    DEFAULT_STRING_STRING_LOKUP.put(</span>
<span class="fc" id="L200">        &quot;BUSINESSCATEGORY&quot;, BUSINESS_CATEGORY.getId());</span>
<span class="fc" id="L201">    DEFAULT_STRING_STRING_LOKUP.put(&quot;TELEPHONENUMBER&quot;,</span>
<span class="fc" id="L202">            TELEPHONE_NUMBER.getId());</span>
<span class="fc" id="L203">    DEFAULT_STRING_STRING_LOKUP.put(&quot;NAME&quot;, NAME.getId());</span>
<span class="fc" id="L204">    DEFAULT_STRING_STRING_LOKUP.put(</span>
<span class="fc" id="L205">        &quot;JURISDICTIONLOCALITY&quot;, JURISDICTION_LOCALITY.getId());</span>
<span class="fc" id="L206">    DEFAULT_STRING_STRING_LOKUP.put(</span>
<span class="fc" id="L207">        &quot;JURISDICTIONSTATE&quot;, JURISDICTION_STATE.getId());</span>
<span class="fc" id="L208">    DEFAULT_STRING_STRING_LOKUP.put(</span>
<span class="fc" id="L209">        &quot;JURISDICTIONCOUNTRY&quot;, JURISDICTION_COUNTRY.getId());</span>
<span class="fc" id="L210">    DEFAULT_STRING_STRING_LOKUP.put(</span>
<span class="fc" id="L211">        &quot;ORGANIZATIONIDENTIFIER&quot;, ORGANIZATION_IDENTIFIER.getId());</span>
<span class="fc" id="L212">    DEFAULT_STRING_STRING_LOKUP.put(&quot;DESCRIPTION&quot;, DESCRIPTION.getId());</span>
<span class="fc" id="L213">  }</span>

  /**
   * This method is intended to be used in toString() in BCStyle classes. It is
   * useful e.g. when the DefaultSymbols map is not the default inherited from
   * BCStyle. It is public so it can be re-used by other classes as well (e.g.
   * LdapNameStyle in EJBCA).
   *
   * @param defaultSymbols symbols
   * @param name Name
   * @return String
   */
  public static String buildString(
      final Hashtable&lt;ASN1ObjectIdentifier, String&gt; defaultSymbols,
      final X500Name name) {
<span class="fc" id="L228">    StringBuffer buf = new StringBuffer();</span>
<span class="fc" id="L229">    boolean first = true;</span>

<span class="fc" id="L231">    RDN[] rdns = name.getRDNs();</span>

<span class="fc bfc" id="L233" title="All 2 branches covered.">    for (int i = 0; i &lt; rdns.length; i++) {</span>
<span class="fc bfc" id="L234" title="All 2 branches covered.">      if (first) {</span>
<span class="fc" id="L235">        first = false;</span>
      } else {
<span class="fc" id="L237">        buf.append(',');</span>
      }

<span class="fc bfc" id="L240" title="All 2 branches covered.">      if (rdns[i].isMultiValued()) {</span>
<span class="fc" id="L241">        AttributeTypeAndValue[] atv = rdns[i].getTypesAndValues();</span>
<span class="fc" id="L242">        boolean firstAtv = true;</span>

<span class="fc bfc" id="L244" title="All 2 branches covered.">        for (int j = 0; j != atv.length; j++) {</span>
<span class="fc bfc" id="L245" title="All 2 branches covered.">          if (firstAtv) {</span>
<span class="fc" id="L246">            firstAtv = false;</span>
          } else {
<span class="fc" id="L248">            buf.append('+');</span>
          }

<span class="fc" id="L251">          IETFUtils.appendTypeAndValue(buf, atv[j], defaultSymbols);</span>
        }
<span class="fc" id="L253">      } else {</span>
<span class="fc" id="L254">        IETFUtils.appendTypeAndValue(buf, rdns[i].getFirst(), defaultSymbols);</span>
      }
    }

<span class="fc" id="L258">    return buf.toString();</span>
  }

  @Override
  public String toString(final X500Name name) {
<span class="fc" id="L263">    return buildString(DEFAULT_SYMBOLS, name);</span>
  }

  @Override
  public ASN1Encodable stringToValue(
          final ASN1ObjectIdentifier oid, final String value) {
    // JurisdictionCountry is not included in BC (at least up to and including
    // 1.49), and must be PrintableString
<span class="fc bfc" id="L271" title="All 2 branches covered.">    if (oid.equals(CeSecoreNameStyle.JURISDICTION_COUNTRY)) {</span>
<span class="fc" id="L272">      return new DERPrintableString(value);</span>
    }
<span class="fc" id="L274">    return super.stringToValue(oid, value);</span>
  }

  @Override
  public ASN1ObjectIdentifier attrNameToOID(final String attrName) {
<span class="fc" id="L279">    return IETFUtils.decodeAttrName(attrName, DEFAULT_LOOKUP);</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>