<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>X509CAInfo.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">CeSeCore Security Common Code</a> &gt; <a href="index.source.html" class="el_package">org.cesecore.certificates.ca</a> &gt; <span class="el_source">X509CAInfo.java</span></div><h1>X509CAInfo.java</h1><pre class="source lang-java linenums">/**********************a***************************************************
 *                                                                       *
 *  CESeCore: CE Security Core                                           *
 *                                                                       *
 *  This software is free software; you can redistribute it and/or       *
 *  modify it under the terms of the GNU Lesser General Public           *
 *  License as published by the Free Software Foundation; either         *
 *  version 2.1 of the License, or any later version.                    *
 *                                                                       *
 *  See terms of license at gnu.org.                                     *
 *                                                                       *
 *************************************************************************/
package org.cesecore.certificates.ca;

import java.security.NoSuchProviderException;
import java.security.cert.Certificate;
import java.security.cert.CertificateException;
import java.security.cert.X509Certificate;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import org.cesecore.certificates.ca.catoken.CAToken;
import org.cesecore.certificates.ca.extendedservices.ExtendedCAServiceInfo;
import org.cesecore.certificates.certificateprofile.CertificatePolicy;
import org.cesecore.config.CesecoreConfiguration;
import org.cesecore.util.CertTools;
import org.cesecore.util.SimpleTime;
import org.cesecore.util.StringTools;

/**
 * Holds non-sensitive information about a X509CA.
 *
 * @version $Id: X509CAInfo.java 34456 2020-02-06 18:36:20Z anatom $
 */
public class X509CAInfo extends CAInfo {

  private static final long serialVersionUID = 2L;
  /** Policies. */
  private List&lt;CertificatePolicy&gt; policies;
  /** ID. */
  private boolean useauthoritykeyidentifier;
  /** Key. */
  private boolean authoritykeyidentifiercritical;
  /** CRL. */
  private boolean usecrlnumber;
  /** Critical. */
  private boolean crlnumbercritical;
  /** Dist. */
  private String defaultcrldistpoint;
  /** Issuer. */
  private String defaultcrlissuer;
  /** Locator. */
  private String defaultocsplocator;
  /** CRL. */
  private String cadefinedfreshestcrl;
  /** Name. */
  private String subjectaltname;
  /** UTF. */
  private boolean useUTF8PolicyText;
  /** Printable. */
  private boolean usePrintableStringSubjectDN;
  /** LDAP. */
  private boolean useLdapDNOrder;
  /** Dist. */
  private boolean useCrlDistributionPointOnCrl;
  /** Critical. */
  private boolean crlDistributionPointOnCrlCritical;
  /** Secret. */
<span class="nc" id="L72">  private String cmpRaAuthSecret = &quot;&quot;;</span>
  /** Access. */
  private List&lt;String&gt; authorityInformationAccess;
  /** URIs. */
  private List&lt;String&gt; certificateAiaDefaultCaIssuerUri;
  /** Constraints. */
  private List&lt;String&gt; nameConstraintsPermitted;
  /** Constraints. */
  private List&lt;String&gt; nameConstraintsExcluded;
  /** CDP. */
  private String externalCdp;
  /** Changed. */
  private boolean nameChanged;
  /** SN size. */
  private int caSerialNumberOctetSize;

  /**
   * This constructor can be used when creating a CA. This constructor uses
   * defaults for the fields that are not specified.
   *
   * @param subjectdn DN
   * @param name Name
   * @param status Status
   * @param certificateProfileId Profile
   * @param encodedValidity Vlidity
   * @param signedby Signer
   * @param certificatechain Certs
   * @param catoken Token
   */
  public X509CAInfo(
      final String subjectdn,
      final String name,
      final int status,
      final int certificateProfileId,
      final String encodedValidity,
      final int signedby,
      final Collection&lt;Certificate&gt; certificatechain,
      final CAToken catoken) {
<span class="nc" id="L110">    this(</span>
        subjectdn,
        name,
        status, // CA status (CAConstants.CA_ACTIVE, etc.)
        new Date(), // update time
        &quot;&quot;, // Subject Alternative name
        certificateProfileId, // CA certificate profile
        0, // default ca profile
        false, // default is certificate data table
        encodedValidity,
        null, // Expiretime
        CAInfo.CATYPE_X509, // CA type (X509/CVC)
        signedby, // Signed by CA
        certificatechain, // Certificate chain
        catoken, // CA Token
        &quot;&quot;, // Description
        CesecoreConfiguration
<span class="nc" id="L127">            .getSerialNumberOctetSizeForNewCa(), // serial number octet size</span>
        -1, // Revocation reason
        null, // Revocation date
        null, // PolicyId
        1 * SimpleTime.MILLISECONDS_PER_DAY, // CRLPeriod
        0L, // CRLIssueInterval
        10 * SimpleTime.MILLISECONDS_PER_MINUTE, // CRLOverlapTime
        0L, // DeltaCRLPeriod
        new ArrayList&lt;Integer&gt;(),
        new ArrayList&lt;Integer&gt;(),
        true, // Authority Key Identifier
        false, // Authority Key Identifier Critical
        true, // CRL Number
        false, // CRL Number Critical
        null, // defaultcrldistpoint
        null, // defaultcrlissuer
        null, // defaultocsplocator
        null, // CRL Authority Information Access (AIA) extension
        null, // Certificate AIA default CA issuer URI
        null,
        null, // Name Constraints (permitted/excluded)
        null, // defaultfreshestcrl
        true, // Finish User
        new ArrayList&lt;ExtendedCAServiceInfo&gt;(), // no extended services
        false, // use default utf8 settings
        new HashMap&lt;ApprovalRequestType, Integer&gt;(), // approvals
        false, // Use UTF8 subject DN by default
        true, // Use LDAP DN order by default
        false, // Use CRL Distribution Point on CRL
        false, // CRL Distribution Point on CRL critical
        true, // Include in HealthCheck
        true, // isDoEnforceUniquePublicKeys
        true, // isDoEnforceUniqueDistinguishedName
        false, // isDoEnforceUniqueSubjectDNSerialnumber
        false, // useCertReqHistory
        true, // useUserStorage
        true, // useCertificateStorage
        false, // acceptRevocationNonExistingEntry
        null, // cmpRaAuthSecret
        false // keepExpiredCertsOnCRL
        );
<span class="nc" id="L168">  }</span>

  /**
   * Constructor that should be used when creating CA and retrieving CA info.
   * Please use the shorter form if you do not need to set all of the values.
   *
   * @param subjectDn the Subject DN of the CA as found in the certificate
   * @param name the name of the CA shown in EJBCA, can be changed by the user
   * @param status the operational status of the CA, one of the constants in
   *     {@link CAConstants}
   * @param updateTime the last time this CA was updated, normally the current
   *     date and time
   * @param asubjectaltname the Subject Alternative Name (SAN) of the CA, as
   *     found in the certificate
   * @param certificateprofileid the ID of the certificate profile for this CA
   * @param defaultCertprofileId the id of default cetificate profile for
   *     certificates this CA issues
   * @param useNoConflictCertificateData should use NoConflictCertificate data
   *     table to write to
   * @param encodedValidity the validity of this CA as a human-readable string,
   *     e.g. 25y
   * @param expiretime the date when this CA expires
   * @param catype the type of CA, in this case CAInfo.CATYPE_X509
   * @param signedBy the id of the CA which signed this CA
   * @param certificatechain the certificate chain containing the CA certificate
   *     of this CA
   * @param catoken the CA token for this CA, containing e.g. a reference to the
   *     crypto token
   * @param description a text describing this CA
   * @param acaSerialNumberOctetSize serial number octet size for this CA
   * @param revocationReason the reason why this CA was revoked, or -1 if not
   *     revoked
   * @param revocationDate the date of revocation, or null if not revoked
   * @param apolicies a policy OID
   * @param crlperiod the CRL validity period in ms
   * @param crlIssueInterval how often in ms the CRLs should be distributed,
   *     e.g. 3600000 will generate a new CRL every hour
   * @param crlOverlapTime the validity overlap in ms for a subsequent CRL, e.g.
   *     5000 will generate a CRL 5m before the previous CRL expires
   * @param deltacrlperiod how often Delta CRLs should be distributed
   * @param crlpublishers a collection of publisher IDs for this CA
   * @param keyValidators a collection of key validator IDs for this CA
   * @param auseauthoritykeyidentifier bool
   * @param aauthoritykeyidentifiercritical bool
   * @param ausecrlnumber bool
   * @param acrlnumbercritical bool
   * @param adefaultcrldistpoint the URI of the default CRL distribution point
   * @param adefaultcrlissuer Issuer
   * @param defaultocspservicelocator Locator
   * @param aauthorityInformationAccess Acces
   * @param acertificateAiaDefaultCaIssuerUri Issuer URI
   * @param anameConstraintsPermitted a list of name constraints which should be
   *     permitted
   * @param anameConstraintsExcluded a list of name constraints which should be
   *     excluded
   * @param acadefinedfreshestcrl CRL
   * @param finishuser bool
   * @param extendedcaserviceinfos bool
   * @param auseUTF8PolicyText bool
   * @param approvals a map of approval profiles which should be used for
   *     different operations
   * @param ausePrintableStringSubjectDN bool
   * @param auseLdapDnOrder biik
   * @param auseCrlDistributionPointOnCrl bool
   * @param acrlDistributionPointOnCrlCritical bool
   * @param includeInHealthCheck enable healthcheck for this CA
   * @param adoEnforceUniquePublicKeys bool
   * @param adoEnforceUniqueDistinguishedName bool
   * @param adoEnforceUniqueSubjectDNSerialnumber bool
   * @param auseCertReqHistory bool
   * @param auseUserStorage bool
   * @param auseCertificateStorage bool
   * @param aacceptRevocationNonExistingEntry bool
   * @param acmpRaAuthSecret bool
   * @param keepExpiredCertsOnCRL bool
   */
  private X509CAInfo(
      final String subjectDn,
      final String name,
      final int status,
      final Date updateTime,
      final String asubjectaltname,
      final int certificateprofileid,
      final int defaultCertprofileId,
      final boolean useNoConflictCertificateData,
      final String encodedValidity,
      final Date expiretime,
      final int catype,
      final int signedBy,
      final Collection&lt;Certificate&gt; certificatechain,
      final CAToken catoken,
      final String description,
      final int acaSerialNumberOctetSize,
      final int revocationReason,
      final Date revocationDate,
      final List&lt;CertificatePolicy&gt; apolicies,
      final long crlperiod,
      final long crlIssueInterval,
      final long crlOverlapTime,
      final long deltacrlperiod,
      final Collection&lt;Integer&gt; crlpublishers,
      final Collection&lt;Integer&gt; keyValidators,
      final boolean auseauthoritykeyidentifier,
      final boolean aauthoritykeyidentifiercritical,
      final boolean ausecrlnumber,
      final boolean acrlnumbercritical,
      final String adefaultcrldistpoint,
      final String adefaultcrlissuer,
      final String defaultocspservicelocator,
      final List&lt;String&gt; aauthorityInformationAccess,
      final List&lt;String&gt; acertificateAiaDefaultCaIssuerUri,
      final List&lt;String&gt; anameConstraintsPermitted,
      final List&lt;String&gt; anameConstraintsExcluded,
      final String acadefinedfreshestcrl,
      final boolean finishuser,
      final Collection&lt;ExtendedCAServiceInfo&gt; extendedcaserviceinfos,
      final boolean auseUTF8PolicyText,
      final Map&lt;ApprovalRequestType, Integer&gt; approvals,
      final boolean ausePrintableStringSubjectDN,
      final boolean auseLdapDnOrder,
      final boolean auseCrlDistributionPointOnCrl,
      final boolean acrlDistributionPointOnCrlCritical,
      final boolean includeInHealthCheck,
      final boolean adoEnforceUniquePublicKeys,
      final boolean adoEnforceUniqueDistinguishedName,
      final boolean adoEnforceUniqueSubjectDNSerialnumber,
      final boolean auseCertReqHistory,
      final boolean auseUserStorage,
      final boolean auseCertificateStorage,
      final boolean aacceptRevocationNonExistingEntry,
      final String acmpRaAuthSecret,
<span class="nc" id="L299">      final boolean keepExpiredCertsOnCRL) {</span>
<span class="nc" id="L300">    this.subjectdn = CertTools.stringToBCDNString(StringTools.strip(subjectDn));</span>
<span class="nc" id="L301">    this.caid = CertTools.stringToBCDNString(this.subjectdn).hashCode();</span>
<span class="nc" id="L302">    this.name = name;</span>
<span class="nc" id="L303">    this.status = status;</span>
<span class="nc" id="L304">    this.updatetime = updateTime;</span>
<span class="nc" id="L305">    this.encodedValidity = encodedValidity;</span>
<span class="nc" id="L306">    this.expiretime = expiretime;</span>
<span class="nc" id="L307">    this.catype = catype;</span>
<span class="nc" id="L308">    this.signedby = signedBy;</span>
    // Due to a bug in Glassfish v1 (fixed in v2), we used to have to make sure
    // all certificates in this
    // Array were of SUNs own provider, using
    // CertTools.SYSTEM_SECURITY_PROVIDER.
    // As of EJBCA 3.9.3 we decided that we don't have to support Glassfish v1
    // anymore.
    try {
<span class="nc bnc" id="L316" title="All 2 branches missed.">      if (certificatechain != null) {</span>
<span class="nc" id="L317">        X509Certificate[] certs =</span>
<span class="nc" id="L318">            certificatechain.toArray(</span>
<span class="nc" id="L319">                new X509Certificate[certificatechain.size()]);</span>
<span class="nc" id="L320">        List&lt;Certificate&gt; list =</span>
<span class="nc" id="L321">            CertTools.getCertCollectionFromArray(certs, null);</span>
<span class="nc" id="L322">        setCertificateChain(list);</span>
<span class="nc" id="L323">      } else {</span>
<span class="nc" id="L324">        setCertificateChain(null);</span>
      }
<span class="nc" id="L326">    } catch (CertificateException e) {</span>
<span class="nc" id="L327">      throw new IllegalArgumentException(e);</span>
<span class="nc" id="L328">    } catch (NoSuchProviderException e) {</span>
<span class="nc" id="L329">      throw new IllegalArgumentException(e);</span>
<span class="nc" id="L330">    }</span>
<span class="nc" id="L331">    this.catoken = catoken;</span>
<span class="nc" id="L332">    this.description = description;</span>
<span class="nc" id="L333">    setRevocationReason(revocationReason);</span>
<span class="nc" id="L334">    this.revocationDate = revocationDate;</span>
<span class="nc" id="L335">    this.policies = apolicies;</span>
<span class="nc" id="L336">    this.crlperiod = crlperiod;</span>
<span class="nc" id="L337">    this.crlIssueInterval = crlIssueInterval;</span>
<span class="nc" id="L338">    this.crlOverlapTime = crlOverlapTime;</span>
<span class="nc" id="L339">    this.deltacrlperiod = deltacrlperiod;</span>
<span class="nc" id="L340">    this.crlpublishers = crlpublishers;</span>
<span class="nc" id="L341">    this.validators = keyValidators;</span>
<span class="nc" id="L342">    this.useauthoritykeyidentifier = auseauthoritykeyidentifier;</span>
<span class="nc" id="L343">    this.authoritykeyidentifiercritical = aauthoritykeyidentifiercritical;</span>
<span class="nc" id="L344">    this.usecrlnumber = ausecrlnumber;</span>
<span class="nc" id="L345">    this.crlnumbercritical = acrlnumbercritical;</span>
<span class="nc" id="L346">    this.defaultcrldistpoint = adefaultcrldistpoint;</span>
<span class="nc" id="L347">    this.defaultcrlissuer = adefaultcrlissuer;</span>
<span class="nc" id="L348">    this.defaultocsplocator = defaultocspservicelocator;</span>
<span class="nc" id="L349">    this.cadefinedfreshestcrl = acadefinedfreshestcrl;</span>
<span class="nc" id="L350">    this.finishuser = finishuser;</span>
<span class="nc" id="L351">    this.subjectaltname = asubjectaltname;</span>
<span class="nc" id="L352">    this.certificateprofileid = certificateprofileid;</span>
<span class="nc" id="L353">    this.defaultCertificateProfileId = defaultCertprofileId;</span>
<span class="nc" id="L354">    this.extendedcaserviceinfos = extendedcaserviceinfos;</span>
<span class="nc" id="L355">    this.useUTF8PolicyText = auseUTF8PolicyText;</span>
<span class="nc" id="L356">    setApprovals(approvals);</span>
<span class="nc" id="L357">    this.usePrintableStringSubjectDN = ausePrintableStringSubjectDN;</span>
<span class="nc" id="L358">    this.useLdapDNOrder = auseLdapDnOrder;</span>
<span class="nc" id="L359">    this.useCrlDistributionPointOnCrl = auseCrlDistributionPointOnCrl;</span>
<span class="nc" id="L360">    this.crlDistributionPointOnCrlCritical = acrlDistributionPointOnCrlCritical;</span>
<span class="nc" id="L361">    this.includeInHealthCheck = includeInHealthCheck;</span>
<span class="nc" id="L362">    this.doEnforceUniquePublicKeys = adoEnforceUniquePublicKeys;</span>
<span class="nc" id="L363">    this.doEnforceUniqueDistinguishedName = adoEnforceUniqueDistinguishedName;</span>
<span class="nc" id="L364">    this.doEnforceUniqueSubjectDNSerialnumber =</span>
        adoEnforceUniqueSubjectDNSerialnumber;
<span class="nc" id="L366">    this.useCertReqHistory = auseCertReqHistory;</span>
<span class="nc" id="L367">    this.useUserStorage = auseUserStorage;</span>
<span class="nc" id="L368">    this.useCertificateStorage = auseCertificateStorage;</span>
<span class="nc" id="L369">    this.acceptRevocationNonExistingEntry = aacceptRevocationNonExistingEntry;</span>
<span class="nc" id="L370">    setCmpRaAuthSecret(acmpRaAuthSecret);</span>
<span class="nc" id="L371">    this.keepExpiredCertsOnCRL = keepExpiredCertsOnCRL;</span>
<span class="nc" id="L372">    this.authorityInformationAccess = aauthorityInformationAccess;</span>
<span class="nc" id="L373">    this.certificateAiaDefaultCaIssuerUri = acertificateAiaDefaultCaIssuerUri;</span>
<span class="nc" id="L374">    this.nameConstraintsPermitted = anameConstraintsPermitted;</span>
<span class="nc" id="L375">    this.nameConstraintsExcluded = anameConstraintsExcluded;</span>
<span class="nc" id="L376">    this.useNoConflictCertificateData = useNoConflictCertificateData;</span>
<span class="nc" id="L377">    this.caSerialNumberOctetSize = acaSerialNumberOctetSize;</span>
<span class="nc" id="L378">  }</span>

  /**
   * Constructor that should be used when creating CA and retrieving CA info.
   * Please use the shorter form if you do not need to set all of the values.
   *
   * @param caid ID of the CA
   * @param defaultCertprofileId the id of default cetificate profile for
   *     certificates this CA issues
   * @param useNoConflictCertificateData should use NoConflictCertificate data
   *     table to write to
   * @param encodedValidity the validity of this CA as a human-readable string,
   *     e.g. 25y
   * @param catoken the CA token for this CA, containing e.g. a reference to the
   *     crypto token
   * @param description a text describing this CA
   * @param acaSerialNumberOctetSize serial number octet size for this CA
   * @param crlperiod the CRL validity period in ms
   * @param crlIssueInterval how often in ms the CRLs should be distributed,
   *     e.g. 3600000 will generate a new CRL every hour
   * @param crlOverlapTime the validity overlap in ms for a subsequent CRL, e.g.
   *     5000 will generate a CRL 5m before the previous CRL expires
   * @param deltacrlperiod how often Delta CRLs should be distributed
   * @param crlpublishers a collection of publisher IDs for this CA
   * @param keyValidators a collection of key validator IDs for this CA
   * @param auseauthoritykeyidentifier bool
   * @param aauthoritykeyidentifiercritical bool
   * @param ausecrlnumber bool
   * @param acrlnumbercritical bool
   * @param adefaultcrldistpoint the URI of the default CRL distribution point
   * @param adefaultcrlissuer Issuer
   * @param defaultocspservicelocator Locator
   * @param crlAuthorityInformationAccess Access info to CRLs
   * @param acertificateAiaDefaultCaIssuerUri Issuer URI
   * @param anameConstraintsPermitted a list of name constraints which should be
   *     permitted
   * @param anameConstraintsExcluded a list of name constraints which should be
   *     excluded
   * @param acadefinedfreshestcrl CRL
   * @param finishuser bool
   * @param extendedcaserviceinfos bool
   * @param auseUTF8PolicyText bool
   * @param approvals a map of approval profiles which should be used for
   *     different operations
   * @param ausePrintableStringSubjectDN bool
   * @param useLdapDnOrder biik
   * @param auseCrlDistributionPointOnCrl bool
   * @param acrlDistributionPointOnCrlCritical bool
   * @param includeInHealthCheck enable healthcheck for this CA
   * @param adoEnforceUniquePublicKeys bool
   * @param adoEnforceUniqueDistinguishedName bool
   * @param adoEnforceUniqueSubjectDNSerialnumber bool
   * @param auseCertReqHistory bool
   * @param auseUserStorage bool
   * @param auseCertificateStorage bool
   * @param aacceptRevocationNonExistingEntry bool
   * @param acmpRaAuthSecret bool
   * @param keepExpiredCertsOnCRL bool
   */
  public X509CAInfo(
      final int caid,
      final String encodedValidity,
      final CAToken catoken,
      final String description,
      final int acaSerialNumberOctetSize,
      final long crlperiod,
      final long crlIssueInterval,
      final long crlOverlapTime,
      final long deltacrlperiod,
      final Collection&lt;Integer&gt; crlpublishers,
      final Collection&lt;Integer&gt; keyValidators,
      final boolean auseauthoritykeyidentifier,
      final boolean aauthoritykeyidentifiercritical,
      final boolean ausecrlnumber,
      final boolean acrlnumbercritical,
      final String adefaultcrldistpoint,
      final String adefaultcrlissuer,
      final String defaultocspservicelocator,
      final List&lt;String&gt; crlAuthorityInformationAccess,
      final List&lt;String&gt; acertificateAiaDefaultCaIssuerUri,
      final List&lt;String&gt; anameConstraintsPermitted,
      final List&lt;String&gt; anameConstraintsExcluded,
      final String acadefinedfreshestcrl,
      final boolean finishuser,
      final Collection&lt;ExtendedCAServiceInfo&gt; extendedcaserviceinfos,
      final boolean auseUTF8PolicyText,
      final Map&lt;ApprovalRequestType, Integer&gt; approvals,
      final boolean ausePrintableStringSubjectDN,
      final boolean useLdapDnOrder,
      final boolean auseCrlDistributionPointOnCrl,
      final boolean acrlDistributionPointOnCrlCritical,
      final boolean includeInHealthCheck,
      final boolean adoEnforceUniquePublicKeys,
      final boolean adoEnforceUniqueDistinguishedName,
      final boolean adoEnforceUniqueSubjectDNSerialnumber,
      final boolean auseCertReqHistory,
      final boolean auseUserStorage,
      final boolean auseCertificateStorage,
      final boolean aacceptRevocationNonExistingEntry,
      final String acmpRaAuthSecret,
      final boolean keepExpiredCertsOnCRL,
      final int defaultCertprofileId,
<span class="nc" id="L480">      final boolean useNoConflictCertificateData) {</span>
<span class="nc" id="L481">    this.caid = caid;</span>
<span class="nc" id="L482">    this.encodedValidity = encodedValidity;</span>
<span class="nc" id="L483">    this.catoken = catoken;</span>
<span class="nc" id="L484">    this.description = description;</span>
<span class="nc" id="L485">    this.caSerialNumberOctetSize = acaSerialNumberOctetSize;</span>
<span class="nc" id="L486">    this.crlperiod = crlperiod;</span>
<span class="nc" id="L487">    this.crlIssueInterval = crlIssueInterval;</span>
<span class="nc" id="L488">    this.crlOverlapTime = crlOverlapTime;</span>
<span class="nc" id="L489">    this.deltacrlperiod = deltacrlperiod;</span>
<span class="nc" id="L490">    this.crlpublishers = crlpublishers;</span>
<span class="nc" id="L491">    this.validators = keyValidators;</span>
<span class="nc" id="L492">    this.useauthoritykeyidentifier = auseauthoritykeyidentifier;</span>
<span class="nc" id="L493">    this.authoritykeyidentifiercritical = aauthoritykeyidentifiercritical;</span>
<span class="nc" id="L494">    this.usecrlnumber = ausecrlnumber;</span>
<span class="nc" id="L495">    this.crlnumbercritical = acrlnumbercritical;</span>
<span class="nc" id="L496">    this.defaultcrldistpoint = adefaultcrldistpoint;</span>
<span class="nc" id="L497">    this.defaultcrlissuer = adefaultcrlissuer;</span>
<span class="nc" id="L498">    this.defaultocsplocator = defaultocspservicelocator;</span>
<span class="nc" id="L499">    this.cadefinedfreshestcrl = acadefinedfreshestcrl;</span>
<span class="nc" id="L500">    this.finishuser = finishuser;</span>
<span class="nc" id="L501">    this.extendedcaserviceinfos = extendedcaserviceinfos;</span>
<span class="nc" id="L502">    this.useUTF8PolicyText = auseUTF8PolicyText;</span>
<span class="nc" id="L503">    setApprovals(approvals);</span>
<span class="nc" id="L504">    this.usePrintableStringSubjectDN = ausePrintableStringSubjectDN;</span>
<span class="nc" id="L505">    this.useLdapDNOrder = useLdapDnOrder;</span>
<span class="nc" id="L506">    this.useCrlDistributionPointOnCrl = auseCrlDistributionPointOnCrl;</span>
<span class="nc" id="L507">    this.crlDistributionPointOnCrlCritical = acrlDistributionPointOnCrlCritical;</span>
<span class="nc" id="L508">    this.includeInHealthCheck = includeInHealthCheck;</span>
<span class="nc" id="L509">    this.doEnforceUniquePublicKeys = adoEnforceUniquePublicKeys;</span>
<span class="nc" id="L510">    this.doEnforceUniqueDistinguishedName = adoEnforceUniqueDistinguishedName;</span>
<span class="nc" id="L511">    this.doEnforceUniqueSubjectDNSerialnumber =</span>
        adoEnforceUniqueSubjectDNSerialnumber;
<span class="nc" id="L513">    this.useCertReqHistory = auseCertReqHistory;</span>
<span class="nc" id="L514">    this.useUserStorage = auseUserStorage;</span>
<span class="nc" id="L515">    this.useCertificateStorage = auseCertificateStorage;</span>
<span class="nc" id="L516">    this.acceptRevocationNonExistingEntry = aacceptRevocationNonExistingEntry;</span>
<span class="nc" id="L517">    setCmpRaAuthSecret(acmpRaAuthSecret);</span>
<span class="nc" id="L518">    this.keepExpiredCertsOnCRL = keepExpiredCertsOnCRL;</span>
<span class="nc" id="L519">    this.authorityInformationAccess = crlAuthorityInformationAccess;</span>
<span class="nc" id="L520">    this.certificateAiaDefaultCaIssuerUri = acertificateAiaDefaultCaIssuerUri;</span>
<span class="nc" id="L521">    this.nameConstraintsPermitted = anameConstraintsPermitted;</span>
<span class="nc" id="L522">    this.nameConstraintsExcluded = anameConstraintsExcluded;</span>
<span class="nc" id="L523">    this.defaultCertificateProfileId = defaultCertprofileId;</span>
<span class="nc" id="L524">    this.useNoConflictCertificateData = useNoConflictCertificateData;</span>
<span class="nc" id="L525">  }</span>
  /** @return policies */
  public List&lt;CertificatePolicy&gt; getPolicies() {
<span class="nc" id="L528">    return this.policies;</span>
  }

  /** @param aPolicies policies  */
  public void setPolicies(final List&lt;CertificatePolicy&gt; aPolicies) {
<span class="nc" id="L533">    this.policies = aPolicies;</span>
<span class="nc" id="L534">  }</span>

  /** @return boolean */
  public boolean getUseCRLNumber() {
<span class="nc" id="L538">    return usecrlnumber;</span>
  }
  /** @param aUsecrlnumber boolean  */
  public void setUseCRLNumber(final boolean aUsecrlnumber) {
<span class="nc" id="L542">    this.usecrlnumber = aUsecrlnumber;</span>
<span class="nc" id="L543">  }</span>
  /** @return boolean */
  public boolean getCRLNumberCritical() {
<span class="nc" id="L546">    return crlnumbercritical;</span>
  }

  /** @param aCrlnumbercritical boolean */
  public void setCRLNumberCritical(final boolean aCrlnumbercritical) {
<span class="nc" id="L551">    this.crlnumbercritical = aCrlnumbercritical;</span>
<span class="nc" id="L552">  }</span>

  /** @return boolean */
  public boolean getUseAuthorityKeyIdentifier() {
<span class="nc" id="L556">    return useauthoritykeyidentifier;</span>
  }
  /** @param aUseauthoritykeyidentifier boolean */
  public void setUseAuthorityKeyIdentifier(
          final boolean aUseauthoritykeyidentifier) {
<span class="nc" id="L561">    this.useauthoritykeyidentifier = aUseauthoritykeyidentifier;</span>
<span class="nc" id="L562">  }</span>
  /** @return boolean */
  public boolean getAuthorityKeyIdentifierCritical() {
<span class="nc" id="L565">    return authoritykeyidentifiercritical;</span>
  }
  /** @param aAuthoritykeyidentifiercritical boolean */
  public void setAuthorityKeyIdentifierCritical(
      final boolean aAuthoritykeyidentifiercritical) {
<span class="nc" id="L570">    this.authoritykeyidentifiercritical = aAuthoritykeyidentifiercritical;</span>
<span class="nc" id="L571">  }</span>

  /** @return dist */
  public String getDefaultCRLDistPoint() {
<span class="nc" id="L575">    return defaultcrldistpoint;</span>
  }

  /** @param aDefaultCRLDistPoint dist */
  public void setDefaultCRLDistPoint(final String aDefaultCRLDistPoint) {
<span class="nc" id="L580">    this.defaultcrldistpoint = aDefaultCRLDistPoint;</span>
<span class="nc" id="L581">  }</span>

  /** @return issuer */
  public String getDefaultCRLIssuer() {
<span class="nc" id="L585">    return defaultcrlissuer;</span>
  }

  /** @param aDefaultcrlissuer issuer */
  public void setDefaultCRLIssuer(final String aDefaultcrlissuer) {
<span class="nc" id="L590">    this.defaultcrlissuer = aDefaultcrlissuer;</span>
<span class="nc" id="L591">  }</span>

  /** @return locator */
  public String getDefaultOCSPServiceLocator() {
<span class="nc" id="L595">    return defaultocsplocator;</span>
  }
 /** @param aDefaultocsplocator locator */
  public void setDefaultOCSPServiceLocator(final String aDefaultocsplocator) {
<span class="nc" id="L599">    this.defaultocsplocator = aDefaultocsplocator;</span>
<span class="nc" id="L600">  }</span>

  /** @return crl */
  public String getCADefinedFreshestCRL() {
<span class="nc" id="L604">    return this.cadefinedfreshestcrl;</span>
  }

  /**@param cADefinedFreshestCRL CRL */
  public void setCADefinedFreshestCRL(final String cADefinedFreshestCRL) {
<span class="nc" id="L609">    this.cadefinedfreshestcrl = cADefinedFreshestCRL;</span>
<span class="nc" id="L610">  }</span>

  /** @return name */
  public String getSubjectAltName() {
<span class="nc" id="L614">    return subjectaltname;</span>
  }

  /** @param aSubjectaltname name */
  public void setSubjectAltName(final String aSubjectaltname) {
<span class="nc" id="L619">    this.subjectaltname = aSubjectaltname;</span>
<span class="nc" id="L620">  }</span>

  /** @return boolean */
  public boolean getUseUTF8PolicyText() {
<span class="nc" id="L624">    return useUTF8PolicyText;</span>
  }
  /** @param aUseUTF8PolicyText boolean */
  public void setUseUTF8PolicyText(final boolean aUseUTF8PolicyText) {
<span class="nc" id="L628">    this.useUTF8PolicyText = aUseUTF8PolicyText;</span>
<span class="nc" id="L629">  }</span>
  /** @return boolean */
  public boolean getUsePrintableStringSubjectDN() {
<span class="nc" id="L632">    return usePrintableStringSubjectDN;</span>
  }

  /** @param aUsePrintableStringSubjectDN boolean  */
  public void setUsePrintableStringSubjectDN(
      final boolean aUsePrintableStringSubjectDN) {
<span class="nc" id="L638">    this.usePrintableStringSubjectDN = aUsePrintableStringSubjectDN;</span>
<span class="nc" id="L639">  }</span>

  /** @return boolean */
  public boolean getUseLdapDnOrder() {
<span class="nc" id="L643">    return useLdapDNOrder;</span>
  }
  /** @param aUseLdapDNOrder boolean */
  public void setUseLdapDnOrder(final boolean aUseLdapDNOrder) {
<span class="nc" id="L647">    this.useLdapDNOrder = aUseLdapDNOrder;</span>
<span class="nc" id="L648">  }</span>

  /** @return boolean */
  public boolean getUseCrlDistributionPointOnCrl() {
<span class="nc" id="L652">    return this.useCrlDistributionPointOnCrl;</span>
  }

  /** @param aUseCrlDistributionPointOnCrl boolean */
  public void setUseCrlDistributionPointOnCrl(
      final boolean aUseCrlDistributionPointOnCrl) {
<span class="nc" id="L658">    this.useCrlDistributionPointOnCrl = aUseCrlDistributionPointOnCrl;</span>
<span class="nc" id="L659">  }</span>

  /** @return boolean */
  public boolean getCrlDistributionPointOnCrlCritical() {
<span class="nc" id="L663">    return this.crlDistributionPointOnCrlCritical;</span>
  }

  /** @param aCrlDistributionPointOnCrlCritical boolean */
  public void setCrlDistributionPointOnCrlCritical(
      final boolean aCrlDistributionPointOnCrlCritical) {
<span class="nc" id="L669">    this.crlDistributionPointOnCrlCritical = aCrlDistributionPointOnCrlCritical;</span>
<span class="nc" id="L670">  }</span>

  /** @return secret */
  public String getCmpRaAuthSecret() {
<span class="nc" id="L674">    return cmpRaAuthSecret;</span>
  }

  /** @param aCmpRaAuthSecret cmpRaAuthSecret */
  public void setCmpRaAuthSecret(final String aCmpRaAuthSecret) {
<span class="nc bnc" id="L679" title="All 2 branches missed.">    this.cmpRaAuthSecret = aCmpRaAuthSecret == null ? &quot;&quot; : aCmpRaAuthSecret;</span>
<span class="nc" id="L680">  }</span>

  /** @return list */
  public List&lt;String&gt; getAuthorityInformationAccess() {
<span class="nc" id="L684">    return authorityInformationAccess;</span>
  }

  /** @param list list */
  public void setAuthorityInformationAccess(final List&lt;String&gt; list) {
<span class="nc" id="L689">    this.authorityInformationAccess = list;</span>
<span class="nc" id="L690">  }</span>

  /** @return the certificateAiaDefaultCaIssuerUri */
  public List&lt;String&gt; getCertificateAiaDefaultCaIssuerUri() {
<span class="nc" id="L694">    return certificateAiaDefaultCaIssuerUri;</span>
  }

  /** @param list the certificateAiaDefaultCaIssuerUri to set */
  public void setCertificateAiaDefaultCaIssuerUri(final List&lt;String&gt; list) {
<span class="nc" id="L699">    this.certificateAiaDefaultCaIssuerUri = list;</span>
<span class="nc" id="L700">  }</span>

  /**
   * @return a list of encoded names of the permitted names in issued
   *     certificates
   */
  public List&lt;String&gt; getNameConstraintsPermitted() {
<span class="nc" id="L707">    return nameConstraintsPermitted;</span>
  }

  /** @param encodedNames names */
  public void setNameConstraintsPermitted(final List&lt;String&gt; encodedNames) {
<span class="nc" id="L712">    nameConstraintsPermitted = encodedNames;</span>
<span class="nc" id="L713">  }</span>

  /**
   * @return a list of encoded names of the forbidden names in issued
   *     certificates
   */
  public List&lt;String&gt; getNameConstraintsExcluded() {
<span class="nc" id="L720">    return nameConstraintsExcluded;</span>
  }

  /** @param encodedNames Names. */
  public void setNameConstraintsExcluded(final List&lt;String&gt; encodedNames) {
<span class="nc" id="L725">    nameConstraintsExcluded = encodedNames;</span>
<span class="nc" id="L726">  }</span>

  /**
   * @return what should be a String formatted URL pointing to an external CA's
   *     CDP.
   */
  public String getExternalCdp() {
<span class="nc" id="L733">    return externalCdp;</span>
  }

  /**
   * Set what should be a String formatted URL pointing to an external CA's CDP.
   *
   * @param aExternalCdp CDP
   */
  public void setExternalCdp(final String aExternalCdp) {
<span class="nc" id="L742">    this.externalCdp = aExternalCdp;</span>
<span class="nc" id="L743">  }</span>

  /**
   * @return true if CA has undergone through name change at some renewal
   *     process, otherwise false.
   */
  public boolean getNameChanged() {
<span class="nc" id="L750">    return nameChanged;</span>
  }

  /**
   * NameChanged attribute should only be set when X509CA is retrieved from DB.
   *
   * @param value new name
   */
  void setNameChanged(final boolean value) {
<span class="nc" id="L759">    nameChanged = value;</span>
<span class="nc" id="L760">  }</span>

  /** @return size. */
  public int getCaSerialNumberOctetSize() {
<span class="nc" id="L764">    return caSerialNumberOctetSize;</span>
  }

  /** @param aCaSerialNumberOctetSize size */
  public void setCaSerialNumberOctetSize(final int aCaSerialNumberOctetSize) {
<span class="nc" id="L769">    this.caSerialNumberOctetSize = aCaSerialNumberOctetSize;</span>
<span class="nc" id="L770">  }</span>

  /** Factory. */
<span class="nc" id="L773">  public static class X509CAInfoBuilder {</span>
    /** DN. */
    private String subjectDn;
    /** Name. */
    private String name;
    /** Status. */
    private int status;
    /** ID. */
    private int certificateProfileId;
    /** Validity. */
    private String encodedValidity;
    /** Signers. */
    private int signedBy;
    /** Certs. */
    private Collection&lt;Certificate&gt; certificateChain;
    /** Token. */
    private CAToken caToken;
    /** Time. */
<span class="nc" id="L791">    private Date updateTime = new Date();</span>
    /** Name. */
<span class="nc" id="L793">    private String subjectAltName = &quot;&quot;;</span>
    /** ID. */
<span class="nc" id="L795">    private int defaultCertProfileId = 0;</span>
    /** Boolean. */
<span class="nc" id="L797">    private boolean useNoConflictCertificateData = false;</span>
    /** Time. */
<span class="nc" id="L799">    private Date expireTime = null;</span>
    /** Type. */
<span class="nc" id="L801">    private int caType = CAInfo.CATYPE_X509;</span>
    /** Description. */
<span class="nc" id="L803">    private String description = &quot;&quot;;</span>
    /** SN size. */
<span class="nc" id="L805">    private int caSerialNumberOctetSize = -1;</span>
    /** Reason. */
<span class="nc" id="L807">    private int revocationReason = -1;</span>
    /** Date. */
<span class="nc" id="L809">    private Date revocationDate = null;</span>
    /** Policies. */
<span class="nc" id="L811">    private List&lt;CertificatePolicy&gt; policies = null;</span>
    /** Period. */
<span class="nc" id="L813">    private long crlPeriod = 1 * SimpleTime.MILLISECONDS_PER_DAY;</span>
    /** Interval. */
<span class="nc" id="L815">    private long crlIssueInterval = 0L;</span>
    /** Overlap. */
<span class="nc" id="L817">    private long crlOverlapTime = 10 * SimpleTime.MILLISECONDS_PER_MINUTE;</span>
    /** CRL change period. */
<span class="nc" id="L819">    private long deltaCrlPeriod = 0L;</span>
    /** Publishers. */
<span class="nc" id="L821">    private Collection&lt;Integer&gt; crlPublishers = new ArrayList&lt;Integer&gt;();</span>
    /** Validators. */
<span class="nc" id="L823">    private Collection&lt;Integer&gt; validators = new ArrayList&lt;Integer&gt;();</span>
    /** Boolean. */
<span class="nc" id="L825">    private boolean useAuthorityKeyIdentifier = true;</span>
    /** Boolean. */
<span class="nc" id="L827">    private boolean authorityKeyIdentifierCritical = false;</span>
    /** Boolean. */
<span class="nc" id="L829">    private boolean useCrlNumber = true;</span>
    /** Boolean. */
<span class="nc" id="L831">    private boolean crlNumberCritical = false;</span>
    /** Distribution. */
<span class="nc" id="L833">    private String defaultCrlDistPoint = null;</span>
    /** Issuer. */
<span class="nc" id="L835">    private String defaultCrlIssuer = null;</span>
    /** Locator. */
<span class="nc" id="L837">    private String defaultOcspCerviceLocator = null;</span>
    /** Access. */
<span class="nc" id="L839">    private List&lt;String&gt; authorityInformationAccess = null;</span>
    /** URIs. */
<span class="nc" id="L841">    private List&lt;String&gt; certificateAiaDefaultCaIssuerUri = null;</span>
    /** Constraints. */
<span class="nc" id="L843">    private List&lt;String&gt; nameConstraintsPermitted = null;</span>
    /** Constraints. */
<span class="nc" id="L845">    private List&lt;String&gt; nameConstraintsExcluded = null;</span>
    /** CRL. */
<span class="nc" id="L847">    private String caDefinedFreshestCrl = null;</span>
    /** Boolean. */
<span class="nc" id="L849">    private boolean finishUser = true;</span>
    /** Info. */
<span class="nc" id="L851">    private Collection&lt;ExtendedCAServiceInfo&gt; extendedCaServiceInfos =</span>
        new ArrayList&lt;ExtendedCAServiceInfo&gt;();
    /** Boolean. */
<span class="nc" id="L854">    private boolean useUtf8PolicyText = false;</span>
    /** Approvals. */
<span class="nc" id="L856">    private Map&lt;ApprovalRequestType, Integer&gt; approvals =</span>
        new HashMap&lt;ApprovalRequestType, Integer&gt;();
    /** Boolean. */
<span class="nc" id="L859">    private boolean usePrintableStringSubjectDN = false;</span>
    /** Boolean. */
<span class="nc" id="L861">    private boolean useLdapDnOrder = true;</span>
    /** Boolean. */
<span class="nc" id="L863">    private boolean useCrlDistributionPointOnCrl = false;</span>
    /** Boolean. */
<span class="nc" id="L865">    private boolean crlDistributionPointOnCrlCritical = false;</span>
    /** Boolean. */
<span class="nc" id="L867">    private boolean includeInHealthCheck = true;</span>
    /** Boolean. */
<span class="nc" id="L869">    private boolean doEnforceUniquePublicKeys = true;</span>
    /** Boolean. */
<span class="nc" id="L871">    private boolean doEnforceUniqueDistinguishedName = true;</span>
    /** Boolean. */
<span class="nc" id="L873">    private boolean doEnforceUniqueSubjectDNSerialnumber = false;</span>
    /** Boolean. */
<span class="nc" id="L875">    private boolean useCertReqHistory = false;</span>
    /** Boolean. */
<span class="nc" id="L877">    private boolean useUserStorage = true;</span>
    /** Boolean. */
<span class="nc" id="L879">    private boolean useCertificateStorage = true;</span>
    /** Boolean. */
<span class="nc" id="L881">    private boolean acceptRevocationNonExistingEntry = false;</span>
    /** Secret. */
<span class="nc" id="L883">    private String cmpRaAuthSecret = null;</span>
    /** Boolean. */
<span class="nc" id="L885">    private boolean keepExpiredCertsOnCRL = false;</span>

    /**
     * @param aSubjectDn DN
     * @return builder
     */
    public X509CAInfoBuilder setSubjectDn(final String aSubjectDn) {
<span class="nc" id="L892">      this.subjectDn = aSubjectDn;</span>
<span class="nc" id="L893">      return this;</span>
    }

    /**
     * @param aName Name
     * @return builder
     */
    public X509CAInfoBuilder setName(final String aName) {
<span class="nc" id="L901">      this.name = aName;</span>
<span class="nc" id="L902">      return this;</span>
    }

    /**
     * @param aStatus status
     * @return builder
     */
    public X509CAInfoBuilder setStatus(final int aStatus) {
<span class="nc" id="L910">      this.status = aStatus;</span>
<span class="nc" id="L911">      return this;</span>
    }

    /**
     * @param aCertificateProfileId ID
     * @return builder
     */
    public X509CAInfoBuilder setCertificateProfileId(
            final int aCertificateProfileId) {
<span class="nc" id="L920">      this.certificateProfileId = aCertificateProfileId;</span>
<span class="nc" id="L921">      return this;</span>
    }

    /**
     * @param aEncodedValidity validity
     * @return builder
     */
    public X509CAInfoBuilder setEncodedValidity(final String aEncodedValidity) {
<span class="nc" id="L929">      this.encodedValidity = aEncodedValidity;</span>
<span class="nc" id="L930">      return this;</span>
    }

    /**
     * @param aSignedBy int
     * @return builder
     */
    public X509CAInfoBuilder setSignedBy(final int aSignedBy) {
<span class="nc" id="L938">      this.signedBy = aSignedBy;</span>
<span class="nc" id="L939">      return this;</span>
    }

    /**
     * @param aCertificateChain chain
     * @return builder
     */
    public X509CAInfoBuilder setCertificateChain(
        final Collection&lt;Certificate&gt; aCertificateChain) {
<span class="nc" id="L948">      this.certificateChain = aCertificateChain;</span>
<span class="nc" id="L949">      return this;</span>
    }

    /**
     * @param aToken token
     * @return builder
     */
    public X509CAInfoBuilder setCaToken(final CAToken aToken) {
<span class="nc" id="L957">      this.caToken = aToken;</span>
<span class="nc" id="L958">      return this;</span>
    }

    /**
     * @param aUpdateTime time
     * @return builder
     */
    public X509CAInfoBuilder setUpdateTime(final Date aUpdateTime) {
<span class="nc" id="L966">      this.updateTime = aUpdateTime;</span>
<span class="nc" id="L967">      return this;</span>
    }

    /**
     * @param aSubjectAltName Name
     * @return builder
     */
    public X509CAInfoBuilder setSubjectAltName(final String aSubjectAltName) {
<span class="nc" id="L975">      this.subjectAltName = aSubjectAltName;</span>
<span class="nc" id="L976">      return this;</span>
    }

    /**
     * @param aDefaultCertProfileId ID
     * @return builder
     */
    public X509CAInfoBuilder setDefaultCertProfileId(
            final int aDefaultCertProfileId) {
<span class="nc" id="L985">      this.defaultCertProfileId = aDefaultCertProfileId;</span>
<span class="nc" id="L986">      return this;</span>
    }

    /**
     * @param aUseNoConflictCertificateData boolean
     * @return builder
     */
    public X509CAInfoBuilder setUseNoConflictCertificateData(
        final boolean aUseNoConflictCertificateData) {
<span class="nc" id="L995">      this.useNoConflictCertificateData = aUseNoConflictCertificateData;</span>
<span class="nc" id="L996">      return this;</span>
    }

    /**
     * @param aExpireTime Time
     * @return builder
     */
    public X509CAInfoBuilder setExpireTime(final Date aExpireTime) {
<span class="nc" id="L1004">      this.expireTime = aExpireTime;</span>
<span class="nc" id="L1005">      return this;</span>
    }

    /**
     * @param aType type
     * @return builder
     */
    public X509CAInfoBuilder setCaType(final int aType) {
<span class="nc" id="L1013">      this.caType = aType;</span>
<span class="nc" id="L1014">      return this;</span>
    }

    /**
     * @param aDescription desc
     * @return builder
     */
    public X509CAInfoBuilder setDescription(final String aDescription) {
<span class="nc" id="L1022">      this.description = aDescription;</span>
<span class="nc" id="L1023">      return this;</span>
    }
    /**
     * @param aRevocationReason Reason
     * @return builder
     */
    public X509CAInfoBuilder setRevocationReason(final int aRevocationReason) {
<span class="nc" id="L1030">      this.revocationReason = aRevocationReason;</span>
<span class="nc" id="L1031">      return this;</span>
    }
    /**
     * @param aRevocationDate Date
     * @return builder
     */
    public X509CAInfoBuilder setRevocationDate(final Date aRevocationDate) {
<span class="nc" id="L1038">      this.revocationDate = aRevocationDate;</span>
<span class="nc" id="L1039">      return this;</span>
    }

    /**
     * @param aPolicies Policies
     * @return builder
     */
    public X509CAInfoBuilder setPolicies(
            final List&lt;CertificatePolicy&gt; aPolicies) {
<span class="nc" id="L1048">      this.policies = aPolicies;</span>
<span class="nc" id="L1049">      return this;</span>
    }

    /**
     * @param aCrlPeriod Period
     * @return builder
     */
    public X509CAInfoBuilder setCrlPeriod(final long aCrlPeriod) {
<span class="nc" id="L1057">      this.crlPeriod = aCrlPeriod;</span>
<span class="nc" id="L1058">      return this;</span>
    }

    /**
     * @param aCrlIssueInterval Interval
     * @return builder
     */
    public X509CAInfoBuilder setCrlIssueInterval(final long aCrlIssueInterval) {
<span class="nc" id="L1066">      this.crlIssueInterval = aCrlIssueInterval;</span>
<span class="nc" id="L1067">      return this;</span>
    }

    /**
     * @param aCrlOverlapTime Time
     * @return builder
     */
    public X509CAInfoBuilder setCrlOverlapTime(final long aCrlOverlapTime) {
<span class="nc" id="L1075">      this.crlOverlapTime = aCrlOverlapTime;</span>
<span class="nc" id="L1076">      return this;</span>
    }

    /**
     * @param aDeltaCrlPeriod Period
     * @return builder
     */
    public X509CAInfoBuilder setDeltaCrlPeriod(final long aDeltaCrlPeriod) {
<span class="nc" id="L1084">      this.deltaCrlPeriod = aDeltaCrlPeriod;</span>
<span class="nc" id="L1085">      return this;</span>
    }

    /**
     * @param aCrlPublishers Publishers
     * @return builder
     */
    public X509CAInfoBuilder setCrlPublishers(
        final Collection&lt;Integer&gt; aCrlPublishers) {
<span class="nc" id="L1094">      this.crlPublishers = aCrlPublishers;</span>
<span class="nc" id="L1095">      return this;</span>
    }

    /**
     * @param aValidators validators
     * @return builder
     */
    public X509CAInfoBuilder setValidators(
            final Collection&lt;Integer&gt; aValidators) {
<span class="nc" id="L1104">      this.validators = aValidators;</span>
<span class="nc" id="L1105">      return this;</span>
    }

    /**
     * @param aUseAuthorityKeyIdentifier booleam
     * @return builder
     */
    public X509CAInfoBuilder setUseAuthorityKeyIdentifier(
        final boolean aUseAuthorityKeyIdentifier) {
<span class="nc" id="L1114">      this.useAuthorityKeyIdentifier = aUseAuthorityKeyIdentifier;</span>
<span class="nc" id="L1115">      return this;</span>
    }

    /**
     * @param aAuthorityKeyIdentifierCritical ID
     * @return builder
     */
    public X509CAInfoBuilder setAuthorityKeyIdentifierCritical(
        final boolean aAuthorityKeyIdentifierCritical) {
<span class="nc" id="L1124">      this.authorityKeyIdentifierCritical = aAuthorityKeyIdentifierCritical;</span>
<span class="nc" id="L1125">      return this;</span>
    }

    /**
     * @param aUseCrlNumber boolean
     * @return builder
     */
    public X509CAInfoBuilder setUseCrlNumber(final boolean aUseCrlNumber) {
<span class="nc" id="L1133">      this.useCrlNumber = aUseCrlNumber;</span>
<span class="nc" id="L1134">      return this;</span>
    }

    /**
     * @param aCrlNumberCritical Number
     * @return Builder
     */
    public X509CAInfoBuilder setCrlNumberCritical(
            final boolean aCrlNumberCritical) {
<span class="nc" id="L1143">      this.crlNumberCritical = aCrlNumberCritical;</span>
<span class="nc" id="L1144">      return this;</span>
    }

    /**
     * @param aDefaultCrlDistPoint Distribution
     * @return Builder
     */
    public X509CAInfoBuilder setDefaultCrlDistPoint(
        final String aDefaultCrlDistPoint) {
<span class="nc" id="L1153">      this.defaultCrlDistPoint = aDefaultCrlDistPoint;</span>
<span class="nc" id="L1154">      return this;</span>
    }

    /**
     * @param aDefaultCrlIssuer CRL issuer
     * @return Builder
     */
    public X509CAInfoBuilder setDefaultCrlIssuer(
            final String aDefaultCrlIssuer) {
<span class="nc" id="L1163">      this.defaultCrlIssuer = aDefaultCrlIssuer;</span>
<span class="nc" id="L1164">      return this;</span>
    }

    /**
     * @param aDefaultOcspCerviceLocator Locator
     * @return Builder
     */
    public X509CAInfoBuilder setDefaultOcspCerviceLocator(
        final String aDefaultOcspCerviceLocator) {
<span class="nc" id="L1173">      this.defaultOcspCerviceLocator = aDefaultOcspCerviceLocator;</span>
<span class="nc" id="L1174">      return this;</span>
    }

    /**
     * @param aAuthorityInformationAccess Access
     * @return Builder
     */
    public X509CAInfoBuilder setAuthorityInformationAccess(
        final List&lt;String&gt; aAuthorityInformationAccess) {
<span class="nc" id="L1183">      this.authorityInformationAccess = aAuthorityInformationAccess;</span>
<span class="nc" id="L1184">      return this;</span>
    }

    /**
     * @param aCertificateAiaDefaultCaIssuerUri URIs
     * @return Builder
     */
    public X509CAInfoBuilder setCertificateAiaDefaultCaIssuerUri(
        final List&lt;String&gt; aCertificateAiaDefaultCaIssuerUri) {
<span class="nc" id="L1193">      this.certificateAiaDefaultCaIssuerUri = aCertificateAiaDefaultCaIssuerUri;</span>
<span class="nc" id="L1194">      return this;</span>
    }

    /**
     * @param aNameConstraintsPermitted Constraints
     * @return builder
     */
    public X509CAInfoBuilder setNameConstraintsPermitted(
        final List&lt;String&gt; aNameConstraintsPermitted) {
<span class="nc" id="L1203">      this.nameConstraintsPermitted = aNameConstraintsPermitted;</span>
<span class="nc" id="L1204">      return this;</span>
    }

    /**
     * @param aNameConstraintsExcluded Constraints
     * @return builder
     */
    public X509CAInfoBuilder setNameConstraintsExcluded(
        final List&lt;String&gt; aNameConstraintsExcluded) {
<span class="nc" id="L1213">      this.nameConstraintsExcluded = aNameConstraintsExcluded;</span>
<span class="nc" id="L1214">      return this;</span>
    }

    /**
     * @param aCaDefinedFreshestCrl CRL
     * @return Builder
     */
    public X509CAInfoBuilder setCaDefinedFreshestCrl(
        final String aCaDefinedFreshestCrl) {
<span class="nc" id="L1223">      this.caDefinedFreshestCrl = aCaDefinedFreshestCrl;</span>
<span class="nc" id="L1224">      return this;</span>
    }

    /**
     * @param aFinishUser boolean
     * @return builder
     */
    public X509CAInfoBuilder setFinishUser(final boolean aFinishUser) {
<span class="nc" id="L1232">      this.finishUser = aFinishUser;</span>
<span class="nc" id="L1233">      return this;</span>
    }

    /**
     * @param aExtendedCaServiceInfos Infos
     * @return Builder
     */
    public X509CAInfoBuilder setExtendedCaServiceInfos(
       final Collection&lt;ExtendedCAServiceInfo&gt; aExtendedCaServiceInfos) {
<span class="nc" id="L1242">      this.extendedCaServiceInfos = aExtendedCaServiceInfos;</span>
<span class="nc" id="L1243">      return this;</span>
    }

    /**
     * @param aUseUtf8PolicyText boolean
     * @return builder
     */
    public X509CAInfoBuilder setUseUtf8PolicyText(
            final boolean aUseUtf8PolicyText) {
<span class="nc" id="L1252">      this.useUtf8PolicyText = aUseUtf8PolicyText;</span>
<span class="nc" id="L1253">      return this;</span>
    }

    /**
     * @param aApprovals approvals
     * @return builder
     */
    public X509CAInfoBuilder setApprovals(
        final Map&lt;ApprovalRequestType, Integer&gt; aApprovals) {
<span class="nc" id="L1262">      this.approvals = aApprovals;</span>
<span class="nc" id="L1263">      return this;</span>
    }

    /**
     * @param aUsePrintableStringSubjectDN boolean
     * @return builder
     */
    public X509CAInfoBuilder setUsePrintableStringSubjectDN(
        final boolean aUsePrintableStringSubjectDN) {
<span class="nc" id="L1272">      this.usePrintableStringSubjectDN = aUsePrintableStringSubjectDN;</span>
<span class="nc" id="L1273">      return this;</span>
    }

    /**
     * @param aUseLdapDnOrder boolean
     * @return builder
     */
    public X509CAInfoBuilder setUseLdapDnOrder(final boolean aUseLdapDnOrder) {
<span class="nc" id="L1281">      this.useLdapDnOrder = aUseLdapDnOrder;</span>
<span class="nc" id="L1282">      return this;</span>
    }

    /**
     * @param aUseCrlDistributionPointOnCrl boolean
     * @return builder
     */
    public X509CAInfoBuilder setUseCrlDistributionPointOnCrl(
        final boolean aUseCrlDistributionPointOnCrl) {
<span class="nc" id="L1291">      this.useCrlDistributionPointOnCrl = aUseCrlDistributionPointOnCrl;</span>
<span class="nc" id="L1292">      return this;</span>
    }

    /**
     * @param aCrlDistributionPointOnCrlCritical boolean
     * @return builder
     */
    public X509CAInfoBuilder setCrlDistributionPointOnCrlCritical(
        final boolean aCrlDistributionPointOnCrlCritical) {
<span class="nc" id="L1301">      this.crlDistributionPointOnCrlCritical =</span>
          aCrlDistributionPointOnCrlCritical;
<span class="nc" id="L1303">      return this;</span>
    }

    /**
     * @param aIncludeInHealthCheck boolean
     * @return builder
     */
    public X509CAInfoBuilder setIncludeInHealthCheck(
        final boolean aIncludeInHealthCheck) {
<span class="nc" id="L1312">      this.includeInHealthCheck = aIncludeInHealthCheck;</span>
<span class="nc" id="L1313">      return this;</span>
    }

    /**
     * @param aDoEnforceUniquePublicKeys boolean
     * @return builder
     */
    public X509CAInfoBuilder setDoEnforceUniquePublicKeys(
        final boolean aDoEnforceUniquePublicKeys) {
<span class="nc" id="L1322">      this.doEnforceUniquePublicKeys = aDoEnforceUniquePublicKeys;</span>
<span class="nc" id="L1323">      return this;</span>
    }

    /**
     * @param aDoEnforceUniqueDistinguishedName boolean
     * @return builder
     */
    public X509CAInfoBuilder setDoEnforceUniqueDistinguishedName(
        final boolean aDoEnforceUniqueDistinguishedName) {
<span class="nc" id="L1332">      this.doEnforceUniqueDistinguishedName = aDoEnforceUniqueDistinguishedName;</span>
<span class="nc" id="L1333">      return this;</span>
    }

    /**
     * @param aDoEnforceUniqueSubjectDNSerialnumber boolean
     * @return builder
     */
    public X509CAInfoBuilder setDoEnforceUniqueSubjectDNSerialnumber(
        final boolean aDoEnforceUniqueSubjectDNSerialnumber) {
<span class="nc" id="L1342">      this.doEnforceUniqueSubjectDNSerialnumber =</span>
          aDoEnforceUniqueSubjectDNSerialnumber;
<span class="nc" id="L1344">      return this;</span>
    }

    /**
     * @param aUseCertReqHistory boolean
     * @return builder
     */
    public X509CAInfoBuilder setUseCertReqHistory(
            final boolean aUseCertReqHistory) {
<span class="nc" id="L1353">      this.useCertReqHistory = aUseCertReqHistory;</span>
<span class="nc" id="L1354">      return this;</span>
    }

    /**
     * @param aUseUserStorage boolean
     * @return builder
     */
    public X509CAInfoBuilder setUseUserStorage(final boolean aUseUserStorage) {
<span class="nc" id="L1362">      this.useUserStorage = aUseUserStorage;</span>
<span class="nc" id="L1363">      return this;</span>
    }

    /**
     * @param aUseCertificateStorage boolean
     * @return builder
     */
    public X509CAInfoBuilder setUseCertificateStorage(
        final boolean aUseCertificateStorage) {
<span class="nc" id="L1372">      this.useCertificateStorage = aUseCertificateStorage;</span>
<span class="nc" id="L1373">      return this;</span>
    }

    /**
     * @param aAcceptRevocationNonExistingEntry boolean
     * @return Builder
     */
    public X509CAInfoBuilder setAcceptRevocationNonExistingEntry(
        final boolean aAcceptRevocationNonExistingEntry) {
<span class="nc" id="L1382">      this.acceptRevocationNonExistingEntry = aAcceptRevocationNonExistingEntry;</span>
<span class="nc" id="L1383">      return this;</span>
    }

    /**
     * @param caCmpRaAuthSecret Secret
     * @return Builder
     */
    public X509CAInfoBuilder setCmpRaAuthSecret(
            final String caCmpRaAuthSecret) {
<span class="nc" id="L1392">      this.cmpRaAuthSecret = caCmpRaAuthSecret;</span>
<span class="nc" id="L1393">      return this;</span>
    }

    /**
     * @param aKeepExpiredCertsOnCRL Boolean
     * @return Builder
     */
    public X509CAInfoBuilder setKeepExpiredCertsOnCRL(
        final boolean aKeepExpiredCertsOnCRL) {
<span class="nc" id="L1402">      this.keepExpiredCertsOnCRL = aKeepExpiredCertsOnCRL;</span>
<span class="nc" id="L1403">      return this;</span>
    }
    /**
     * @param aCaSerialNumberOctetSize SN size
     * @return Builder
     */
    public X509CAInfoBuilder setCaSerialNumberOctetSize(
        final int aCaSerialNumberOctetSize) {
<span class="nc" id="L1411">      this.caSerialNumberOctetSize = aCaSerialNumberOctetSize;</span>
<span class="nc" id="L1412">      return this;</span>
    }

    /** Build.
     * @return X509CAInfo
     *  */
    public X509CAInfo build() {
<span class="nc" id="L1419">      return new X509CAInfo(</span>
          subjectDn,
          name,
          status,
          updateTime,
          subjectAltName,
          certificateProfileId,
          defaultCertProfileId,
          useNoConflictCertificateData,
          encodedValidity,
          expireTime,
          caType,
          signedBy,
          certificateChain,
          caToken,
          description,
          caSerialNumberOctetSize,
          revocationReason,
          revocationDate,
          policies,
          crlPeriod,
          crlIssueInterval,
          crlOverlapTime,
          deltaCrlPeriod,
          crlPublishers,
          validators,
          useAuthorityKeyIdentifier,
          authorityKeyIdentifierCritical,
          useCrlNumber,
          crlNumberCritical,
          defaultCrlDistPoint,
          defaultCrlIssuer,
          defaultOcspCerviceLocator,
          authorityInformationAccess,
          certificateAiaDefaultCaIssuerUri,
          nameConstraintsPermitted,
          nameConstraintsExcluded,
          caDefinedFreshestCrl,
          finishUser,
          extendedCaServiceInfos,
          useUtf8PolicyText,
          approvals,
          usePrintableStringSubjectDN,
          useLdapDnOrder,
          useCrlDistributionPointOnCrl,
          crlDistributionPointOnCrlCritical,
          includeInHealthCheck,
          doEnforceUniquePublicKeys,
          doEnforceUniqueDistinguishedName,
          doEnforceUniqueSubjectDNSerialnumber,
          useCertReqHistory,
          useUserStorage,
          useCertificateStorage,
          acceptRevocationNonExistingEntry,
          cmpRaAuthSecret,
          keepExpiredCertsOnCRL);
    }
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>