<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HardTokenProfile.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ejbca-common</a> &gt; <a href="index.source.html" class="el_package">org.ejbca.core.model.hardtoken.profiles</a> &gt; <span class="el_source">HardTokenProfile.java</span></div><h1>HardTokenProfile.java</h1><pre class="source lang-java linenums">/*************************************************************************
 *                                                                       *
 *  EJBCA Community: The OpenSource Certificate Authority                *
 *                                                                       *
 *  This software is free software; you can redistribute it and/or       *
 *  modify it under the terms of the GNU Lesser General Public           *
 *  License as published by the Free Software Foundation; either         *
 *  version 2.1 of the License, or any later version.                    *
 *                                                                       *
 *  See terms of license at gnu.org.                                     *
 *                                                                       *
 *************************************************************************/
 
package org.ejbca.core.model.hardtoken.profiles;

import java.io.Serializable;
import java.util.List;

import org.cesecore.internal.UpgradeableDataHashMap;


/**
 * HardTokenProfile is a basic class that should be inherited by all types
 * of hardtokenprofiles in the system.
 * 
 * It used to customize the information generated on hard tokens when they are 
 * processed. This information could be PIN-type number of certificates, 
 * certificate profiles and so on. 
 *
 * @version $Id: HardTokenProfile.java 22117 2015-10-29 10:53:42Z mikekushner $
 */
public abstract class HardTokenProfile extends UpgradeableDataHashMap implements Serializable, Cloneable {
    // Default Values
    

    private static final long serialVersionUID = -7779053482914995083L;
    public static final String TRUE  = &quot;true&quot;;
    public static final String FALSE = &quot;false&quot;;

    public static final int PINTYPE_ASCII_NUMERIC           = 1;   
    public static final int PINTYPE_UTF8                    = 2;    
    public static final int PINTYPE_ISO9564_1               = 4;    

    // Protected Constants.
	public static final String TYPE                           = &quot;type&quot;;
	
    protected static final String NUMBEROFCOPIES                 = &quot;numberofcopies&quot;;
    protected static final String EREASABLETOKEN                 = &quot;ereasabletoken&quot;;
	protected static final String HARDTOKENPREFIX                = &quot;hardtokenprefix&quot;;
	protected static final String PINTYPE                        = &quot;pintype&quot;;
	protected static final String MINIMUMPINLENGTH               = &quot;minimumpinlength&quot;;
	protected static final String GENERATEIDENTICALPINFORCOPIES  = &quot;generateidenticalpinforcopies&quot;;	
    // Public Methods

    /**
     * Creates a new instance of CertificateProfile
     */
<span class="nc" id="L58">    public HardTokenProfile() {</span>
<span class="nc" id="L59">      setNumberOfCopies(1);	 </span>
<span class="nc" id="L60">      setEreasableToken(true);     </span>
<span class="nc" id="L61">      setHardTokenSNPrefix(&quot;000000&quot;);    </span>
<span class="nc" id="L62">      setGenerateIdenticalPINForCopies(true);  </span>
<span class="nc" id="L63">    }</span>

    // Public Methods
    /**
     * Number of Copies indicates how many card for the samt user that should be generated.
     * Generally this means, the PIN and PUK codes and encryption keys are identical. This
     * doesn't mean that the toekns are exact copies. 
     * @return ont
     */
<span class="nc" id="L72">    public int getNumberOfCopies(){return ((Integer)data.get(NUMBEROFCOPIES)).intValue();}</span>

	/**
	 * Indicates if the same pin code should be used for all copies of the token or if a
	 * new one should be generated. 
	 * @return bool
	 */

<span class="nc" id="L80">	public boolean getGenerateIdenticalPINForCopies(){return ((Boolean) data.get(GENERATEIDENTICALPINFORCOPIES)).booleanValue();}</span>

    /**
     * Indicaties if the generaded token should be ereasable or not,
     * 
     * @return true if the card should be ereasable
     */
<span class="nc" id="L87">    public boolean getEreasableToken(){ return ((Boolean)data.get(EREASABLETOKEN)).booleanValue(); }</span>
    
    /**
     * Returns the hardtoken serialnumber prefix that is intended to identify the organization
     * issuing the cards.
     * 
     * @return the serial number prefix.
     */
    
<span class="nc" id="L96">    public String getHardTokenSNPrefix(){ return (String) data.get(HARDTOKENPREFIX); }</span>
    


	/**
	 * Given a token identification string the method determines if the token
	 * supports the structure of this profile.
	 * @param tokenidentificationstring String
	 * 
	 * @return true if it's possible to create a token accoringly to the profile.
	 */
    public abstract boolean isTokenSupported(String tokenidentificationstring);
    // Public Methods mostly used by EJBCA  

<span class="nc" id="L110">	public void setNumberOfCopies(int numberofcopies) { data.put(NUMBEROFCOPIES,Integer.valueOf(numberofcopies));}</span>

<span class="nc" id="L112">	public void setEreasableToken(boolean ereasabletoken) {data.put(EREASABLETOKEN, Boolean.valueOf(ereasabletoken));}</span>
	
<span class="nc" id="L114">	public void setHardTokenSNPrefix(String hardtokensnprefix){ data.put(HARDTOKENPREFIX,hardtokensnprefix); }</span>
	
<span class="nc" id="L116">	public void setGenerateIdenticalPINForCopies(boolean generate){ data.put(GENERATEIDENTICALPINFORCOPIES, Boolean.valueOf(generate));}</span>
	
	/**
	 * Retrieves what type of pin code that should be generated for
	 * tokens with this profile.
	 * 
	 * @param certusage the should be one of the CERTUSAGE_ constants.
	 * @return a pintype with a value of one of the PINTYPE_ constants 
	 */
	public int getPINType(int certusage){
<span class="nc" id="L126">	  return ((Integer) ((List&lt;?&gt;) data.get(PINTYPE)).get(certusage)).intValue();	</span>
	}
	
	@SuppressWarnings(&quot;unchecked&quot;)
    public  void setPINType(int certusage, int pintype){
<span class="nc" id="L131">		((List&lt;Integer&gt;) data.get(PINTYPE)).set(certusage, Integer.valueOf(pintype));		</span>
<span class="nc" id="L132">	}</span>
	
	/**
	 * Retrieves the minimum pin length that should be generated for
	 * tokens with this profile.
	 * 
	 * @param certusage the should be one of the CERTUSAGE_ constants.
	 * @return a length of chars between 0 - 8. 
	 */
	public int getMinimumPINLength(int certusage){
<span class="nc" id="L142">	  return ((Integer) ((List&lt;?&gt;) data.get(MINIMUMPINLENGTH)).get(certusage)).intValue();	</span>
	}
	
	@SuppressWarnings(&quot;unchecked&quot;)
    public  void setMinimumPINLength(int certusage, int length){
<span class="nc" id="L147">		((List&lt;Integer&gt;) data.get(MINIMUMPINLENGTH)).set(certusage, Integer.valueOf(length));		</span>
<span class="nc" id="L148">	}</span>

    @Override
    public abstract Object clone() throws CloneNotSupportedException;
    
    @Override
    public abstract float getLatestVersion();
    
    @Override
    public void upgrade(){
    	// Performing upgrade rutines
<span class="nc" id="L159">    }</span>
    
	// Protected methods
	protected boolean isTokenSupported(String[] supportedtokens, String tokenidentificationstring){
<span class="nc" id="L163">	  boolean returnval = false;</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">	  for(int i=0; i&lt;supportedtokens.length; i++){</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">	  	if(supportedtokens[i].equals(tokenidentificationstring)) {</span>
<span class="nc" id="L166">	  	  returnval=true;</span>
	  	}
	  }
	  
<span class="nc" id="L170">	  return returnval;	</span>
	}
	


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>