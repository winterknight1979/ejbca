<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.8) on Wed Sep 30 22:45:58 UTC 2020 -->
<title>SignSession (EJB-CA 1.0.0-SNAPSHOT API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2020-09-30">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="SignSession (EJB-CA 1.0.0-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6,"i10":6,"i11":6,"i12":6,"i13":6,"i14":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/SignSession.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.ejbca.core.ejb.ca.sign</a></div>
<h2 title="Interface SignSession" class="title">Interface SignSession</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Subinterfaces:</dt>
<dd><code><a href="SignSessionLocal.html" title="interface in org.ejbca.core.ejb.ca.sign">SignSessionLocal</a></code>, <code><a href="SignSessionRemote.html" title="interface in org.ejbca.core.ejb.ca.sign">SignSessionRemote</a></code></dd>
</dl>
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="SignSessionBean.html" title="class in org.ejbca.core.ejb.ca.sign">SignSessionBean</a></code></dd>
</dl>
<hr>
<pre>public interface <span class="typeNameLabel">SignSession</span></pre>
<dl>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>$Id: SignSession.java 32628 2019-06-27 09:17:20Z mikekushner $</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="../../../../../cesecore/certificates/certificate/CertificateWrapper.html" title="interface in org.cesecore.certificates.certificate">CertificateWrapper</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createCardVerifiableCertificateWS(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,java.lang.String)">createCardVerifiableCertificateWS</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;authenticationToken,
                                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cvcreq)</code></th>
<td class="colLast">
<div class="block">Generates a CV certificate for a user.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,java.security.cert.Certificate)">createCertificate</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a>&nbsp;incert)</code></th>
<td class="colLast">
<div class="block">Requests for a certificate to be created for the passed public key wrapped in a self-signed
 certificate.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,org.cesecore.keys.util.PublicKeyWrapper)">createCertificate</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                 <a href="../../../../../cesecore/keys/util/PublicKeyWrapper.html" title="class in org.cesecore.keys.util">PublicKeyWrapper</a>&nbsp;pk)</code></th>
<td class="colLast">
<div class="block">Requests for a certificate to be created for the passed public key with default key usage
 The method queries the user database for authorization of the user.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,org.cesecore.keys.util.PublicKeyWrapper,int,java.util.Date,java.util.Date)">createCertificate</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                 <a href="../../../../../cesecore/keys/util/PublicKeyWrapper.html" title="class in org.cesecore.keys.util">PublicKeyWrapper</a>&nbsp;pk,
                 int&nbsp;keyusage,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Date.html?is-external=true" title="class or interface in java.util" class="externalLink">Date</a>&nbsp;notBefore,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Date.html?is-external=true" title="class or interface in java.util" class="externalLink">Date</a>&nbsp;notAfter)</code></th>
<td class="colLast">
<div class="block">Requests for a certificate to be created for the passed public key with the passed key
 usage.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,org.cesecore.keys.util.PublicKeyWrapper,int,java.util.Date,java.util.Date,int,int)">createCertificate</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                 <a href="../../../../../cesecore/keys/util/PublicKeyWrapper.html" title="class in org.cesecore.keys.util">PublicKeyWrapper</a>&nbsp;pk,
                 int&nbsp;keyusage,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Date.html?is-external=true" title="class or interface in java.util" class="externalLink">Date</a>&nbsp;notBefore,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Date.html?is-external=true" title="class or interface in java.util" class="externalLink">Date</a>&nbsp;notAfter,
                 int&nbsp;certificateprofileid,
                 int&nbsp;caid)</code></th>
<td class="colLast">
<div class="block">Requests for a certificate to be created for the passed public key with the passed key
 usage and using the given certificate profile.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code><a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,org.cesecore.certificates.certificate.request.RequestMessage,java.lang.Class,org.cesecore.certificates.endentity.EndEntityInformation)">createCertificate</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                 <a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a>&nbsp;req,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Class.html?is-external=true" title="class or interface in java.lang" class="externalLink">Class</a>&lt;? extends <a href="../../../../../cesecore/certificates/certificate/request/CertificateResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">CertificateResponseMessage</a>&gt;&nbsp;responseClass,
                 <a href="../../../../../cesecore/certificates/endentity/EndEntityInformation.html" title="class in org.cesecore.certificates.endentity">EndEntityInformation</a>&nbsp;suppliedUserData)</code></th>
<td class="colLast">
<div class="block">Requests for a certificate to be created for the passed public key wrapped in a
 certification request message (ex PKCS10).</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createCertificateWS(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,java.lang.String,int,java.lang.String,java.lang.String)">createCertificateWS</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;authenticationToken,
                   <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                   <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                   <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;req,
                   int&nbsp;reqType,
                   <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;hardTokenSN,
                   <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;responseType)</code></th>
<td class="colLast">
<div class="block">Creates a certificate for the user with the given name.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createPKCS7(org.cesecore.authentication.tokens.AuthenticationToken,int,boolean)">createPKCS7</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
           int&nbsp;caId,
           boolean&nbsp;includeChain)</code></th>
<td class="colLast">
<div class="block">Creates a signed PKCS7 message containing the whole certificate chain of the specified CA.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createPKCS7(org.cesecore.authentication.tokens.AuthenticationToken,java.security.cert.X509Certificate,boolean)">createPKCS7</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/X509Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">X509Certificate</a>&nbsp;cert,
           boolean&nbsp;includeChain)</code></th>
<td class="colLast">
<div class="block">Creates a signed PKCS7 message containing the whole certificate chain, including the
 provided client certificate.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createPKCS7Rollover(org.cesecore.authentication.tokens.AuthenticationToken,int)">createPKCS7Rollover</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                   int&nbsp;caId)</code></th>
<td class="colLast">
<div class="block">Creates a roll over PKCS7 for the next CA certificate, signed by the current CA key.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code><a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createRequestFailedResponse(org.cesecore.authentication.tokens.AuthenticationToken,org.cesecore.certificates.certificate.request.RequestMessage,java.lang.Class,org.cesecore.certificates.certificate.request.FailInfo,java.lang.String)">createRequestFailedResponse</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                           <a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a>&nbsp;req,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Class.html?is-external=true" title="class or interface in java.lang" class="externalLink">Class</a>&lt;? extends <a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a>&gt;&nbsp;responseClass,
                           <a href="../../../../../cesecore/certificates/certificate/request/FailInfo.html" title="class in org.cesecore.certificates.certificate.request">FailInfo</a>&nbsp;failInfo,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;failText)</code></th>
<td class="colLast">
<div class="block">Method that generates a request failed response message.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code><a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#decryptAndVerifyRequest(org.cesecore.authentication.tokens.AuthenticationToken,org.cesecore.certificates.certificate.request.RequestMessage)">decryptAndVerifyRequest</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                       <a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a>&nbsp;req)</code></th>
<td class="colLast">
<div class="block">Method that just decrypts and verifies a request and should be used in those cases
 a when encrypted information needs to be extracted and presented to an RA for approval.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code><a href="../../../../../cesecore/certificates/ca/CertificateGenerationParams.html" title="class in org.cesecore.certificates.ca">CertificateGenerationParams</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#fetchCertGenParams()">fetchCertGenParams</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns an object with configuration parameters for extensions (currently only for the CT extension).</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCertificateChain(int)">getCertificateChain</a></span>&#8203;(int&nbsp;caid)</code></th>
<td class="colLast">
<div class="block">Retrieves the certificate chain for the signer.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code><a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCRL(org.cesecore.authentication.tokens.AuthenticationToken,org.cesecore.certificates.certificate.request.RequestMessage,java.lang.Class)">getCRL</a></span>&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
      <a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a>&nbsp;req,
      <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Class.html?is-external=true" title="class or interface in java.lang" class="externalLink">Class</a>&lt;? extends <a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a>&gt;&nbsp;responseClass)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="getCertificateChain(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCertificateChain</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a>&gt;&nbsp;getCertificateChain&#8203;(int&nbsp;caid)</pre>
<div class="block">Retrieves the certificate chain for the signer. The returned certificate chain MUST have the
 RootCA certificate in the last position.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>caid</code> - is the issuerdn.hashCode()</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Collection of Certificate, the certificate chain, never null.</dd>
</dl>
</li>
</ul>
<a id="createPKCS7(org.cesecore.authentication.tokens.AuthenticationToken,java.security.cert.X509Certificate,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createPKCS7</h4>
<pre class="methodSignature">byte[]&nbsp;createPKCS7&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                   <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/X509Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">X509Certificate</a>&nbsp;cert,
                   boolean&nbsp;includeChain)
            throws <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                   <a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a>,
                   <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></pre>
<div class="block">Creates a signed PKCS7 message containing the whole certificate chain, including the
 provided client certificate.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>cert</code> - client certificate which we want encapsulated in a PKCS7 together with
              certificate chain.</dd>
<dd><code>includeChain</code> - chain</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The DER-encoded PKCS7 message.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the CA does not exist or is expired, or has an invalid cert</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a></code> - if the certificate is not signed by the CA</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - fail</dd>
</dl>
</li>
</ul>
<a id="createPKCS7(org.cesecore.authentication.tokens.AuthenticationToken,int,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createPKCS7</h4>
<pre class="methodSignature">byte[]&nbsp;createPKCS7&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                   int&nbsp;caId,
                   boolean&nbsp;includeChain)
            throws <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                   <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></pre>
<div class="block">Creates a signed PKCS7 message containing the whole certificate chain of the specified CA.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>caId</code> - CA for which we want a PKCS7 certificate chain.</dd>
<dd><code>includeChain</code> - chain</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The DER-encoded PKCS7 message.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the CA does not exist or is expired, or has an invalid cert</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - fail</dd>
</dl>
</li>
</ul>
<a id="createPKCS7Rollover(org.cesecore.authentication.tokens.AuthenticationToken,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createPKCS7Rollover</h4>
<pre class="methodSignature">byte[]&nbsp;createPKCS7Rollover&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                           int&nbsp;caId)
                    throws <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                           <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></pre>
<div class="block">Creates a roll over PKCS7 for the next CA certificate, signed by the current CA key. Used by ScepServlet.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - admin</dd>
<dd><code>caId</code> - CA</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A DER-encoded PKCS7 message, or null if there's no next CA certificate.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - fail</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - fail</dd>
</dl>
</li>
</ul>
<a id="createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,org.cesecore.keys.util.PublicKeyWrapper,int,java.util.Date,java.util.Date)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createCertificate</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a>&nbsp;createCertificate&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                              <a href="../../../../../cesecore/keys/util/PublicKeyWrapper.html" title="class in org.cesecore.keys.util">PublicKeyWrapper</a>&nbsp;pk,
                              int&nbsp;keyusage,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Date.html?is-external=true" title="class or interface in java.util" class="externalLink">Date</a>&nbsp;notBefore,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Date.html?is-external=true" title="class or interface in java.util" class="externalLink">Date</a>&nbsp;notAfter)
                       throws <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                              <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a>,
                              <a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a>,
                              <a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a>,
                              <a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a>,
                              <a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a>,
                              <a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a>,
                              <a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a>,
                              <a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a>,
                              <a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a></pre>
<div class="block">Requests for a certificate to be created for the passed public key with the passed key
 usage. The method queries the user database for authorization of the user. CAs are only
 allowed to have certificateSign and CRLSign set.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>username</code> - unique username within the instance.</dd>
<dd><code>password</code> - password for the user.</dd>
<dd><code>pk</code> - the public key to be put in the created certificate.</dd>
<dd><code>keyusage</code> - integer with bit mask describing desired keys usage, overrides keyUsage from
                 CertificateProfiles if allowed. Bit mask is packed in in integer using constants
                 from CertificateData. -1 means use default keyUsage from CertificateProfile. ex. int
                 keyusage = CertificateData.digitalSignature | CertificateData.nonRepudiation; gives
                 digitalSignature and nonRepudiation. ex. int keyusage = CertificateData.keyCertSign
                 | CertificateData.cRLSign; gives keyCertSign and cRLSign</dd>
<dd><code>notBefore</code> - An optional validity to set in the created certificate, if the profile allows validity override, null if the profile's default validity should be used</dd>
<dd><code>notAfter</code> - An optional validity to set in the created certificate, if the profile allows validity override, null if the profile's default validity should be used</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The newly created certificate or null.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a></code> - if the user does not exist.</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - (rollback) if admin is not authorized to issue this certificate</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the CA defined by caId doesn't exist.</dd>
<dd><code><a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a></code> - If the users status is incorrect.</dd>
<dd><code><a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a></code> - If the password is incorrect.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a></code> - if the signing algorithm in the certificate profile (or the CA Token if not found) was invalid.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a></code> - if the CA was offline</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a></code> - if the validity defined by notBefore and notAfter was invalid</dd>
<dd><code><a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a></code> - if the crypto token for the CA wasn't found</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a></code> - if certificate with same subject DN or key already exists for a user, if these limitations are enabled in CA.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a></code> - (rollback) if certificate was meant to be issued revoked, but could not.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a></code> - if the certificate request contained an illegal name</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a></code> - (rollback) if certificate couldn't be created.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a></code> - if the public key didn't conform to the constrains of the CA's certificate profile.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a></code> - (no rollback) if custom serial number is registered for user, but it is not allowed to be used (either
             missing unique index in database, or certificate profile does not allow it</dd>
</dl>
</li>
</ul>
<a id="createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,org.cesecore.keys.util.PublicKeyWrapper)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createCertificate</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a>&nbsp;createCertificate&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                              <a href="../../../../../cesecore/keys/util/PublicKeyWrapper.html" title="class in org.cesecore.keys.util">PublicKeyWrapper</a>&nbsp;pk)
                       throws <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                              <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a>,
                              <a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a>,
                              <a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a>,
                              <a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a>,
                              <a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a>,
                              <a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a>,
                              <a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a>,
                              <a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a>,
                              <a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a></pre>
<div class="block">Requests for a certificate to be created for the passed public key with default key usage
 The method queries the user database for authorization of the user.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>username</code> - unique username within the instance.</dd>
<dd><code>password</code> - password for the user.</dd>
<dd><code>pk</code> - the public key to be put in the created certificate.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The newly created certificate or null.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - (rollback) if admin is not authorized to issue this certificate</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the CA defined by caId doesn't exist.</dd>
<dd><code><a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a></code> - If the end entity's status is incorrect.</dd>
<dd><code><a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a></code> - If the password is incorrect.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a></code> - if the signing algorithm in the certificate profile (or the CA Token if not found) was invalid.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a></code> - if the CA was offline</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a></code> - if the validity defined by notBefore and notAfter was invalid</dd>
<dd><code><a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a></code> - if the crypto token for the CA wasn't found</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a></code> - if certificate with same subject DN or key already exists for a user, if these limitations are enabled in CA.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a></code> - (rollback) if certificate was meant to be issued revoked, but could not.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a></code> - if the certificate request contained an illegal name</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a></code> - (rollback) if certificate couldn't be created.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a></code> - if the public key didn't conform to the constrains of the CA's certificate profile.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a></code> - (no rollback) if custom serial number is registered for user, but it is not allowed to be used (either
             missing unique index in database, or certificate profile does not allow it</dd>
<dd><code><a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a></code> - if the end entity was not found</dd>
</dl>
</li>
</ul>
<a id="createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,java.security.cert.Certificate)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createCertificate</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a>&nbsp;createCertificate&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a>&nbsp;incert)
                       throws <a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a>,
                              <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a>,
                              <a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a>,
                              <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                              <a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a>,
                              <a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a>,
                              <a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a>,
                              <a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a>,
                              <a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a>,
                              <a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a>,
                              <a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a></pre>
<div class="block">Requests for a certificate to be created for the passed public key wrapped in a self-signed
 certificate. Verification of the signature (proof-of-possession) on the request is
 performed, and an exception thrown if verification fails. The method queries the user
 database for authorization of the user.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>username</code> - unique username within the instance.</dd>
<dd><code>password</code> - password for the user.</dd>
<dd><code>incert</code> - a certificate containing the public key to be put in the created certificate.
                 Other (requested) parameters in the passed certificate can be used, such as DN,
                 Validity, KeyUsage etc. Currently only KeyUsage is considered!</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The newly created certificate or null.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a></code> - if the user does not exist.</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - (rollback) if admin is not authorized to issue this certificate</dd>
<dd><code><a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a></code> - If the users status is incorrect.</dd>
<dd><code><a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a></code> - If the password is incorrect.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a></code> - if the public key didn't conform to the constrains of the CA's certificate profile.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a></code> - if the provided client certificate was not signed</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a></code> - (no rollback) if custom serial number is registered for user, but it is not allowed to be used (either
             missing unique index in database, or certificate profile does not allow it     * @throws InvalidAlgorithmException if the signing algorithm in the certificate profile (or the CA Token if not found) was invalid.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a></code> - if the CA was offline</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a></code> - if the validity defined by notBefore and notAfter was invalid</dd>
<dd><code><a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a></code> - if the crypto token for the CA wasn't found</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a></code> - if certificate with same subject DN or key already exists for a user, if these limitations are enabled in CA.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a></code> - (rollback) if certificate was meant to be issued revoked, but could not.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a></code> - if the certificate request contained an illegal name</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a></code> - (rollback) if certificate couldn't be created.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the CA defined by caId doesn't exist.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a></code> - fail</dd>
</dl>
</li>
</ul>
<a id="createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,org.cesecore.certificates.certificate.request.RequestMessage,java.lang.Class,org.cesecore.certificates.endentity.EndEntityInformation)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createCertificate</h4>
<pre class="methodSignature"><a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a>&nbsp;createCertificate&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                                  <a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a>&nbsp;req,
                                  <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Class.html?is-external=true" title="class or interface in java.lang" class="externalLink">Class</a>&lt;? extends <a href="../../../../../cesecore/certificates/certificate/request/CertificateResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">CertificateResponseMessage</a>&gt;&nbsp;responseClass,
                                  <a href="../../../../../cesecore/certificates/endentity/EndEntityInformation.html" title="class in org.cesecore.certificates.endentity">EndEntityInformation</a>&nbsp;suppliedUserData)
                           throws <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a>,
                                  <a href="../../../../../cesecore/certificates/certificate/certextensions/CertificateExtensionException.html" title="class in org.cesecore.certificates.certificate.certextensions">CertificateExtensionException</a>,
                                  <a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a>,
                                  <a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a>,
                                  <a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a>,
                                  <a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a>,
                                  <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                                  <a href="../../../../../cesecore/certificates/ca/SignRequestException.html" title="class in org.cesecore.certificates.ca">SignRequestException</a>,
                                  <a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a>,
                                  <a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a>,
                                  <a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a>,
                                  <a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a>,
                                  <a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a>,
                                  <a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a>,
                                  <a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a>,
                                  <a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a>,
                                  <a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a>,
                                  <a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a></pre>
<div class="block">Requests for a certificate to be created for the passed public key wrapped in a
 certification request message (ex PKCS10).  The username and password used to authorize is
 taken from the request message. Verification of the signature (proof-of-possesion) on the
 request is performed, and an exception thrown if verification fails. The method queries the
 user database for authorization of the user.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>req</code> - a Certification Request message, containing the public key to be put in the
                      created certificate. Currently no additional parameters in requests are considered!</dd>
<dd><code>responseClass</code> - The implementation class that will be used as the response message.</dd>
<dd><code>suppliedUserData</code> - Optional (can be null) supplied user data, if we are running without storing UserData this will be used. Should only
  be supplied when we issue certificates in a single transaction.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The newly created response or null.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../cesecore/certificates/certificate/certextensions/CertificateExtensionException.html" title="class in org.cesecore.certificates.certificate.certextensions">CertificateExtensionException</a></code> - if there was an error with the extensions specified in the request message</dd>
<dd><code><a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a></code> - if the user does not exist.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a></code> - (no rollback) if custom serial number is registered for user, but it is not allowed to be used (either
             missing unique index in database, or certificate profile does not allow it</dd>
<dd><code><a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a></code> - if the CA's crypto token was offline</dd>
<dd><code><a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a></code> - if the end entity's status is not on in which it may generate a certificate</dd>
<dd><code><a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a></code> - if the provided password is not the same as in the database</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a></code> - if the public key didn't conform to the constrains of the CA's certificate profile.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the targeted CA does not exist</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/SignRequestException.html" title="class in org.cesecore.certificates.ca">SignRequestException</a></code> - if the provided request doesn't contain a username or a password.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a></code> - if the request was not correctly signed</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a></code> - if the signing algorithm in the certificate profile (or the CA Token if not found) was invalid.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a></code> - if the CA was offline</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a></code> - if the validity defined in the request was invalid</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a></code> - if certificate with same subject DN or key already exists for a user, if these limitations are enabled in CA.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a></code> - (rollback) if the certificate was meant to be issued revoked, but could not.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a></code> - (rollback) if the certificate couldn't be created for any various reason</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a></code> - if the subject DN or SAN specified in the certificate request contains illegal characters</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - if the authentication token wasn't authorized to the CA defined in the request</dd>
</dl>
</li>
</ul>
<a id="createCertificate(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,org.cesecore.keys.util.PublicKeyWrapper,int,java.util.Date,java.util.Date,int,int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createCertificate</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">Certificate</a>&nbsp;createCertificate&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                              <a href="../../../../../cesecore/keys/util/PublicKeyWrapper.html" title="class in org.cesecore.keys.util">PublicKeyWrapper</a>&nbsp;pk,
                              int&nbsp;keyusage,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Date.html?is-external=true" title="class or interface in java.util" class="externalLink">Date</a>&nbsp;notBefore,
                              <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Date.html?is-external=true" title="class or interface in java.util" class="externalLink">Date</a>&nbsp;notAfter,
                              int&nbsp;certificateprofileid,
                              int&nbsp;caid)
                       throws <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                              <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a>,
                              <a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a>,
                              <a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a>,
                              <a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a>,
                              <a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a>,
                              <a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a>,
                              <a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a>,
                              <a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a>,
                              <a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a>,
                              <a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a></pre>
<div class="block">Requests for a certificate to be created for the passed public key with the passed key
 usage and using the given certificate profile. This method is primarily intended to be used when
 issuing hardtokens having multiple certificates per user.
 The method queries the user database for authorization of the user. CAs are only
 allowed to have certificateSign and CRLSign set.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>username</code> - unique username within the instance.</dd>
<dd><code>password</code> - password for the user.</dd>
<dd><code>pk</code> - the public key to be put in the created certificate.</dd>
<dd><code>keyusage</code> - integer with bit mask describing desired keys usage, overrides keyUsage from
                             CertificateProfiles if allowed. Bit mask is packed in in integer using constants
                             from org.bouncycastle.jce.X509KeyUsage. -1 means use default keyUsage from CertificateProfile. ex. int
                             keyusage = X509KeyUsage.digitalSignature | X509KeyUsage.nonRepudiation; gives
                             digitalSignature and nonRepudiation. ex. int keyusage = X509KeyUsage.keyCertSign
                             | X509KeyUsage.cRLSign; gives keyCertSign and cRLSign</dd>
<dd><code>notBefore</code> - an optional validity to set in the created certificate, if the profile allows validity override, null if the profiles default validity should be used.</dd>
<dd><code>notAfter</code> - an optional validity to set in the created certificate, if the profile allows validity override, null if the profiles default validity should be used.</dd>
<dd><code>certificateprofileid</code> - used to override the one set in userdata.
                             Should be set to CertificateProfileConstants.CERTPROFILE_NO_PROFILE if the usedata certificateprofileid should be used</dd>
<dd><code>caid</code> - used to override the one set in userdata.
                             Should be set to SecConst.CAID_USEUSERDEFINED if the regular certificateprofileid should be used</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The newly created certificate or null.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../ra/NoSuchEndEntityException.html" title="class in org.ejbca.core.ejb.ra">NoSuchEndEntityException</a></code> - if the user does not exist.</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - (rollback) if admin is not authorized to issue this certificate</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the CA defined by caId doesn't exist.</dd>
<dd><code><a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a></code> - If the users status is incorrect.</dd>
<dd><code><a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a></code> - If the password is incorrect.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/InvalidAlgorithmException.html" title="class in org.cesecore.certificates.ca">InvalidAlgorithmException</a></code> - if the signing algorithm in the certificate profile (or the CA Token if not found) was invalid.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CAOfflineException.html" title="class in org.cesecore.certificates.ca">CAOfflineException</a></code> - if the CA was offline</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalValidityException.html" title="class in org.cesecore.certificates.ca">IllegalValidityException</a></code> - if the validity defined by notBefore and notAfter was invalid</dd>
<dd><code><a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a></code> - if the crypto token for the CA wasn't found</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CertificateSerialNumberException</a></code> - if certificate with same subject DN or key already exists for a user, if these limitations are enabled in CA.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateRevokeException.html" title="class in org.cesecore.certificates.certificate">CertificateRevokeException</a></code> - (rollback) if certificate was meant to be issued revoked, but could not.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/IllegalNameException.html" title="class in org.cesecore.certificates.ca">IllegalNameException</a></code> - if the certificate request contained an illegal name</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/CertificateCreateException.html" title="class in org.cesecore.certificates.certificate">CertificateCreateException</a></code> - (rollback) if certificate couldn't be created.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a></code> - if the public key didn't conform to the constrains of the CA's certificate profile.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/exception/CustomCertificateSerialNumberException.html" title="class in org.cesecore.certificates.certificate.exception">CustomCertificateSerialNumberException</a></code> - (no rollback) if custom serial number is registered for user, but it is not allowed to be used (either
             missing unique index in database, or certificate profile does not allow it</dd>
</dl>
</li>
</ul>
<a id="createCardVerifiableCertificateWS(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createCardVerifiableCertificateWS</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Collection.html?is-external=true" title="class or interface in java.util" class="externalLink">Collection</a>&lt;<a href="../../../../../cesecore/certificates/certificate/CertificateWrapper.html" title="interface in org.cesecore.certificates.certificate">CertificateWrapper</a>&gt;&nbsp;createCardVerifiableCertificateWS&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;authenticationToken,
                                                                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                                                                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                                                                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;cvcreq)
                                                          throws <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a>,
                                                                 <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                                                                 <a href="../../../model/ra/raadmin/UserDoesntFullfillEndEntityProfile.html" title="class in org.ejbca.core.model.ra.raadmin">UserDoesntFullfillEndEntityProfile</a>,
                                                                 <a href="../../../model/ra/NotFoundException.html" title="class in org.ejbca.core.model.ra">NotFoundException</a>,
                                                                 <a href="../../../model/approval/ApprovalException.html" title="class in org.ejbca.core.model.approval">ApprovalException</a>,
                                                                 <a href="../../../EjbcaException.html" title="class in org.ejbca.core">EjbcaException</a>,
                                                                 <a href="../../../model/approval/WaitingForApprovalException.html" title="class in org.ejbca.core.model.approval">WaitingForApprovalException</a>,
                                                                 <a href="../../../../../cesecore/certificates/ca/SignRequestException.html" title="class in org.cesecore.certificates.ca">SignRequestException</a>,
                                                                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/CertificateExpiredException.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">CertificateExpiredException</a>,
                                                                 <a href="../../../../../cesecore/CesecoreException.html" title="class in org.cesecore">CesecoreException</a></pre>
<div class="block">Generates a CV certificate for a user.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>authenticationToken</code> - the administrator performing the action.</dd>
<dd><code>username</code> - the user name of the user requesting the certificate.</dd>
<dd><code>password</code> - the password for initial enrollment, not used for renewal requests that can be authenticated using signatures with keys with valid certificates.</dd>
<dd><code>cvcreq</code> - Base64 encoded CVC request message.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the full certificate chain for the IS, with IS certificate in pos 0, DV in 1, CVCA in 2.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - if administrator is not authorized to edit end entity or if an authenticated request can not be verified.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if a referenced CA does not exist.</dd>
<dd><code><a href="../../../model/ra/raadmin/UserDoesntFullfillEndEntityProfile.html" title="class in org.ejbca.core.model.ra.raadmin">UserDoesntFullfillEndEntityProfile</a></code> - if the request data does not full fill the end entity profile restrictions.</dd>
<dd><code><a href="../../../model/ra/NotFoundException.html" title="class in org.ejbca.core.model.ra">NotFoundException</a></code> - if the user could not be found.</dd>
<dd><code><a href="../../../model/approval/ApprovalException.html" title="class in org.ejbca.core.model.approval">ApprovalException</a></code> - if an approval was denied.</dd>
<dd><code><a href="../../../EjbcaException.html" title="class in org.ejbca.core">EjbcaException</a></code> - any EjbcaException.</dd>
<dd><code><a href="../../../model/approval/WaitingForApprovalException.html" title="class in org.ejbca.core.model.approval">WaitingForApprovalException</a></code> - if there is a pending approval.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/SignRequestException.html" title="class in org.cesecore.certificates.ca">SignRequestException</a></code> - if the provided request is invalid, for example not containing a username or password.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/CertificateExpiredException.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">CertificateExpiredException</a></code> - if the users old certificate has expired.</dd>
<dd><code><a href="../../../../../cesecore/CesecoreException.html" title="class in org.cesecore">CesecoreException</a></code> - any CesecoreException.</dd>
</dl>
</li>
</ul>
<a id="createCertificateWS(org.cesecore.authentication.tokens.AuthenticationToken,java.lang.String,java.lang.String,java.lang.String,int,java.lang.String,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createCertificateWS</h4>
<pre class="methodSignature">byte[]&nbsp;createCertificateWS&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;authenticationToken,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;username,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;password,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;req,
                           int&nbsp;reqType,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;hardTokenSN,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;responseType)
                    throws <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a>,
                           <a href="../../../EjbcaException.html" title="class in org.ejbca.core">EjbcaException</a>,
                           <a href="../../../../../cesecore/CesecoreException.html" title="class in org.cesecore">CesecoreException</a>,
                           <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                           <a href="../../../../../cesecore/certificates/certificate/certextensions/CertificateExtensionException.html" title="class in org.cesecore.certificates.certificate.certextensions">CertificateExtensionException</a>,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/InvalidKeyException.html?is-external=true" title="class or interface in java.security" class="externalLink">InvalidKeyException</a>,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/SignatureException.html?is-external=true" title="class or interface in java.security" class="externalLink">SignatureException</a>,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/spec/InvalidKeySpecException.html?is-external=true" title="class or interface in java.security.spec" class="externalLink">InvalidKeySpecException</a>,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security" class="externalLink">NoSuchAlgorithmException</a>,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/NoSuchProviderException.html?is-external=true" title="class or interface in java.security" class="externalLink">NoSuchProviderException</a>,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/CertificateException.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">CertificateException</a>,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a>,
                           org.ejbca.cvc.exception.ParseException,
                           org.ejbca.cvc.exception.ConstructionException,
                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/NoSuchFieldException.html?is-external=true" title="class or interface in java.lang" class="externalLink">NoSuchFieldException</a>,
                           <a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a>,
                           <a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a></pre>
<div class="block">Creates a certificate for the user with the given name.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>authenticationToken</code> - the administrator performing the action.</dd>
<dd><code>username</code> - the users name.</dd>
<dd><code>password</code> - the users password</dd>
<dd><code>req</code> - the certificate request.</dd>
<dd><code>reqType</code> - the request type.</dd>
<dd><code>hardTokenSN</code> - the hard token SN, if available.</dd>
<dd><code>responseType</code> - the response type.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>DER-encoded certificate as byte array.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - if client isn't authorized to request.</dd>
<dd><code><a href="../../../EjbcaException.html" title="class in org.ejbca.core">EjbcaException</a></code> - any EjbcaException.</dd>
<dd><code><a href="../../../../../cesecore/CesecoreException.html" title="class in org.cesecore">CesecoreException</a></code> - any CesecoreException.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the issuing CA associated with the user does not exist.</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/certextensions/CertificateExtensionException.html" title="class in org.cesecore.certificates.certificate.certextensions">CertificateExtensionException</a></code> - if a certificate extension could not be added to the certificate.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/InvalidKeyException.html?is-external=true" title="class or interface in java.security" class="externalLink">InvalidKeyException</a></code> - if the key is not valid.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/SignatureException.html?is-external=true" title="class or interface in java.security" class="externalLink">SignatureException</a></code> - if a signature does not match (i.e. CSRs POP validation).</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/spec/InvalidKeySpecException.html?is-external=true" title="class or interface in java.security.spec" class="externalLink">InvalidKeySpecException</a></code> - if the key specification is not available.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/NoSuchAlgorithmException.html?is-external=true" title="class or interface in java.security" class="externalLink">NoSuchAlgorithmException</a></code> - if the key algorithm is not available.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/NoSuchProviderException.html?is-external=true" title="class or interface in java.security" class="externalLink">NoSuchProviderException</a></code> - if the required crypto provider is not installed.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/cert/CertificateException.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">CertificateException</a></code> - fail</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code> - if the certificate could not be encoded.</dd>
<dd><code>org.ejbca.cvc.exception.ParseException</code> - if a CVC certificate could not be parsed.</dd>
<dd><code>org.ejbca.cvc.exception.ConstructionException</code> - if a CVC could not be assembled.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/NoSuchFieldException.html?is-external=true" title="class or interface in java.lang" class="externalLink">NoSuchFieldException</a></code> - is thrown if a CVC request can not be parsed.</dd>
<dd><code><a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a></code> - if the user has the wrong user status.</dd>
<dd><code><a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a></code> - if the users password does not match.</dd>
</dl>
</li>
</ul>
<a id="createRequestFailedResponse(org.cesecore.authentication.tokens.AuthenticationToken,org.cesecore.certificates.certificate.request.RequestMessage,java.lang.Class,org.cesecore.certificates.certificate.request.FailInfo,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createRequestFailedResponse</h4>
<pre class="methodSignature"><a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a>&nbsp;createRequestFailedResponse&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                                            <a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a>&nbsp;req,
                                            <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Class.html?is-external=true" title="class or interface in java.lang" class="externalLink">Class</a>&lt;? extends <a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a>&gt;&nbsp;responseClass,
                                            <a href="../../../../../cesecore/certificates/certificate/request/FailInfo.html" title="class in org.cesecore.certificates.certificate.request">FailInfo</a>&nbsp;failInfo,
                                            <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;failText)
                                     throws <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                                            <a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a>,
                                            <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></pre>
<div class="block">Method that generates a request failed response message. The request
 should already have been decrypted and verified.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>req</code> - a Certification Request message, containing the public key to be put in the
                      created certificate. Currently no additional parameters in requests are considered!</dd>
<dd><code>responseClass</code> - The implementation class that will be used as the response message.</dd>
<dd><code>failInfo</code> - the failure info in the failure response, for example FailInfo.BAD_REQUEST</dd>
<dd><code>failText</code> - free text failure message</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A decrypted and verified ResponseMessage message</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a></code> - if the cryptotoken use by the CA defined in the request is unavailable</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the targeted CA does not exist</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - if the authentication token wasn't authorized to the CA defined in the request</dd>
</dl>
</li>
</ul>
<a id="decryptAndVerifyRequest(org.cesecore.authentication.tokens.AuthenticationToken,org.cesecore.certificates.certificate.request.RequestMessage)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decryptAndVerifyRequest</h4>
<pre class="methodSignature"><a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a>&nbsp;decryptAndVerifyRequest&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                                       <a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a>&nbsp;req)
                                throws <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                                       <a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a>,
                                       <a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a>,
                                       <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></pre>
<div class="block">Method that just decrypts and verifies a request and should be used in those cases
 a when encrypted information needs to be extracted and presented to an RA for approval.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>req</code> - a Certification Request message, containing the public key to be put in the
                      created certificate. Currently no additional parameters in requests are considered!</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A decrypted and verified RequestMessage message</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the targeted CA does not exist</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a></code> - if the the request couldn't be verified.</dd>
<dd><code><a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a></code> - fail</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - fail</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request"><code>RequestMessage</code></a>, 
<a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request"><code>ResponseMessage</code></a>, 
<a href="../../../../../cesecore/certificates/certificate/request/X509ResponseMessage.html" title="class in org.cesecore.certificates.certificate.request"><code>X509ResponseMessage</code></a></dd>
</dl>
</li>
</ul>
<a id="getCRL(org.cesecore.authentication.tokens.AuthenticationToken,org.cesecore.certificates.certificate.request.RequestMessage,java.lang.Class)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCRL</h4>
<pre class="methodSignature"><a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a>&nbsp;getCRL&#8203;(<a href="../../../../../cesecore/authentication/tokens/AuthenticationToken.html" title="class in org.cesecore.authentication.tokens">AuthenticationToken</a>&nbsp;admin,
                       <a href="../../../../../cesecore/certificates/certificate/request/RequestMessage.html" title="interface in org.cesecore.certificates.certificate.request">RequestMessage</a>&nbsp;req,
                       <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Class.html?is-external=true" title="class or interface in java.lang" class="externalLink">Class</a>&lt;? extends <a href="../../../../../cesecore/certificates/certificate/request/ResponseMessage.html" title="interface in org.cesecore.certificates.certificate.request">ResponseMessage</a>&gt;&nbsp;responseClass)
                throws <a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a>,
                       <a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a>,
                       <a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a>,
                       <a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a>,
                       <a href="../../../../../cesecore/certificates/ca/SignRequestException.html" title="class in org.cesecore.certificates.ca">SignRequestException</a>,
                       <a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a>,
                       <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/UnsupportedEncodingException.html?is-external=true" title="class or interface in java.io" class="externalLink">UnsupportedEncodingException</a>,
                       <a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a>,
                       <a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>admin</code> - Information about the administrator or admin performing the event.</dd>
<dd><code>req</code> - a CRL Request message</dd>
<dd><code>responseClass</code> - the implementation class of the desired response</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The newly created certificate or null.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../model/ca/AuthStatusException.html" title="class in org.ejbca.core.model.ca">AuthStatusException</a></code> - fail</dd>
<dd><code><a href="../../../model/ca/AuthLoginException.html" title="class in org.ejbca.core.model.ca">AuthLoginException</a></code> - fail</dd>
<dd><code><a href="../../../../../cesecore/certificates/certificate/IllegalKeyException.html" title="class in org.cesecore.certificates.certificate">IllegalKeyException</a></code> - if the public key is of wrong type.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/CADoesntExistsException.html" title="class in org.cesecore.certificates.ca">CADoesntExistsException</a></code> - if the targeted CA does not exist</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/SignRequestException.html" title="class in org.cesecore.certificates.ca">SignRequestException</a></code> - if the provided request is invalid.</dd>
<dd><code><a href="../../../../../cesecore/certificates/ca/SignRequestSignatureException.html" title="class in org.cesecore.certificates.ca">SignRequestSignatureException</a></code> - if the provided client certificate was not signed by
                                       the CA.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/UnsupportedEncodingException.html?is-external=true" title="class or interface in java.io" class="externalLink">UnsupportedEncodingException</a></code> - fail</dd>
<dd><code><a href="../../../../../cesecore/keys/token/CryptoTokenOfflineException.html" title="class in org.cesecore.keys.token">CryptoTokenOfflineException</a></code> - fail</dd>
<dd><code><a href="../../../../../cesecore/authorization/AuthorizationDeniedException.html" title="class in org.cesecore.authorization">AuthorizationDeniedException</a></code> - fail</dd>
</dl>
</li>
</ul>
<a id="fetchCertGenParams()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>fetchCertGenParams</h4>
<pre class="methodSignature"><a href="../../../../../cesecore/certificates/ca/CertificateGenerationParams.html" title="class in org.cesecore.certificates.ca">CertificateGenerationParams</a>&nbsp;fetchCertGenParams()</pre>
<div class="block">Returns an object with configuration parameters for extensions (currently only for the CT extension).
 This information is needed by CESeCore methods that create certificates, since it must be fetched
 from the EJBCA configuration. Currently, this is needed in
 <a href="../../../../../cesecore/certificates/certificate/CertificateCreateSession.html" title="interface in org.cesecore.certificates.certificate"><code>CertificateCreateSession</code></a> and <a href="../../../../../cesecore/certificates/ca/X509CA.html" title="class in org.cesecore.certificates.ca"><code>X509CA</code></a>.

 The return value should only be passed directly into one of the CeSECore methods that use it.
 There's no point in accessing it from EJBCA code.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>params</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/SignSession.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2020. All rights reserved.</small></p>
</footer>
</body>
</html>