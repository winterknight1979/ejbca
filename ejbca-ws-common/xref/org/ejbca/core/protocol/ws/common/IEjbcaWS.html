<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>IEjbcaWS xref</title>
<link type="text/css" rel="stylesheet" href="../../../../../../stylesheet.css" />
</head>
<body>
<div id="overview"><a href="../../../../../../../apidocs/org/ejbca/core/protocol/ws/common/IEjbcaWS.html">View Javadoc</a></div><pre>
<a class="jxr_linenumber" name="L1" href="#L1">1</a>   <em class="jxr_javadoccomment">/*************************************************************************</em>
<a class="jxr_linenumber" name="L2" href="#L2">2</a>   <em class="jxr_javadoccomment"> *                                                                       *</em>
<a class="jxr_linenumber" name="L3" href="#L3">3</a>   <em class="jxr_javadoccomment"> *  EJBCA Community: The OpenSource Certificate Authority                *</em>
<a class="jxr_linenumber" name="L4" href="#L4">4</a>   <em class="jxr_javadoccomment"> *                                                                       *</em>
<a class="jxr_linenumber" name="L5" href="#L5">5</a>   <em class="jxr_javadoccomment"> *  This software is free software; you can redistribute it and/or       *</em>
<a class="jxr_linenumber" name="L6" href="#L6">6</a>   <em class="jxr_javadoccomment"> *  modify it under the terms of the GNU Lesser General Public           *</em>
<a class="jxr_linenumber" name="L7" href="#L7">7</a>   <em class="jxr_javadoccomment"> *  License as published by the Free Software Foundation; either         *</em>
<a class="jxr_linenumber" name="L8" href="#L8">8</a>   <em class="jxr_javadoccomment"> *  version 2.1 of the License, or any later version.                    *</em>
<a class="jxr_linenumber" name="L9" href="#L9">9</a>   <em class="jxr_javadoccomment"> *                                                                       *</em>
<a class="jxr_linenumber" name="L10" href="#L10">10</a>  <em class="jxr_javadoccomment"> *  See terms of license at gnu.org.                                     *</em>
<a class="jxr_linenumber" name="L11" href="#L11">11</a>  <em class="jxr_javadoccomment"> *                                                                       *</em>
<a class="jxr_linenumber" name="L12" href="#L12">12</a>  <em class="jxr_javadoccomment"> *************************************************************************/</em>
<a class="jxr_linenumber" name="L13" href="#L13">13</a>  <strong class="jxr_keyword">package</strong> org.ejbca.core.protocol.ws.common;
<a class="jxr_linenumber" name="L14" href="#L14">14</a>  
<a class="jxr_linenumber" name="L15" href="#L15">15</a>  <strong class="jxr_keyword">import</strong> java.security.cert.CertificateExpiredException;
<a class="jxr_linenumber" name="L16" href="#L16">16</a>  <strong class="jxr_keyword">import</strong> java.util.List;
<a class="jxr_linenumber" name="L17" href="#L17">17</a>  
<a class="jxr_linenumber" name="L18" href="#L18">18</a>  <strong class="jxr_keyword">import</strong> org.cesecore.CesecoreException;
<a class="jxr_linenumber" name="L19" href="#L19">19</a>  <strong class="jxr_keyword">import</strong> org.cesecore.authorization.AuthorizationDeniedException;
<a class="jxr_linenumber" name="L20" href="#L20">20</a>  <strong class="jxr_keyword">import</strong> org.cesecore.certificates.ca.CADoesntExistsException;
<a class="jxr_linenumber" name="L21" href="#L21">21</a>  <strong class="jxr_keyword">import</strong> org.cesecore.certificates.ca.CAExistsException;
<a class="jxr_linenumber" name="L22" href="#L22">22</a>  <strong class="jxr_keyword">import</strong> org.cesecore.certificates.ca.CAOfflineException;
<a class="jxr_linenumber" name="L23" href="#L23">23</a>  <strong class="jxr_keyword">import</strong> org.cesecore.certificates.ca.SignRequestException;
<a class="jxr_linenumber" name="L24" href="#L24">24</a>  <strong class="jxr_keyword">import</strong> org.cesecore.certificates.certificateprofile.CertificateProfileDoesNotExistException;
<a class="jxr_linenumber" name="L25" href="#L25">25</a>  <strong class="jxr_keyword">import</strong> org.cesecore.keys.token.CryptoTokenOfflineException;
<a class="jxr_linenumber" name="L26" href="#L26">26</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.EjbcaException;
<a class="jxr_linenumber" name="L27" href="#L27">27</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.approval.ApprovalException;
<a class="jxr_linenumber" name="L28" href="#L28">28</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.approval.ApprovalRequestExecutionException;
<a class="jxr_linenumber" name="L29" href="#L29">29</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.approval.ApprovalRequestExpiredException;
<a class="jxr_linenumber" name="L30" href="#L30">30</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.approval.WaitingForApprovalException;
<a class="jxr_linenumber" name="L31" href="#L31">31</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.ca.publisher.PublisherException;
<a class="jxr_linenumber" name="L32" href="#L32">32</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.hardtoken.HardTokenDoesntExistsException;
<a class="jxr_linenumber" name="L33" href="#L33">33</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.hardtoken.HardTokenExistsException;
<a class="jxr_linenumber" name="L34" href="#L34">34</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.ra.AlreadyRevokedException;
<a class="jxr_linenumber" name="L35" href="#L35">35</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.ra.NotFoundException;
<a class="jxr_linenumber" name="L36" href="#L36">36</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.ra.RevokeBackDateNotAllowedForProfileException;
<a class="jxr_linenumber" name="L37" href="#L37">37</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.ra.raadmin.EndEntityProfileNotFoundException;
<a class="jxr_linenumber" name="L38" href="#L38">38</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.ra.raadmin.UserDoesntFullfillEndEntityProfile;
<a class="jxr_linenumber" name="L39" href="#L39">39</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.ra.userdatasource.MultipleMatchException;
<a class="jxr_linenumber" name="L40" href="#L40">40</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.model.ra.userdatasource.UserDataSourceException;
<a class="jxr_linenumber" name="L41" href="#L41">41</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.UnknownProfileTypeException;
<a class="jxr_linenumber" name="L42" href="#L42">42</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.Certificate;
<a class="jxr_linenumber" name="L43" href="#L43">43</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.CertificateResponse;
<a class="jxr_linenumber" name="L44" href="#L44">44</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.HardTokenDataWS;
<a class="jxr_linenumber" name="L45" href="#L45">45</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.KeyStore;
<a class="jxr_linenumber" name="L46" href="#L46">46</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.NameAndId;
<a class="jxr_linenumber" name="L47" href="#L47">47</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.RevokeStatus;
<a class="jxr_linenumber" name="L48" href="#L48">48</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.TokenCertificateRequestWS;
<a class="jxr_linenumber" name="L49" href="#L49">49</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.TokenCertificateResponseWS;
<a class="jxr_linenumber" name="L50" href="#L50">50</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.UserDataSourceVOWS;
<a class="jxr_linenumber" name="L51" href="#L51">51</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.UserDataVOWS;
<a class="jxr_linenumber" name="L52" href="#L52">52</a>  <strong class="jxr_keyword">import</strong> org.ejbca.core.protocol.ws.objects.UserMatch;
<a class="jxr_linenumber" name="L53" href="#L53">53</a>  <strong class="jxr_keyword">import</strong> org.ejbca.ui.web.protocol.DateNotValidException;
<a class="jxr_linenumber" name="L54" href="#L54">54</a>  <strong class="jxr_keyword">import</strong> org.ejbca.util.KeyValuePair;
<a class="jxr_linenumber" name="L55" href="#L55">55</a>  <strong class="jxr_keyword">import</strong> org.ejbca.util.query.IllegalQueryException;
<a class="jxr_linenumber" name="L56" href="#L56">56</a>  
<a class="jxr_linenumber" name="L57" href="#L57">57</a>  <em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L58" href="#L58">58</a>  <em class="jxr_javadoccomment"> * Primary interface to the EJBCA RA WebService.</em>
<a class="jxr_linenumber" name="L59" href="#L59">59</a>  <em class="jxr_javadoccomment"> *</em>
<a class="jxr_linenumber" name="L60" href="#L60">60</a>  <em class="jxr_javadoccomment"> *</em>
<a class="jxr_linenumber" name="L61" href="#L61">61</a>  <em class="jxr_javadoccomment"> * Observe: All methods have to be called using client authenticated https</em>
<a class="jxr_linenumber" name="L62" href="#L62">62</a>  <em class="jxr_javadoccomment"> * otherwise an AuthorizationDenied exception will be thrown.</em>
<a class="jxr_linenumber" name="L63" href="#L63">63</a>  <em class="jxr_javadoccomment"> *</em>
<a class="jxr_linenumber" name="L64" href="#L64">64</a>  <em class="jxr_javadoccomment"> * @version $Id: IEjbcaWS.java 30587 2018-11-23 07:15:27Z samuellb $</em>
<a class="jxr_linenumber" name="L65" href="#L65">65</a>  <em class="jxr_javadoccomment"> */</em>
<a class="jxr_linenumber" name="L66" href="#L66">66</a>  @SuppressWarnings(<span class="jxr_string">"deprecation"</span>)
<a class="jxr_linenumber" name="L67" href="#L67">67</a>  <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">interface</strong> <a name="IEjbcaWS" href="../../../../../../org/ejbca/core/protocol/ws/common/IEjbcaWS.html#IEjbcaWS">IEjbcaWS</a> {
<a class="jxr_linenumber" name="L68" href="#L68">68</a>  
<a class="jxr_linenumber" name="L69" href="#L69">69</a>  	<strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">static</strong> <strong class="jxr_keyword">final</strong> <strong class="jxr_keyword">int</strong> CUSTOMLOG_LEVEL_INFO  = 1;
<a class="jxr_linenumber" name="L70" href="#L70">70</a>  	<strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">static</strong> <strong class="jxr_keyword">final</strong> <strong class="jxr_keyword">int</strong> CUSTOMLOG_LEVEL_ERROR = 2;
<a class="jxr_linenumber" name="L71" href="#L71">71</a>  
<a class="jxr_linenumber" name="L72" href="#L72">72</a>  	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L73" href="#L73">73</a>  <em class="jxr_javadoccomment">	 * Edits/adds a user to the EJBCA database.</em>
<a class="jxr_linenumber" name="L74" href="#L74">74</a>  <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L75" href="#L75">75</a>  <em class="jxr_javadoccomment">	 * If the user doesn't already exists it will be added otherwise it will be</em>
<a class="jxr_linenumber" name="L76" href="#L76">76</a>  <em class="jxr_javadoccomment">	 * overwritten.</em>
<a class="jxr_linenumber" name="L77" href="#L77">77</a>  <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L78" href="#L78">78</a>  <em class="jxr_javadoccomment">	 * Observe: if the user doesn't already exists, it's status will always be set to 'New'.</em>
<a class="jxr_linenumber" name="L79" href="#L79">79</a>  <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L80" href="#L80">80</a>  <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L81" href="#L81">81</a>  <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L82" href="#L82">82</a>  <em class="jxr_javadoccomment">	 * - /ra_functionality/create_end_entity and/or edit_end_entity</em>
<a class="jxr_linenumber" name="L83" href="#L83">83</a>  <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile of user&amp;gt;/create_end_entity and/or edit_end_entity</em>
<a class="jxr_linenumber" name="L84" href="#L84">84</a>  <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L85" href="#L85">85</a>  <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L86" href="#L86">86</a>  <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L87" href="#L87">87</a>  <em class="jxr_javadoccomment">	 * @param userdata contains all the information about the user about to be added.</em>
<a class="jxr_linenumber" name="L88" href="#L88">88</a>  <em class="jxr_javadoccomment">	 * clearPwd indicates it the password should be stored in clear text, required</em>
<a class="jxr_linenumber" name="L89" href="#L89">89</a>  <em class="jxr_javadoccomment">	 * when creating server generated keystores.</em>
<a class="jxr_linenumber" name="L90" href="#L90">90</a>  <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L91" href="#L91">91</a>  <em class="jxr_javadoccomment">	 * @throws ApprovalException On aapproval fail</em>
<a class="jxr_linenumber" name="L92" href="#L92">92</a>  <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if access denied</em>
<a class="jxr_linenumber" name="L93" href="#L93">93</a>  <em class="jxr_javadoccomment">	 * @throws UserDoesntFullfillEndEntityProfile on fulfillment fail</em>
<a class="jxr_linenumber" name="L94" href="#L94">94</a>  <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException if timeout</em>
<a class="jxr_linenumber" name="L95" href="#L95">95</a>  <em class="jxr_javadoccomment">	 * @throws EjbcaException other</em>
<a class="jxr_linenumber" name="L96" href="#L96">96</a>  <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L97" href="#L97">97</a>      @SuppressWarnings(<span class="jxr_string">"javadoc"</span>)
<a class="jxr_linenumber" name="L98" href="#L98">98</a>  	<strong class="jxr_keyword">void</strong> editUser(<a name="UserDataVOWS" href="../../../../../../org/ejbca/core/protocol/ws/objects/UserDataVOWS.html#UserDataVOWS">UserDataVOWS</a> userdata) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, UserDoesntFullfillEndEntityProfile,
<a class="jxr_linenumber" name="L99" href="#L99">99</a>              EjbcaException, ApprovalException, WaitingForApprovalException;
<a class="jxr_linenumber" name="L100" href="#L100">100</a> 
<a class="jxr_linenumber" name="L101" href="#L101">101</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L102" href="#L102">102</a> <em class="jxr_javadoccomment">	 * Retrieves information about users in the database.</em>
<a class="jxr_linenumber" name="L103" href="#L103">103</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L104" href="#L104">104</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L105" href="#L105">105</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L106" href="#L106">106</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/view_end_entity</em>
<a class="jxr_linenumber" name="L107" href="#L107">107</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile of matching users&amp;gt;/view_end_entity</em>
<a class="jxr_linenumber" name="L108" href="#L108">108</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of usermatch&amp;gt; - when matching on CA</em>
<a class="jxr_linenumber" name="L109" href="#L109">109</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L110" href="#L110">110</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L111" href="#L111">111</a> <em class="jxr_javadoccomment">	 * @param usermatch the unique user pattern to search for</em>
<a class="jxr_linenumber" name="L112" href="#L112">112</a> <em class="jxr_javadoccomment">	 * @return a array of {@link org.ejbca.core.protocol.ws.objects.UserDataVOWS} objects (Max 100) containing the information about the user or null if there are no matches.</em>
<a class="jxr_linenumber" name="L113" href="#L113">113</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized to request</em>
<a class="jxr_linenumber" name="L114" href="#L114">114</a> <em class="jxr_javadoccomment">	 * @throws IllegalQueryException if query isn't valid</em>
<a class="jxr_linenumber" name="L115" href="#L115">115</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException fail</em>
<a class="jxr_linenumber" name="L116" href="#L116">116</a> <em class="jxr_javadoccomment">	 * @throws EndEntityProfileNotFoundException fail</em>
<a class="jxr_linenumber" name="L117" href="#L117">117</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L118" href="#L118">118</a> 	List&lt;UserDataVOWS&gt; findUser(<a name="UserMatch" href="../../../../../../org/ejbca/core/protocol/ws/objects/UserMatch.html#UserMatch">UserMatch</a> usermatch)
<a class="jxr_linenumber" name="L119" href="#L119">119</a> 			<strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, IllegalQueryException, EjbcaException, EndEntityProfileNotFoundException;
<a class="jxr_linenumber" name="L120" href="#L120">120</a> 
<a class="jxr_linenumber" name="L121" href="#L121">121</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L122" href="#L122">122</a> <em class="jxr_javadoccomment">	 * Retrieves a collection of certificates generated for a user.</em>
<a class="jxr_linenumber" name="L123" href="#L123">123</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L124" href="#L124">124</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L125" href="#L125">125</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L126" href="#L126">126</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/view_end_entity</em>
<a class="jxr_linenumber" name="L127" href="#L127">127</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_end_entity</em>
<a class="jxr_linenumber" name="L128" href="#L128">128</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L129" href="#L129">129</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L130" href="#L130">130</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L131" href="#L131">131</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If authorization was denied or a certificate could not be encoded on the local system, </em>
<a class="jxr_linenumber" name="L132" href="#L132">132</a> <em class="jxr_javadoccomment">     *    then the request will be forwarded to upstream peer systems (if any) and the resulting </em>
<a class="jxr_linenumber" name="L133" href="#L133">133</a> <em class="jxr_javadoccomment">     *    certificates where merged by its fingerprint.&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L134" href="#L134">134</a> <em class="jxr_javadoccomment">     * </em>
<a class="jxr_linenumber" name="L135" href="#L135">135</a> <em class="jxr_javadoccomment">	 * @param username a unique username</em>
<a class="jxr_linenumber" name="L136" href="#L136">136</a> <em class="jxr_javadoccomment">	 * @param onlyValid only return valid certs not revoked or expired ones.</em>
<a class="jxr_linenumber" name="L137" href="#L137">137</a> <em class="jxr_javadoccomment">	 * @return a collection of Certificates or an empty list if no certificates, or no user, could be found</em>
<a class="jxr_linenumber" name="L138" href="#L138">138</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized to request</em>
<a class="jxr_linenumber" name="L139" href="#L139">139</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L140" href="#L140">140</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L141" href="#L141">141</a> 	List&lt;Certificate&gt; findCerts(String username,
<a class="jxr_linenumber" name="L142" href="#L142">142</a> 			<strong class="jxr_keyword">boolean</strong> onlyValid) <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, EjbcaException;
<a class="jxr_linenumber" name="L143" href="#L143">143</a> 
<a class="jxr_linenumber" name="L144" href="#L144">144</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L145" href="#L145">145</a> <em class="jxr_javadoccomment">     * Retrieves the current certificate chain for a CA.</em>
<a class="jxr_linenumber" name="L146" href="#L146">146</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L147" href="#L147">147</a> <em class="jxr_javadoccomment">     * &lt;pre&gt;</em>
<a class="jxr_linenumber" name="L148" href="#L148">148</a> <em class="jxr_javadoccomment">     * &lt;b&gt;Authorization requirements:&lt;/b&gt;</em>
<a class="jxr_linenumber" name="L149" href="#L149">149</a> <em class="jxr_javadoccomment">     * - /administrator</em>
<a class="jxr_linenumber" name="L150" href="#L150">150</a> <em class="jxr_javadoccomment">     * - /ca/&amp;lt;ca in question&amp;gt;</em>
<a class="jxr_linenumber" name="L151" href="#L151">151</a> <em class="jxr_javadoccomment">     * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L152" href="#L152">152</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L153" href="#L153">153</a> <em class="jxr_javadoccomment">     * &lt;p&gt;If the CA does not exist or authorization was denied on the local system, </em>
<a class="jxr_linenumber" name="L154" href="#L154">154</a> <em class="jxr_javadoccomment">     *     then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L155" href="#L155">155</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L156" href="#L156">156</a> <em class="jxr_javadoccomment">     * @param caname the unique name of the CA whose certificate chain should be returned</em>
<a class="jxr_linenumber" name="L157" href="#L157">157</a> <em class="jxr_javadoccomment">     * @return a list of X509 Certificates or CVC Certificates with the root certificate last, or an empty list if the CA's status is "Waiting for certificate response"</em>
<a class="jxr_linenumber" name="L158" href="#L158">158</a> <em class="jxr_javadoccomment">     * @throws AuthorizationDeniedException if the client does not fulfill the authorization requirements specified above</em>
<a class="jxr_linenumber" name="L159" href="#L159">159</a> <em class="jxr_javadoccomment">     * @throws CADoesntExistsException if the CA with the CA name given as input does not exist</em>
<a class="jxr_linenumber" name="L160" href="#L160">160</a> <em class="jxr_javadoccomment">     * @throws EjbcaException on internal errors, such as badly encoded certificate</em>
<a class="jxr_linenumber" name="L161" href="#L161">161</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L162" href="#L162">162</a>     List&lt;Certificate&gt; getLastCAChain(String caname) <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, CADoesntExistsException, EjbcaException;
<a class="jxr_linenumber" name="L163" href="#L163">163</a> 
<a class="jxr_linenumber" name="L164" href="#L164">164</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L165" href="#L165">165</a> <em class="jxr_javadoccomment">     * Retrieves the last certificate to expire for a given user. More formally, returns the certificate chain</em>
<a class="jxr_linenumber" name="L166" href="#L166">166</a> <em class="jxr_javadoccomment">     * [C1, C2... Cn] where C1 is the user's leaf certificate and Cn is the root certificate, such that it does</em>
<a class="jxr_linenumber" name="L167" href="#L167">167</a> <em class="jxr_javadoccomment">     * not exist a leaf certificate for the same user with an expiration date exceeding the expiration date of C1.</em>
<a class="jxr_linenumber" name="L168" href="#L168">168</a> <em class="jxr_javadoccomment">     * &lt;p&gt;</em>
<a class="jxr_linenumber" name="L169" href="#L169">169</a> <em class="jxr_javadoccomment">     * This method does not check whether the certificate to be returned has been revoked.</em>
<a class="jxr_linenumber" name="L170" href="#L170">170</a> <em class="jxr_javadoccomment">     * &lt;p&gt;</em>
<a class="jxr_linenumber" name="L171" href="#L171">171</a> <em class="jxr_javadoccomment">     * If the user is not found on the local system, then the query will be forwarded to upstream peer systems (if any).</em>
<a class="jxr_linenumber" name="L172" href="#L172">172</a> <em class="jxr_javadoccomment">     * &lt;p&gt;</em>
<a class="jxr_linenumber" name="L173" href="#L173">173</a> <em class="jxr_javadoccomment">     * Prior to EJBCA 6.8.0, the documentation incorrectly stated that this method could return null when it actually returns an empty list.</em>
<a class="jxr_linenumber" name="L174" href="#L174">174</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L175" href="#L175">175</a> <em class="jxr_javadoccomment">     * &lt;pre&gt;</em>
<a class="jxr_linenumber" name="L176" href="#L176">176</a> <em class="jxr_javadoccomment">     * &lt;b&gt;Authorization requirements:&lt;/b&gt;</em>
<a class="jxr_linenumber" name="L177" href="#L177">177</a> <em class="jxr_javadoccomment">     * - /administrator</em>
<a class="jxr_linenumber" name="L178" href="#L178">178</a> <em class="jxr_javadoccomment">     * - /ra_functionality/view_end_entity</em>
<a class="jxr_linenumber" name="L179" href="#L179">179</a> <em class="jxr_javadoccomment">     * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_end_entity</em>
<a class="jxr_linenumber" name="L180" href="#L180">180</a> <em class="jxr_javadoccomment">     * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L181" href="#L181">181</a> <em class="jxr_javadoccomment">     * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L182" href="#L182">182</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L183" href="#L183">183</a> <em class="jxr_javadoccomment">     * @param username the unique username of the user whose certificate should be returned</em>
<a class="jxr_linenumber" name="L184" href="#L184">184</a> <em class="jxr_javadoccomment">     * @return a list of X509 Certificates with the leaf certificate first, or an empty list if no certificate chain could be found for the specified user</em>
<a class="jxr_linenumber" name="L185" href="#L185">185</a> <em class="jxr_javadoccomment">     * @throws AuthorizationDeniedException if the client does not fulfill the authorization requirements specified above</em>
<a class="jxr_linenumber" name="L186" href="#L186">186</a> <em class="jxr_javadoccomment">     * @throws EjbcaException on internal errors, such as badly encoded certificate</em>
<a class="jxr_linenumber" name="L187" href="#L187">187</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L188" href="#L188">188</a>     List&lt;Certificate&gt; getLastCertChain(String username) <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, EjbcaException;
<a class="jxr_linenumber" name="L189" href="#L189">189</a> 
<a class="jxr_linenumber" name="L190" href="#L190">190</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L191" href="#L191">191</a> <em class="jxr_javadoccomment">	 * Creates a new cryptotoken</em>
<a class="jxr_linenumber" name="L192" href="#L192">192</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L193" href="#L193">193</a> <em class="jxr_javadoccomment">	 * @param tokenName The name of the cryptotoken</em>
<a class="jxr_linenumber" name="L194" href="#L194">194</a> <em class="jxr_javadoccomment">	 * @param tokenType The type of the cryptotoken. Available types: SoftCryptoToken, PKCS11CryptoToken</em>
<a class="jxr_linenumber" name="L195" href="#L195">195</a> <em class="jxr_javadoccomment">	 * @param activationPin Pin code for the cryptotoken</em>
<a class="jxr_linenumber" name="L196" href="#L196">196</a> <em class="jxr_javadoccomment">	 * @param autoActivate Set to true|false to allow|disallow whether cryptotoken should be autoactivated or not</em>
<a class="jxr_linenumber" name="L197" href="#L197">197</a> <em class="jxr_javadoccomment">	 * @param cryptotokenProperties as a List of KeyValuePair objects. See org.ejbca.core.protocol.ws.objects.CryptoTokenConstantsWS</em>
<a class="jxr_linenumber" name="L198" href="#L198">198</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L199" href="#L199">199</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Access denied</em>
<a class="jxr_linenumber" name="L200" href="#L200">200</a> <em class="jxr_javadoccomment">	 * @see "org.ejbca.core.protocol.ws.objects.CryptoTokenConstantsWS"</em>
<a class="jxr_linenumber" name="L201" href="#L201">201</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L202" href="#L202">202</a> 	 <strong class="jxr_keyword">void</strong> createCryptoToken(String tokenName, String tokenType, String activationPin, <strong class="jxr_keyword">boolean</strong> autoActivate,
<a class="jxr_linenumber" name="L203" href="#L203">203</a> 	        List&lt;KeyValuePair&gt; cryptotokenProperties) <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, EjbcaException;
<a class="jxr_linenumber" name="L204" href="#L204">204</a> 
<a class="jxr_linenumber" name="L205" href="#L205">205</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L206" href="#L206">206</a> <em class="jxr_javadoccomment">	 * Generates a key pair in the specified cryptotoken</em>
<a class="jxr_linenumber" name="L207" href="#L207">207</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L208" href="#L208">208</a> <em class="jxr_javadoccomment">	 * @param cryptoTokenName The name of the cryptotoken</em>
<a class="jxr_linenumber" name="L209" href="#L209">209</a> <em class="jxr_javadoccomment">	 * @param keyPairAlias Key pair alias</em>
<a class="jxr_linenumber" name="L210" href="#L210">210</a> <em class="jxr_javadoccomment">	 * @param keySpecification Key specification, for example RSA2048, secp256r1, DSA1024, gost3410, dstu4145</em>
<a class="jxr_linenumber" name="L211" href="#L211">211</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException access denied</em>
<a class="jxr_linenumber" name="L212" href="#L212">212</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L213" href="#L213">213</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L214" href="#L214">214</a> 	 <strong class="jxr_keyword">void</strong> generateCryptoTokenKeys(String cryptoTokenName, String keyPairAlias, String keySpecification)
<a class="jxr_linenumber" name="L215" href="#L215">215</a> 	        <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, EjbcaException;
<a class="jxr_linenumber" name="L216" href="#L216">216</a> 
<a class="jxr_linenumber" name="L217" href="#L217">217</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L218" href="#L218">218</a> <em class="jxr_javadoccomment">	 * Creates a new CA using the specified cryptotoken</em>
<a class="jxr_linenumber" name="L219" href="#L219">219</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L220" href="#L220">220</a> <em class="jxr_javadoccomment">     * @param caname The CA name</em>
<a class="jxr_linenumber" name="L221" href="#L221">221</a> <em class="jxr_javadoccomment">     * @param cadn The CA subjectDN</em>
<a class="jxr_linenumber" name="L222" href="#L222">222</a> <em class="jxr_javadoccomment">     * @param catype The CA type. It could be either 'x509' or 'cvc'</em>
<a class="jxr_linenumber" name="L223" href="#L223">223</a> <em class="jxr_javadoccomment">     * @param validityInDays Validity of the CA in days.</em>
<a class="jxr_linenumber" name="L224" href="#L224">224</a> <em class="jxr_javadoccomment">     * @param certprofile Makes the CA use the certificate profile 'certprofile' instead of the default ROOTCA or SUBCA.</em>
<a class="jxr_linenumber" name="L225" href="#L225">225</a> <em class="jxr_javadoccomment">     * @param signAlg Signing Algorithm may be one of the following: SHA1WithRSA, SHA256WithRSA, SHA384WithRSA, SHA512WithRSA</em>
<a class="jxr_linenumber" name="L226" href="#L226">226</a> <em class="jxr_javadoccomment">     * SHA256WithRSAAndMGF1, SHA1withECDSA, SHA224withECDSA, SHA256withECDSA, SHA384withECDSA, SHA512withECDSA, SHA1WithDSA,</em>
<a class="jxr_linenumber" name="L227" href="#L227">227</a> <em class="jxr_javadoccomment">     * GOST3411withECGOST3410, GOST3411withDSTU4145</em>
<a class="jxr_linenumber" name="L228" href="#L228">228</a> <em class="jxr_javadoccomment">     * @param signedByCAId The ID of a CA that will sign this CA. Use '1' for self signed CA (i.e. a root CA).</em>
<a class="jxr_linenumber" name="L229" href="#L229">229</a> <em class="jxr_javadoccomment">     * CAs created using the WS cannot be signed by external CAs.</em>
<a class="jxr_linenumber" name="L230" href="#L230">230</a> <em class="jxr_javadoccomment">     * @param cryptoTokenName The name of the cryptotoken associated with the CA</em>
<a class="jxr_linenumber" name="L231" href="#L231">231</a> <em class="jxr_javadoccomment">     * @param purposeKeyMapping The mapping the the cryptotoken keys and their purpose. See org.ejbca.core.protocol.ws.objects.CAConstantsWS</em>
<a class="jxr_linenumber" name="L232" href="#L232">232</a> <em class="jxr_javadoccomment">     * @param caProperties Optional CA properties. See  org.ejbca.core.protocol.ws.objects.CAConstantsWS</em>
<a class="jxr_linenumber" name="L233" href="#L233">233</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L234" href="#L234">234</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Access denied</em>
<a class="jxr_linenumber" name="L235" href="#L235">235</a> <em class="jxr_javadoccomment">     * @see "org.ejbca.core.protocol.ws.objects.CAConstantsWS"</em>
<a class="jxr_linenumber" name="L236" href="#L236">236</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L237" href="#L237">237</a> 	 <strong class="jxr_keyword">void</strong> createCA(String caname, String cadn, String catype, <strong class="jxr_keyword">long</strong> validityInDays, String certprofile,
<a class="jxr_linenumber" name="L238" href="#L238">238</a> 	        String signAlg, <strong class="jxr_keyword">int</strong> signedByCAId, String cryptoTokenName, List&lt;KeyValuePair&gt; purposeKeyMapping,
<a class="jxr_linenumber" name="L239" href="#L239">239</a> 	        List&lt;KeyValuePair&gt; caProperties) <strong class="jxr_keyword">throws</strong> EjbcaException, AuthorizationDeniedException;
<a class="jxr_linenumber" name="L240" href="#L240">240</a> 
<a class="jxr_linenumber" name="L241" href="#L241">241</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L242" href="#L242">242</a> <em class="jxr_javadoccomment">	 * Adds an administrator to the specified role</em>
<a class="jxr_linenumber" name="L243" href="#L243">243</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L244" href="#L244">244</a> <em class="jxr_javadoccomment">	 * @param roleName The role to add the admin to</em>
<a class="jxr_linenumber" name="L245" href="#L245">245</a> <em class="jxr_javadoccomment">	 * @param caName Name of the CA that issued the new administrator's certificate</em>
<a class="jxr_linenumber" name="L246" href="#L246">246</a> <em class="jxr_javadoccomment">	 * @param matchWith Could be any of: NONE, WITH_COUNTRY, WITH_DOMAINCOMPONENT, WITH_STATEORPROVINCE, WITH_LOCALITY, WITH_ORGANIZATION,</em>
<a class="jxr_linenumber" name="L247" href="#L247">247</a> <em class="jxr_javadoccomment">              WITH_ORGANIZATIONALUNIT, WITH_TITLE, WITH_COMMONNAME, WITH_UID, WITH_DNSERIALNUMBER, WITH_SERIALNUMBER,</em>
<a class="jxr_linenumber" name="L248" href="#L248">248</a> <em class="jxr_javadoccomment">              WITH_DNEMAILADDRESS, WITH_RFC822NAME, WITH_UPN, WITH_FULLDN</em>
<a class="jxr_linenumber" name="L249" href="#L249">249</a> <em class="jxr_javadoccomment">	 * @param matchType Could be one of: TYPE_EQUALCASE, TYPE_EQUALCASEINS, TYPE_NOT_EQUALCASE, TYPE_NOT_EQUALCASEINS, TYPE_NONE</em>
<a class="jxr_linenumber" name="L250" href="#L250">250</a> <em class="jxr_javadoccomment">	 * @param matchValue That value to match against</em>
<a class="jxr_linenumber" name="L251" href="#L251">251</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L252" href="#L252">252</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Access denied</em>
<a class="jxr_linenumber" name="L253" href="#L253">253</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L254" href="#L254">254</a> 	 <strong class="jxr_keyword">void</strong> addSubjectToRole(String roleName, String caName, String matchWith, String matchType, String matchValue)
<a class="jxr_linenumber" name="L255" href="#L255">255</a> 	        <strong class="jxr_keyword">throws</strong> EjbcaException, AuthorizationDeniedException;
<a class="jxr_linenumber" name="L256" href="#L256">256</a> 
<a class="jxr_linenumber" name="L257" href="#L257">257</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L258" href="#L258">258</a> <em class="jxr_javadoccomment">	 * Removes an administrator from the specified role</em>
<a class="jxr_linenumber" name="L259" href="#L259">259</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L260" href="#L260">260</a> <em class="jxr_javadoccomment">	 * @param roleName The role to remove the admin from</em>
<a class="jxr_linenumber" name="L261" href="#L261">261</a> <em class="jxr_javadoccomment">	 * @param caName Name of the CA that issued the administrator's certificate</em>
<a class="jxr_linenumber" name="L262" href="#L262">262</a> <em class="jxr_javadoccomment">	 * @param matchWith Could be any of: NONE, WITH_COUNTRY, WITH_DOMAINCOMPONENT, WITH_STATEORPROVINCE, WITH_LOCALITY, WITH_ORGANIZATION,</em>
<a class="jxr_linenumber" name="L263" href="#L263">263</a> <em class="jxr_javadoccomment">              WITH_ORGANIZATIONALUNIT, WITH_TITLE, WITH_COMMONNAME, WITH_UID, WITH_DNSERIALNUMBER, WITH_SERIALNUMBER,</em>
<a class="jxr_linenumber" name="L264" href="#L264">264</a> <em class="jxr_javadoccomment">              WITH_DNEMAILADDRESS, WITH_RFC822NAME, WITH_UPN, WITH_FULLDN</em>
<a class="jxr_linenumber" name="L265" href="#L265">265</a> <em class="jxr_javadoccomment">	 * @param matchType Could be one of: TYPE_EQUALCASE, TYPE_EQUALCASEINS, TYPE_NOT_EQUALCASE, TYPE_NOT_EQUALCASEINS, TYPE_NONE</em>
<a class="jxr_linenumber" name="L266" href="#L266">266</a> <em class="jxr_javadoccomment">	 * @param matchValue The value to match against</em>
<a class="jxr_linenumber" name="L267" href="#L267">267</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L268" href="#L268">268</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Access denied </em>
<a class="jxr_linenumber" name="L269" href="#L269">269</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L270" href="#L270">270</a> 	<strong class="jxr_keyword">void</strong> removeSubjectFromRole(String roleName, String caName, String matchWith, String matchType, String matchValue)
<a class="jxr_linenumber" name="L271" href="#L271">271</a> 	        <strong class="jxr_keyword">throws</strong> EjbcaException, AuthorizationDeniedException;
<a class="jxr_linenumber" name="L272" href="#L272">272</a> 
<a class="jxr_linenumber" name="L273" href="#L273">273</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L274" href="#L274">274</a> <em class="jxr_javadoccomment">	 *  Generates a certificate for a user.</em>
<a class="jxr_linenumber" name="L275" href="#L275">275</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L276" href="#L276">276</a> <em class="jxr_javadoccomment">	 *  Works the same as pkcs10Request.</em>
<a class="jxr_linenumber" name="L277" href="#L277">277</a> <em class="jxr_javadoccomment">	 *  </em>
<a class="jxr_linenumber" name="L278" href="#L278">278</a> <em class="jxr_javadoccomment">	 *  &lt;p&gt;If the CA does not exist, the user could not be found or authorization was denied on the local system, </em>
<a class="jxr_linenumber" name="L279" href="#L279">279</a> <em class="jxr_javadoccomment">	 *     then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L280" href="#L280">280</a> <em class="jxr_javadoccomment">     * </em>
<a class="jxr_linenumber" name="L281" href="#L281">281</a> <em class="jxr_javadoccomment">	 * @see #pkcs10Request(String, String, String, String, String)</em>
<a class="jxr_linenumber" name="L282" href="#L282">282</a> <em class="jxr_javadoccomment">	 * @param username the unique username</em>
<a class="jxr_linenumber" name="L283" href="#L283">283</a> <em class="jxr_javadoccomment">	 * @param password the password sent with editUser call</em>
<a class="jxr_linenumber" name="L284" href="#L284">284</a> <em class="jxr_javadoccomment">	 * @param crmf the CRMF request message (only the public key is used.)</em>
<a class="jxr_linenumber" name="L285" href="#L285">285</a> <em class="jxr_javadoccomment">     * @param hardTokenSN If the certificate should be connected with a hardtoken, it is</em>
<a class="jxr_linenumber" name="L286" href="#L286">286</a> <em class="jxr_javadoccomment">     * possible to map it by give the hardTokenSN here, this will simplify revocation of a token</em>
<a class="jxr_linenumber" name="L287" href="#L287">287</a> <em class="jxr_javadoccomment">     * certificates. Use null if no hardtokenSN should be associated with the certificate.</em>
<a class="jxr_linenumber" name="L288" href="#L288">288</a> <em class="jxr_javadoccomment">	 * @param responseType indicating which type of answer that should be returned, on of the</em>
<a class="jxr_linenumber" name="L289" href="#L289">289</a> <em class="jxr_javadoccomment">	 *                     {@link org.ejbca.core.protocol.ws.common.CertificateHelper}.RESPONSETYPE_ parameters.</em>
<a class="jxr_linenumber" name="L290" href="#L290">290</a> <em class="jxr_javadoccomment">	 * @return response</em>
<a class="jxr_linenumber" name="L291" href="#L291">291</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L292" href="#L292">292</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Access dened</em>
<a class="jxr_linenumber" name="L293" href="#L293">293</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException not found</em>
<a class="jxr_linenumber" name="L294" href="#L294">294</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L295" href="#L295">295</a> <em class="jxr_javadoccomment">	 * @throws CesecoreException Fail</em>
<a class="jxr_linenumber" name="L296" href="#L296">296</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L297" href="#L297">297</a> 	CertificateResponse crmfRequest(String username, String password,
<a class="jxr_linenumber" name="L298" href="#L298">298</a> 			String crmf, String hardTokenSN, String responseType)
<a class="jxr_linenumber" name="L299" href="#L299">299</a> 			<strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, NotFoundException,
<a class="jxr_linenumber" name="L300" href="#L300">300</a> 			EjbcaException, CesecoreException;
<a class="jxr_linenumber" name="L301" href="#L301">301</a> 
<a class="jxr_linenumber" name="L302" href="#L302">302</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L303" href="#L303">303</a> <em class="jxr_javadoccomment">	 *  Generates a certificate for a user.</em>
<a class="jxr_linenumber" name="L304" href="#L304">304</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L305" href="#L305">305</a> <em class="jxr_javadoccomment">	 *  &lt;p&gt;If the CA does not exist, the user could not be found or authorization was denied on the local system, </em>
<a class="jxr_linenumber" name="L306" href="#L306">306</a> <em class="jxr_javadoccomment">     *     then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L307" href="#L307">307</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L308" href="#L308">308</a> <em class="jxr_javadoccomment">	 * @see #pkcs10Request(String, String, String, String, String)</em>
<a class="jxr_linenumber" name="L309" href="#L309">309</a> <em class="jxr_javadoccomment">	 * @param username the unique username</em>
<a class="jxr_linenumber" name="L310" href="#L310">310</a> <em class="jxr_javadoccomment">	 * @param password the password sent with editUser call</em>
<a class="jxr_linenumber" name="L311" href="#L311">311</a> <em class="jxr_javadoccomment">	 * @param spkac the SPKAC (netscape) request message (only the public key is used.)</em>
<a class="jxr_linenumber" name="L312" href="#L312">312</a> <em class="jxr_javadoccomment">     * @param hardTokenSN If the certificate should be connected with a hardtoken, it is</em>
<a class="jxr_linenumber" name="L313" href="#L313">313</a> <em class="jxr_javadoccomment">     * possible to map it by give the hardTokenSN here, this will simplify revocation of a token</em>
<a class="jxr_linenumber" name="L314" href="#L314">314</a> <em class="jxr_javadoccomment">     * certificates. Use null if no hardtokenSN should be associated with the certificate.</em>
<a class="jxr_linenumber" name="L315" href="#L315">315</a> <em class="jxr_javadoccomment">	 * @param responseType indicating which type of answer that should be returned, on of the</em>
<a class="jxr_linenumber" name="L316" href="#L316">316</a> <em class="jxr_javadoccomment">	 *                     {@link org.ejbca.core.protocol.ws.common.CertificateHelper}.RESPONSETYPE_ parameters.</em>
<a class="jxr_linenumber" name="L317" href="#L317">317</a> <em class="jxr_javadoccomment">	 * @return Response</em>
<a class="jxr_linenumber" name="L318" href="#L318">318</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L319" href="#L319">319</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Access denied</em>
<a class="jxr_linenumber" name="L320" href="#L320">320</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException Fail</em>
<a class="jxr_linenumber" name="L321" href="#L321">321</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L322" href="#L322">322</a> <em class="jxr_javadoccomment">	 * @throws CesecoreException Fail</em>
<a class="jxr_linenumber" name="L323" href="#L323">323</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L324" href="#L324">324</a> 	CertificateResponse spkacRequest(String username, String password,
<a class="jxr_linenumber" name="L325" href="#L325">325</a> 			String spkac, String hardTokenSN, String responseType)
<a class="jxr_linenumber" name="L326" href="#L326">326</a> 			<strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, NotFoundException,
<a class="jxr_linenumber" name="L327" href="#L327">327</a> 			EjbcaException, CesecoreException;
<a class="jxr_linenumber" name="L328" href="#L328">328</a> 
<a class="jxr_linenumber" name="L329" href="#L329">329</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L330" href="#L330">330</a> <em class="jxr_javadoccomment">	 * Generates a CV certificate for a user.</em>
<a class="jxr_linenumber" name="L331" href="#L331">331</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L332" href="#L332">332</a> <em class="jxr_javadoccomment">	 * Uses the same authorizations as editUser and pkcs10Request</em>
<a class="jxr_linenumber" name="L333" href="#L333">333</a> <em class="jxr_javadoccomment">	 * responseType is always {@link org.ejbca.core.protocol.ws.common.CertificateHelper}.RESPONSETYPE_CERTIFICATE.</em>
<a class="jxr_linenumber" name="L334" href="#L334">334</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L335" href="#L335">335</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the CA does not exist, the user could not be found or authorization was denied on the local system, </em>
<a class="jxr_linenumber" name="L336" href="#L336">336</a> <em class="jxr_javadoccomment">     *     then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L337" href="#L337">337</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L338" href="#L338">338</a> <em class="jxr_javadoccomment">	 * @see #editUser(UserDataVOWS)</em>
<a class="jxr_linenumber" name="L339" href="#L339">339</a> <em class="jxr_javadoccomment">	 * @see #pkcs10Request(String, String, String, String, String)</em>
<a class="jxr_linenumber" name="L340" href="#L340">340</a> <em class="jxr_javadoccomment">	 * @param username the user name of the user requesting the certificate.</em>
<a class="jxr_linenumber" name="L341" href="#L341">341</a> <em class="jxr_javadoccomment">	 * @param password the password for initial enrollment, not used for renewal requests that can be authenticated using signatures with keys with valid certificates.</em>
<a class="jxr_linenumber" name="L342" href="#L342">342</a> <em class="jxr_javadoccomment">	 * @param cvcreq Base64 encoded CVC request message.</em>
<a class="jxr_linenumber" name="L343" href="#L343">343</a> <em class="jxr_javadoccomment">	 * @return the full certificate chain for the IS, with IS certificate in pos 0, DV in 1, CVCA in 2.</em>
<a class="jxr_linenumber" name="L344" href="#L344">344</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L345" href="#L345">345</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L346" href="#L346">346</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if administrator is not authorized to edit end entity or if an authenticated request can not be verified</em>
<a class="jxr_linenumber" name="L347" href="#L347">347</a> <em class="jxr_javadoccomment">	 * @throws SignRequestException if the provided request is invalid, for example not containing a username or password</em>
<a class="jxr_linenumber" name="L348" href="#L348">348</a> <em class="jxr_javadoccomment">	 * @throws UserDoesntFullfillEndEntityProfile Fail</em>
<a class="jxr_linenumber" name="L349" href="#L349">349</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException Fail</em>
<a class="jxr_linenumber" name="L350" href="#L350">350</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException for other errors, an error code like ErrorCode.SIGNATURE_ERROR (popo/inner signature verification failed) is set.</em>
<a class="jxr_linenumber" name="L351" href="#L351">351</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException Fail</em>
<a class="jxr_linenumber" name="L352" href="#L352">352</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException Fail</em>
<a class="jxr_linenumber" name="L353" href="#L353">353</a> <em class="jxr_javadoccomment">	 * @throws CertificateExpiredException Fail</em>
<a class="jxr_linenumber" name="L354" href="#L354">354</a> <em class="jxr_javadoccomment">	 * @throws CesecoreException Fail</em>
<a class="jxr_linenumber" name="L355" href="#L355">355</a> <em class="jxr_javadoccomment">	 * @see org.cesecore.ErrorCode</em>
<a class="jxr_linenumber" name="L356" href="#L356">356</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L357" href="#L357">357</a>     @SuppressWarnings(<span class="jxr_string">"javadoc"</span>)
<a class="jxr_linenumber" name="L358" href="#L358">358</a> 	List&lt;Certificate&gt; cvcRequest(String username, String password, String cvcreq)
<a class="jxr_linenumber" name="L359" href="#L359">359</a> 	<strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, UserDoesntFullfillEndEntityProfile, NotFoundException,
<a class="jxr_linenumber" name="L360" href="#L360">360</a> 	EjbcaException, ApprovalException, WaitingForApprovalException, SignRequestException, CertificateExpiredException, CesecoreException;
<a class="jxr_linenumber" name="L361" href="#L361">361</a> 
<a class="jxr_linenumber" name="L362" href="#L362">362</a> 
<a class="jxr_linenumber" name="L363" href="#L363">363</a> 	<em class="jxr_javadoccomment">/** Generates a certificate request (CSP) from a CA. The CSR can be sent to another CA to be signed, thus making the CA a sub CA of the signing CA.</em>
<a class="jxr_linenumber" name="L364" href="#L364">364</a> <em class="jxr_javadoccomment">	 * Can also be used for cross-certification. The method can use an existing key pair of the CA or generate a new key pair. The new key pair does not have to be</em>
<a class="jxr_linenumber" name="L365" href="#L365">365</a> <em class="jxr_javadoccomment">	 * activated and used as the CAs operational signature keys.</em>
<a class="jxr_linenumber" name="L366" href="#L366">366</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L367" href="#L367">367</a> <em class="jxr_javadoccomment">	 * Authorization requirements: the client certificate must have the following privileges set&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L368" href="#L368">368</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L369" href="#L369">369</a> <em class="jxr_javadoccomment">	 * - /ca_functionality/renew_ca</em>
<a class="jxr_linenumber" name="L370" href="#L370">370</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca to renew&amp;gt;</em>
<a class="jxr_linenumber" name="L371" href="#L371">371</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L372" href="#L372">372</a> <em class="jxr_javadoccomment">	 * @param caname The name in EJBCA for the CA that will create the CSR</em>
<a class="jxr_linenumber" name="L373" href="#L373">373</a> <em class="jxr_javadoccomment">	 * @param cachain the certificate chain for the CA this request is targeted for, the signing CA is in pos 0, it's CA (if it exists) in pos 1 etc. Certificate format is the binary certificate bytes.</em>
<a class="jxr_linenumber" name="L374" href="#L374">374</a> <em class="jxr_javadoccomment">	 * For DV renewals the cachain may be an empty list if there is a matching imported CVCA.</em>
<a class="jxr_linenumber" name="L375" href="#L375">375</a> <em class="jxr_javadoccomment">	 * Matching means having the same mnemonic,country and sequence as well as being external.</em>
<a class="jxr_linenumber" name="L376" href="#L376">376</a> <em class="jxr_javadoccomment">     * @param regenerateKeys if renewing a CA this is used to also generate a new KeyPair, if this is true and activatekey is false, the new key will not be activated immediately, but added as "next" signingkey.</em>
<a class="jxr_linenumber" name="L377" href="#L377">377</a> <em class="jxr_javadoccomment">     * @param usenextkey if regenerateKey is true this should be false. Otherwise it makes a request using an already existing "next" signing key, perhaps from a previous call with regenerateKeys true.</em>
<a class="jxr_linenumber" name="L378" href="#L378">378</a> <em class="jxr_javadoccomment">     * @param activatekey if regenerateKey is true or usenextkey is true, setting this flag to true makes the new or "next" key be activated when the request is created.</em>
<a class="jxr_linenumber" name="L379" href="#L379">379</a> <em class="jxr_javadoccomment">     * @param keystorepwd password used when regenerating keys or activating keys, can be null if regenerateKeys and activatekey is false.</em>
<a class="jxr_linenumber" name="L380" href="#L380">380</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L381" href="#L381">381</a> <em class="jxr_javadoccomment">     * @return byte array with binary encoded certificate request to be sent to signing CA.</em>
<a class="jxr_linenumber" name="L382" href="#L382">382</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L383" href="#L383">383</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if caname does not exist</em>
<a class="jxr_linenumber" name="L384" href="#L384">384</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if administrator is not authorized to create request, renew keys etc.</em>
<a class="jxr_linenumber" name="L385" href="#L385">385</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException if a non-expired approval for this action already exists, i.e. the same action has already been requested.</em>
<a class="jxr_linenumber" name="L386" href="#L386">386</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException if the operation requires approval from another CA administrator, in this case an approval request is created for another administrator to approve</em>
<a class="jxr_linenumber" name="L387" href="#L387">387</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException other errors in which case an org.ejbca.core.ErrorCade is set in the EjbcaException</em>
<a class="jxr_linenumber" name="L388" href="#L388">388</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L389" href="#L389">389</a> 	byte[] caRenewCertRequest(String caname, List&lt;byte[]&gt; cachain, <strong class="jxr_keyword">boolean</strong> regenerateKeys, <strong class="jxr_keyword">boolean</strong> usenextkey, <strong class="jxr_keyword">boolean</strong> activatekey, String keystorepwd) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, EjbcaException, ApprovalException, WaitingForApprovalException;
<a class="jxr_linenumber" name="L390" href="#L390">390</a> 
<a class="jxr_linenumber" name="L391" href="#L391">391</a> 	<em class="jxr_javadoccomment">/** Receives a certificate as a response to a CSR from the CA. The CSR might have been generated using the caRenewCertRequest.</em>
<a class="jxr_linenumber" name="L392" href="#L392">392</a> <em class="jxr_javadoccomment">	 * When the certificate is imported it is verified that the CA keys match the received certificate.</em>
<a class="jxr_linenumber" name="L393" href="#L393">393</a> <em class="jxr_javadoccomment">	 * This can be used to activate a new key pair on the CA. If the certificate does not match the existing key pair, but another key pair on the CAs token, this key pair can be activated and used as the CAs operational signature key pair.</em>
<a class="jxr_linenumber" name="L394" href="#L394">394</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L395" href="#L395">395</a> <em class="jxr_javadoccomment">	 * Authorization requirements: the client certificate must have the following privileges set&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L396" href="#L396">396</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L397" href="#L397">397</a> <em class="jxr_javadoccomment">	 * - /ca_functionality/renew_ca</em>
<a class="jxr_linenumber" name="L398" href="#L398">398</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca to import certificate&amp;gt;</em>
<a class="jxr_linenumber" name="L399" href="#L399">399</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L400" href="#L400">400</a> <em class="jxr_javadoccomment">	 * This method auto-senses if there is a new CA key that needs to be activated, it does this by comparing the public key in cert with public keys in the CAs token</em>
<a class="jxr_linenumber" name="L401" href="#L401">401</a> <em class="jxr_javadoccomment">	 * @param caname The name in EJBCA for the CA that will create the CSR</em>
<a class="jxr_linenumber" name="L402" href="#L402">402</a> <em class="jxr_javadoccomment">	 * @param cert the CA certificate to import. Certificate format is the binary certificate bytes.</em>
<a class="jxr_linenumber" name="L403" href="#L403">403</a> <em class="jxr_javadoccomment">	 * @param cachain the certificate chain for the CA this request is targeted for, the signing CA is in pos 0, it's CA (if it exists) in pos 1 etc. Certificate format is the binary certificate bytes.</em>
<a class="jxr_linenumber" name="L404" href="#L404">404</a> <em class="jxr_javadoccomment">	 * @param keystorepwd If there is a new CA key that must be activates the keystore password is needed. Set to null if the request was generated using the existing CA keys.</em>
<a class="jxr_linenumber" name="L405" href="#L405">405</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L406" href="#L406">406</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if caname does not exist</em>
<a class="jxr_linenumber" name="L407" href="#L407">407</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if administrator is not authorized to import certificate.</em>
<a class="jxr_linenumber" name="L408" href="#L408">408</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException if the operation requires approval from another CA administrator, in this case an approval request is created for another administrator to approve</em>
<a class="jxr_linenumber" name="L409" href="#L409">409</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException if there is already a request waiting for approval</em>
<a class="jxr_linenumber" name="L410" href="#L410">410</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException other errors in which case an org.ejbca.core.ErrorCade is set in the EjbcaException</em>
<a class="jxr_linenumber" name="L411" href="#L411">411</a> <em class="jxr_javadoccomment">	 * @throws CesecoreException Fail</em>
<a class="jxr_linenumber" name="L412" href="#L412">412</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L413" href="#L413">413</a> 	<strong class="jxr_keyword">void</strong> caCertResponse(String caname, byte[] cert, List&lt;byte[]&gt; cachain, String keystorepwd) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, EjbcaException, ApprovalException, WaitingForApprovalException, CesecoreException;
<a class="jxr_linenumber" name="L414" href="#L414">414</a> 
<a class="jxr_linenumber" name="L415" href="#L415">415</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L416" href="#L416">416</a> <em class="jxr_javadoccomment">	 * Receives a certificate as a response to a CSR from the CA, but does not activate the certificate yet.</em>
<a class="jxr_linenumber" name="L417" href="#L417">417</a> <em class="jxr_javadoccomment">	 * To activate the certificate at a later point, use the rolloverCACert method.</em>
<a class="jxr_linenumber" name="L418" href="#L418">418</a> <em class="jxr_javadoccomment">	 * It is also possible to configure a Rollover Service for automatic activation once the new certificate becomes valid.</em>
<a class="jxr_linenumber" name="L419" href="#L419">419</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L420" href="#L420">420</a> <em class="jxr_javadoccomment">	 * @param caname The name in EJBCA for the CA that will create the CSR</em>
<a class="jxr_linenumber" name="L421" href="#L421">421</a> <em class="jxr_javadoccomment">     * @param cert the CA certificate to import. Certificate format is the binary certificate bytes.</em>
<a class="jxr_linenumber" name="L422" href="#L422">422</a> <em class="jxr_javadoccomment">     * @param cachain the certificate chain for the CA this request is targeted for, the signing CA is in pos 0, it's CA (if it exists) in pos 1 etc. Certificate format is the binary certificate bytes.</em>
<a class="jxr_linenumber" name="L423" href="#L423">423</a> <em class="jxr_javadoccomment">     * @param keystorepwd If there is a new CA key that must be activates the keystore password is needed. Set to null if the request was generated using the existing CA keys.</em>
<a class="jxr_linenumber" name="L424" href="#L424">424</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L425" href="#L425">425</a> <em class="jxr_javadoccomment">     * @throws CADoesntExistsException Fail</em>
<a class="jxr_linenumber" name="L426" href="#L426">426</a> <em class="jxr_javadoccomment">     * @throws AuthorizationDeniedException Fail</em>
<a class="jxr_linenumber" name="L427" href="#L427">427</a> <em class="jxr_javadoccomment">     * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L428" href="#L428">428</a> <em class="jxr_javadoccomment">     * @throws ApprovalException Fail</em>
<a class="jxr_linenumber" name="L429" href="#L429">429</a> <em class="jxr_javadoccomment">     * @throws WaitingForApprovalException Fail</em>
<a class="jxr_linenumber" name="L430" href="#L430">430</a> <em class="jxr_javadoccomment">     * @throws CesecoreException Fail</em>
<a class="jxr_linenumber" name="L431" href="#L431">431</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L432" href="#L432">432</a> 	<strong class="jxr_keyword">void</strong> caCertResponseForRollover(String caname, byte[] cert, List&lt;byte[]&gt; cachain, String keystorepwd) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, EjbcaException, ApprovalException, WaitingForApprovalException, CesecoreException;
<a class="jxr_linenumber" name="L433" href="#L433">433</a> 
<a class="jxr_linenumber" name="L434" href="#L434">434</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L435" href="#L435">435</a> <em class="jxr_javadoccomment">	 * Imports a root or sub CA certificate of an external X.509 CA or CVC CA.</em>
<a class="jxr_linenumber" name="L436" href="#L436">436</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L437" href="#L437">437</a> <em class="jxr_javadoccomment">	 * @param caname the logical name of the CA in EJBCA.</em>
<a class="jxr_linenumber" name="L438" href="#L438">438</a> <em class="jxr_javadoccomment">	 * @param certbytes a byte array containing the CA certificate, and optional it's CA certificate chain.</em>
<a class="jxr_linenumber" name="L439" href="#L439">439</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L440" href="#L440">440</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Fail</em>
<a class="jxr_linenumber" name="L441" href="#L441">441</a> <em class="jxr_javadoccomment">	 * @throws CAExistsException if a CA with that logical name or CA certificate subject DN already exists.</em>
<a class="jxr_linenumber" name="L442" href="#L442">442</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if an other exception occurs.</em>
<a class="jxr_linenumber" name="L443" href="#L443">443</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L444" href="#L444">444</a> 	<strong class="jxr_keyword">void</strong> importCaCert(String caname, byte[] certbytes) <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, CAExistsException, EjbcaException;
<a class="jxr_linenumber" name="L445" href="#L445">445</a> 
<a class="jxr_linenumber" name="L446" href="#L446">446</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L447" href="#L447">447</a> <em class="jxr_javadoccomment">	 * Updates a root or sub CA certificate of an external X.509 CA or CVC CA.</em>
<a class="jxr_linenumber" name="L448" href="#L448">448</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L449" href="#L449">449</a> <em class="jxr_javadoccomment">	 * @param caname the logical name of the CA in EJBCA</em>
<a class="jxr_linenumber" name="L450" href="#L450">450</a> <em class="jxr_javadoccomment">	 * @param certbytes a byte array containing the CA certificate, and optional it's CA certificate chain.</em>
<a class="jxr_linenumber" name="L451" href="#L451">451</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L452" href="#L452">452</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Fail</em>
<a class="jxr_linenumber" name="L453" href="#L453">453</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a CA with that logical name does not exists in EJBCA.</em>
<a class="jxr_linenumber" name="L454" href="#L454">454</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if an other exception occurs.</em>
<a class="jxr_linenumber" name="L455" href="#L455">455</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L456" href="#L456">456</a> 	<strong class="jxr_keyword">void</strong> updateCaCert(String caname, byte[] certbytes) <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, CADoesntExistsException, EjbcaException;
<a class="jxr_linenumber" name="L457" href="#L457">457</a> 
<a class="jxr_linenumber" name="L458" href="#L458">458</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L459" href="#L459">459</a> <em class="jxr_javadoccomment">	 * Performs a certificate rollover for a CA with a rollover certificate previously added with caCertResponseForRollover.</em>
<a class="jxr_linenumber" name="L460" href="#L460">460</a> <em class="jxr_javadoccomment">	 * @param caname Name</em>
<a class="jxr_linenumber" name="L461" href="#L461">461</a> <em class="jxr_javadoccomment">     * @throws AuthorizationDeniedException if administrator is not authorized to import certificate.</em>
<a class="jxr_linenumber" name="L462" href="#L462">462</a> <em class="jxr_javadoccomment">     * @throws CADoesntExistsException if caname does not exist</em>
<a class="jxr_linenumber" name="L463" href="#L463">463</a> <em class="jxr_javadoccomment">     * @throws EjbcaException other errors in which case an org.ejbca.core.ErrorCode is set in the EjbcaException</em>
<a class="jxr_linenumber" name="L464" href="#L464">464</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L465" href="#L465">465</a>     <strong class="jxr_keyword">void</strong> rolloverCACert(String caname) <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, CADoesntExistsException, EjbcaException;
<a class="jxr_linenumber" name="L466" href="#L466">466</a> 
<a class="jxr_linenumber" name="L467" href="#L467">467</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L468" href="#L468">468</a> <em class="jxr_javadoccomment">	 * Generates a certificate for a user.</em>
<a class="jxr_linenumber" name="L469" href="#L469">469</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L470" href="#L470">470</a> <em class="jxr_javadoccomment">	 * The method must be preceded by</em>
<a class="jxr_linenumber" name="L471" href="#L471">471</a> <em class="jxr_javadoccomment">	 * a editUser call, either to set the userstatus to 'new' or to add non-existing users.</em>
<a class="jxr_linenumber" name="L472" href="#L472">472</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L473" href="#L473">473</a> <em class="jxr_javadoccomment">	 * Observe, the user must first have added/set the status to new with edituser command</em>
<a class="jxr_linenumber" name="L474" href="#L474">474</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L475" href="#L475">475</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L476" href="#L476">476</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L477" href="#L477">477</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/view_end_entity</em>
<a class="jxr_linenumber" name="L478" href="#L478">478</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_end_entity</em>
<a class="jxr_linenumber" name="L479" href="#L479">479</a> <em class="jxr_javadoccomment">	 * - /ca_functionality/create_certificate</em>
<a class="jxr_linenumber" name="L480" href="#L480">480</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L481" href="#L481">481</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L482" href="#L482">482</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L483" href="#L483">483</a> <em class="jxr_javadoccomment">	 * @param username the unique username</em>
<a class="jxr_linenumber" name="L484" href="#L484">484</a> <em class="jxr_javadoccomment">	 * @param password the password sent with editUser call</em>
<a class="jxr_linenumber" name="L485" href="#L485">485</a> <em class="jxr_javadoccomment">	 * @param pkcs10 the base64 encoded PKCS10 (only the public key is used.)</em>
<a class="jxr_linenumber" name="L486" href="#L486">486</a> <em class="jxr_javadoccomment">	 * @param hardTokenSN If the certificate should be connected with a hardtoken, it is</em>
<a class="jxr_linenumber" name="L487" href="#L487">487</a> <em class="jxr_javadoccomment">	 * possible to map it by give the hardTokenSN here, this will simplify revocation of a tokens</em>
<a class="jxr_linenumber" name="L488" href="#L488">488</a> <em class="jxr_javadoccomment">	 * certificates. Use null if no hardtokenSN should be associated with the certificate.</em>
<a class="jxr_linenumber" name="L489" href="#L489">489</a> <em class="jxr_javadoccomment">	 * @param responseType indicating which type of answer that should be returned, on of the</em>
<a class="jxr_linenumber" name="L490" href="#L490">490</a> <em class="jxr_javadoccomment">	 * {@link org.ejbca.core.protocol.ws.common.CertificateHelper}.RESPONSETYPE_ parameters.</em>
<a class="jxr_linenumber" name="L491" href="#L491">491</a> <em class="jxr_javadoccomment">	 * @return the generated certificate, in either just X509Certificate or PKCS7</em>
<a class="jxr_linenumber" name="L492" href="#L492">492</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L493" href="#L493">493</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized to request</em>
<a class="jxr_linenumber" name="L494" href="#L494">494</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException if user cannot be found</em>
<a class="jxr_linenumber" name="L495" href="#L495">495</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L496" href="#L496">496</a> <em class="jxr_javadoccomment">	 * @throws CesecoreException Fail</em>
<a class="jxr_linenumber" name="L497" href="#L497">497</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L498" href="#L498">498</a>     <a name="CertificateResponse" href="../../../../../../org/ejbca/core/protocol/ws/objects/CertificateResponse.html#CertificateResponse">CertificateResponse</a> pkcs10Request(String username, String password, String pkcs10, String hardTokenSN, String responseType)
<a class="jxr_linenumber" name="L499" href="#L499">499</a>             <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, NotFoundException, EjbcaException, CesecoreException;
<a class="jxr_linenumber" name="L500" href="#L500">500</a> 
<a class="jxr_linenumber" name="L501" href="#L501">501</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L502" href="#L502">502</a> <em class="jxr_javadoccomment">	 * Creates a server-generated keystore.</em>
<a class="jxr_linenumber" name="L503" href="#L503">503</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L504" href="#L504">504</a> <em class="jxr_javadoccomment">	 * The method must be preceded by</em>
<a class="jxr_linenumber" name="L505" href="#L505">505</a> <em class="jxr_javadoccomment">	 * a editUser call, either to set the userstatus to 'new' or to add non-existing users and</em>
<a class="jxr_linenumber" name="L506" href="#L506">506</a> <em class="jxr_javadoccomment">	 * the user's token must be set to org.ejbca.core.protocol.ws.client.gen.UserDataVOWS.TOKEN_TYPE_P12.&lt;br&gt;</em>
<a class="jxr_linenumber" name="L507" href="#L507">507</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L508" href="#L508">508</a> <em class="jxr_javadoccomment">	 * Authorization requirements: &lt;pre&gt;</em>
<a class="jxr_linenumber" name="L509" href="#L509">509</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L510" href="#L510">510</a> <em class="jxr_javadoccomment">     * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L511" href="#L511">511</a> <em class="jxr_javadoccomment">     * - /ca_functionality/create_certificate</em>
<a class="jxr_linenumber" name="L512" href="#L512">512</a> <em class="jxr_javadoccomment">     * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_end_entity</em>
<a class="jxr_linenumber" name="L513" href="#L513">513</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/view_end_entity</em>
<a class="jxr_linenumber" name="L514" href="#L514">514</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L515" href="#L515">515</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L516" href="#L516">516</a> <em class="jxr_javadoccomment">     * Additional authorization requirements for (non key recovery) clearing of password: &lt;pre&gt;</em>
<a class="jxr_linenumber" name="L517" href="#L517">517</a> <em class="jxr_javadoccomment">     * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/edit_end_entity</em>
<a class="jxr_linenumber" name="L518" href="#L518">518</a> <em class="jxr_javadoccomment">     * - /ra_functionality/edit_end_entity</em>
<a class="jxr_linenumber" name="L519" href="#L519">519</a> <em class="jxr_javadoccomment">     * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L520" href="#L520">520</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L521" href="#L521">521</a> <em class="jxr_javadoccomment">     * Additional authorization requirements for key recovery: &lt;pre&gt;</em>
<a class="jxr_linenumber" name="L522" href="#L522">522</a> <em class="jxr_javadoccomment">     * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/keyrecovery</em>
<a class="jxr_linenumber" name="L523" href="#L523">523</a> <em class="jxr_javadoccomment">     * - /ra_functionality/keyrecovery</em>
<a class="jxr_linenumber" name="L524" href="#L524">524</a> <em class="jxr_javadoccomment">     * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L525" href="#L525">525</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L526" href="#L526">526</a> <em class="jxr_javadoccomment">     * &lt;p&gt;If the CA does not exist, the user could not be found or authorization was denied on the local system, </em>
<a class="jxr_linenumber" name="L527" href="#L527">527</a> <em class="jxr_javadoccomment">     *     then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L528" href="#L528">528</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L529" href="#L529">529</a> <em class="jxr_javadoccomment">	 * @param username the unique username</em>
<a class="jxr_linenumber" name="L530" href="#L530">530</a> <em class="jxr_javadoccomment">	 * @param password the password sent with editUser call</em>
<a class="jxr_linenumber" name="L531" href="#L531">531</a> <em class="jxr_javadoccomment">	 * @param hardTokenSN If the certificate should be connected with a hardtoken, it is</em>
<a class="jxr_linenumber" name="L532" href="#L532">532</a> <em class="jxr_javadoccomment">	 * possible to map it by give the hardTokenSN here, this will simplify revocation of a tokens</em>
<a class="jxr_linenumber" name="L533" href="#L533">533</a> <em class="jxr_javadoccomment">	 * certificates. Use null if no hardtokenSN should be associated with the certificate.</em>
<a class="jxr_linenumber" name="L534" href="#L534">534</a> <em class="jxr_javadoccomment">	 * @param keyspec that the generated key should have, examples are 2048 for RSA or secp256r1 for ECDSA.</em>
<a class="jxr_linenumber" name="L535" href="#L535">535</a> <em class="jxr_javadoccomment">	 * @param keyalg that the generated key should have, RSA, ECDSA. Use one of the constants in</em>
<a class="jxr_linenumber" name="L536" href="#L536">536</a> <em class="jxr_javadoccomment">	 * {@link org.cesecore.certificates.util.AlgorithmConstants}.KEYALGORITHM_...</em>
<a class="jxr_linenumber" name="L537" href="#L537">537</a> <em class="jxr_javadoccomment">	 * @return the generated keystore</em>
<a class="jxr_linenumber" name="L538" href="#L538">538</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L539" href="#L539">539</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized to request</em>
<a class="jxr_linenumber" name="L540" href="#L540">540</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException if user cannot be found</em>
<a class="jxr_linenumber" name="L541" href="#L541">541</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L542" href="#L542">542</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L543" href="#L543">543</a> 	KeyStore pkcs12Req(String username, String password,
<a class="jxr_linenumber" name="L544" href="#L544">544</a> 			String hardTokenSN, String keyspec, String keyalg)
<a class="jxr_linenumber" name="L545" href="#L545">545</a> 			<strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, NotFoundException,
<a class="jxr_linenumber" name="L546" href="#L546">546</a> 			EjbcaException;
<a class="jxr_linenumber" name="L547" href="#L547">547</a> 
<a class="jxr_linenumber" name="L548" href="#L548">548</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L549" href="#L549">549</a> <em class="jxr_javadoccomment">	 * Revokes a user certificate.</em>
<a class="jxr_linenumber" name="L550" href="#L550">550</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L551" href="#L551">551</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L552" href="#L552">552</a> <em class="jxr_javadoccomment">	 * - Administrator flag set</em>
<a class="jxr_linenumber" name="L553" href="#L553">553</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L554" href="#L554">554</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/revoke_end_entity</em>
<a class="jxr_linenumber" name="L555" href="#L555">555</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile of the user owning the cert&amp;gt;/revoke_end_entity</em>
<a class="jxr_linenumber" name="L556" href="#L556">556</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of certificate&amp;gt;</em>
<a class="jxr_linenumber" name="L557" href="#L557">557</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L558" href="#L558">558</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;</em>
<a class="jxr_linenumber" name="L559" href="#L559">559</a> <em class="jxr_javadoccomment">	 * To use this call the certificate to be used must be from a certificate profile that has 'Allow back dated revocation' enabled.</em>
<a class="jxr_linenumber" name="L560" href="#L560">560</a> <em class="jxr_javadoccomment">	 * &lt;/p&gt;</em>
<a class="jxr_linenumber" name="L561" href="#L561">561</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If {@link RevokeBackDateNotAllowedForProfileException} is throwed then the CA is not</em>
<a class="jxr_linenumber" name="L562" href="#L562">562</a> <em class="jxr_javadoccomment">	 * allowing back date and you could then revoke with {@link #revokeCert(String, String, int)}.</em>
<a class="jxr_linenumber" name="L563" href="#L563">563</a> <em class="jxr_javadoccomment">	 * {@link DateNotValidException} means that the date parameter can't be parsed and in this case it might also</em>
<a class="jxr_linenumber" name="L564" href="#L564">564</a> <em class="jxr_javadoccomment">	 * be better with a fall back to {@link #revokeCert(String, String, int)}.</em>
<a class="jxr_linenumber" name="L565" href="#L565">565</a> <em class="jxr_javadoccomment">	 * &lt;/p&gt;</em>
<a class="jxr_linenumber" name="L566" href="#L566">566</a> <em class="jxr_javadoccomment">	 * </em>
<a class="jxr_linenumber" name="L567" href="#L567">567</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the CA does not exist on the local system, then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L568" href="#L568">568</a> <em class="jxr_javadoccomment">	 * </em>
<a class="jxr_linenumber" name="L569" href="#L569">569</a> <em class="jxr_javadoccomment">	 * @param issuerDN of the certificate to revoke</em>
<a class="jxr_linenumber" name="L570" href="#L570">570</a> <em class="jxr_javadoccomment">	 * @param certificateSN Certificate serial number in hex format of the certificate to revoke (without any "0x", "h" or similar)</em>
<a class="jxr_linenumber" name="L571" href="#L571">571</a> <em class="jxr_javadoccomment">	 * @param reason for revocation, one of org.ejbca.core.protocol.ws.client.gen.RevokeStatus.REVOKATION_REASON_ constants,</em>
<a class="jxr_linenumber" name="L572" href="#L572">572</a> <em class="jxr_javadoccomment">	 * or use org.ejbca.core.protocol.ws.client.gen.RevokeStatus.NOT_REVOKED to un-revoke a certificate on hold.</em>
<a class="jxr_linenumber" name="L573" href="#L573">573</a> <em class="jxr_javadoccomment">	 * @param sDate The revocation date. If null then the current date is used. If specified then the profile of the certificate must allow</em>
<a class="jxr_linenumber" name="L574" href="#L574">574</a> <em class="jxr_javadoccomment">	 * "back dating" and the date must be i the past. The parameter is specified as an</em>
<a class="jxr_linenumber" name="L575" href="#L575">575</a> <em class="jxr_javadoccomment">	 * &lt;a href="<a href="http://en.wikipedia.org/wiki/ISO8601" target="alexandria_uri">http://en.wikipedia.org/wiki/ISO8601</a>"&gt;ISO 8601 string&lt;/a&gt;.</em>
<a class="jxr_linenumber" name="L576" href="#L576">576</a> <em class="jxr_javadoccomment">	 * An example: 2012-06-07T23:55:59+02:00</em>
<a class="jxr_linenumber" name="L577" href="#L577">577</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L578" href="#L578">578</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized.</em>
<a class="jxr_linenumber" name="L579" href="#L579">579</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException if certificate doesn't exist</em>
<a class="jxr_linenumber" name="L580" href="#L580">580</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException If request has bean added to list of tasks to be approved</em>
<a class="jxr_linenumber" name="L581" href="#L581">581</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException There already exists an approval request for this task</em>
<a class="jxr_linenumber" name="L582" href="#L582">582</a> <em class="jxr_javadoccomment">	 * @throws AlreadyRevokedException The certificate was already revoked, or you tried to unrevoke a permanently revoked certificate</em>
<a class="jxr_linenumber" name="L583" href="#L583">583</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException internal error</em>
<a class="jxr_linenumber" name="L584" href="#L584">584</a> <em class="jxr_javadoccomment">	 * @throws RevokeBackDateNotAllowedForProfileException if back date is not allowed in the certificate profile</em>
<a class="jxr_linenumber" name="L585" href="#L585">585</a> <em class="jxr_javadoccomment">	 * @throws DateNotValidException if the date is not a valid ISO 8601 string or if it is in the future.</em>
<a class="jxr_linenumber" name="L586" href="#L586">586</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L587" href="#L587">587</a> 	<strong class="jxr_keyword">void</strong> revokeCertBackdated(String issuerDN, String certificateSN, <strong class="jxr_keyword">int</strong> reason,
<a class="jxr_linenumber" name="L588" href="#L588">588</a> 			String sDate) <strong class="jxr_keyword">throws</strong> CADoesntExistsException,
<a class="jxr_linenumber" name="L589" href="#L589">589</a> 			AuthorizationDeniedException, NotFoundException, EjbcaException,
<a class="jxr_linenumber" name="L590" href="#L590">590</a> 			ApprovalException, WaitingForApprovalException,
<a class="jxr_linenumber" name="L591" href="#L591">591</a> 			AlreadyRevokedException, RevokeBackDateNotAllowedForProfileException, DateNotValidException;
<a class="jxr_linenumber" name="L592" href="#L592">592</a> 
<a class="jxr_linenumber" name="L593" href="#L593">593</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L594" href="#L594">594</a> <em class="jxr_javadoccomment">	 * Same as {@link #revokeCertBackdated(String, String, int, String)} but revocation date is current time.</em>
<a class="jxr_linenumber" name="L595" href="#L595">595</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L596" href="#L596">596</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the CA does not exist on the local system, then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L597" href="#L597">597</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L598" href="#L598">598</a> <em class="jxr_javadoccomment">	 * @param issuerDN DN</em>
<a class="jxr_linenumber" name="L599" href="#L599">599</a> <em class="jxr_javadoccomment">	 * @param certificateSN SN</em>
<a class="jxr_linenumber" name="L600" href="#L600">600</a> <em class="jxr_javadoccomment">	 * @param reason Reason</em>
<a class="jxr_linenumber" name="L601" href="#L601">601</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException Fail</em>
<a class="jxr_linenumber" name="L602" href="#L602">602</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Fail</em>
<a class="jxr_linenumber" name="L603" href="#L603">603</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException Fail</em>
<a class="jxr_linenumber" name="L604" href="#L604">604</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException FAil</em>
<a class="jxr_linenumber" name="L605" href="#L605">605</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException FAil</em>
<a class="jxr_linenumber" name="L606" href="#L606">606</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException FAil</em>
<a class="jxr_linenumber" name="L607" href="#L607">607</a> <em class="jxr_javadoccomment">	 * @throws AlreadyRevokedException Fail</em>
<a class="jxr_linenumber" name="L608" href="#L608">608</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L609" href="#L609">609</a> 	<strong class="jxr_keyword">void</strong> revokeCert(String issuerDN, String certificateSN, <strong class="jxr_keyword">int</strong> reason) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, 
<a class="jxr_linenumber" name="L610" href="#L610">610</a> 	        NotFoundException, EjbcaException, ApprovalException, WaitingForApprovalException, AlreadyRevokedException;
<a class="jxr_linenumber" name="L611" href="#L611">611</a> 	
<a class="jxr_linenumber" name="L612" href="#L612">612</a> 	 <em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L613" href="#L613">613</a> <em class="jxr_javadoccomment">     * Revokes a user certificate. Allows to specify column values via metadata input param.</em>
<a class="jxr_linenumber" name="L614" href="#L614">614</a> <em class="jxr_javadoccomment">     * Metadata is a list of key-value pairs, keys can be for example: certificateProfileId, reason, revocationdate</em>
<a class="jxr_linenumber" name="L615" href="#L615">615</a> <em class="jxr_javadoccomment">     * </em>
<a class="jxr_linenumber" name="L616" href="#L616">616</a> <em class="jxr_javadoccomment">     * &lt;p&gt;If the CA does not exist on the local system, then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L617" href="#L617">617</a> <em class="jxr_javadoccomment">	 * @param issuerDN DN</em>
<a class="jxr_linenumber" name="L618" href="#L618">618</a> <em class="jxr_javadoccomment">	 * @param certificateSN SN</em>
<a class="jxr_linenumber" name="L619" href="#L619">619</a> <em class="jxr_javadoccomment">	 * @param metadata Data</em>
<a class="jxr_linenumber" name="L620" href="#L620">620</a> <em class="jxr_javadoccomment">     * </em>
<a class="jxr_linenumber" name="L621" href="#L621">621</a> <em class="jxr_javadoccomment">     * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L622" href="#L622">622</a> <em class="jxr_javadoccomment">     * @throws AuthorizationDeniedException if client isn't authorized.</em>
<a class="jxr_linenumber" name="L623" href="#L623">623</a> <em class="jxr_javadoccomment">     * @throws NotFoundException if certificate doesn't exist</em>
<a class="jxr_linenumber" name="L624" href="#L624">624</a> <em class="jxr_javadoccomment">     * @throws EjbcaException internal error</em>
<a class="jxr_linenumber" name="L625" href="#L625">625</a> <em class="jxr_javadoccomment">     * @throws ApprovalException There already exists an approval request for this task</em>
<a class="jxr_linenumber" name="L626" href="#L626">626</a> <em class="jxr_javadoccomment">     * @throws WaitingForApprovalException If request has bean added to list of tasks to be approved</em>
<a class="jxr_linenumber" name="L627" href="#L627">627</a> <em class="jxr_javadoccomment">     * @throws AlreadyRevokedException The certificate was already revoked, or you tried to unrevoke a permanently revoked certificate</em>
<a class="jxr_linenumber" name="L628" href="#L628">628</a> <em class="jxr_javadoccomment">     * @throws RevokeBackDateNotAllowedForProfileException if back date is not allowed in the certificate profile</em>
<a class="jxr_linenumber" name="L629" href="#L629">629</a> <em class="jxr_javadoccomment">     * @throws DateNotValidException if the date is not a valid ISO 8601 string or if it is in the future.</em>
<a class="jxr_linenumber" name="L630" href="#L630">630</a> <em class="jxr_javadoccomment">	 * @throws CertificateProfileDoesNotExistException if no profile was found with certRevocationDto.certificateProfileId input parameter.</em>
<a class="jxr_linenumber" name="L631" href="#L631">631</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L632" href="#L632">632</a> 	<strong class="jxr_keyword">void</strong> revokeCertWithMetadata(String issuerDN, String certificateSN, List&lt;KeyValuePair&gt; metadata)
<a class="jxr_linenumber" name="L633" href="#L633">633</a>             <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, NotFoundException, EjbcaException, ApprovalException,
<a class="jxr_linenumber" name="L634" href="#L634">634</a>             WaitingForApprovalException, AlreadyRevokedException, RevokeBackDateNotAllowedForProfileException, DateNotValidException, 
<a class="jxr_linenumber" name="L635" href="#L635">635</a>             CertificateProfileDoesNotExistException;
<a class="jxr_linenumber" name="L636" href="#L636">636</a> 	
<a class="jxr_linenumber" name="L637" href="#L637">637</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L638" href="#L638">638</a> <em class="jxr_javadoccomment">	 * Revokes all of a user's certificates.</em>
<a class="jxr_linenumber" name="L639" href="#L639">639</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L640" href="#L640">640</a> <em class="jxr_javadoccomment">	 * It is also possible to delete a user after all certificates have been revoked.</em>
<a class="jxr_linenumber" name="L641" href="#L641">641</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L642" href="#L642">642</a> <em class="jxr_javadoccomment">	 * If the request is proxied to another EJBCA instance, at least one revocation must succeed or the operation fails with the last exception thrown.</em>
<a class="jxr_linenumber" name="L643" href="#L643">643</a> <em class="jxr_javadoccomment">	 * </em>
<a class="jxr_linenumber" name="L644" href="#L644">644</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L645" href="#L645">645</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L646" href="#L646">646</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/revoke_end_entity</em>
<a class="jxr_linenumber" name="L647" href="#L647">647</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/revoke_end_entity</em>
<a class="jxr_linenumber" name="L648" href="#L648">648</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of users certificate&amp;gt;</em>
<a class="jxr_linenumber" name="L649" href="#L649">649</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L650" href="#L650">650</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L651" href="#L651">651</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the CA does not exist, the user could not be found, or its waiting for approval, approval was denied, is revoked </em>
<a class="jxr_linenumber" name="L652" href="#L652">652</a> <em class="jxr_javadoccomment">	 *    already or could not be deleted on the local system, then the request will be forwarded to upstream peer systems (if any).</em>
<a class="jxr_linenumber" name="L653" href="#L653">653</a> <em class="jxr_javadoccomment">	 *    The requested is processed on all instances available.&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L654" href="#L654">654</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L655" href="#L655">655</a> <em class="jxr_javadoccomment">	 * @param username unique username in EJBCA.</em>
<a class="jxr_linenumber" name="L656" href="#L656">656</a> <em class="jxr_javadoccomment">	 * @param reason for revocation, one of org.ejbca.core.protocol.ws.client.gen.RevokeStatus.REVOKATION_REASON_ constants</em>
<a class="jxr_linenumber" name="L657" href="#L657">657</a> <em class="jxr_javadoccomment">	 * or use @link org.ejbca.core.protocol.ws.client.gen.RevokeStatus.NOT_REVOKED to un-revoke a certificate on hold.</em>
<a class="jxr_linenumber" name="L658" href="#L658">658</a> <em class="jxr_javadoccomment">	 * @param deleteUser deletes the users after all the certificates have been revoked.</em>
<a class="jxr_linenumber" name="L659" href="#L659">659</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist.</em>
<a class="jxr_linenumber" name="L660" href="#L660">660</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized.</em>
<a class="jxr_linenumber" name="L661" href="#L661">661</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException if user doesn't exist.</em>
<a class="jxr_linenumber" name="L662" href="#L662">662</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException if request has bean added to list of tasks to be approved.</em>
<a class="jxr_linenumber" name="L663" href="#L663">663</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException if there already exists an approval request for this task.</em>
<a class="jxr_linenumber" name="L664" href="#L664">664</a> <em class="jxr_javadoccomment">	 * @throws AlreadyRevokedException if the user already was revoked.</em>
<a class="jxr_linenumber" name="L665" href="#L665">665</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException any EjbcaException.</em>
<a class="jxr_linenumber" name="L666" href="#L666">666</a> <em class="jxr_javadoccomment">	 * @see RevokeStatus</em>
<a class="jxr_linenumber" name="L667" href="#L667">667</a> <em class="jxr_javadoccomment">	 * @see "RaMasterApi#revokeUser(AuthenticationToken authenticationToken, String username, int reason, boolean deleteUser)"</em>
<a class="jxr_linenumber" name="L668" href="#L668">668</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L669" href="#L669">669</a> 	<strong class="jxr_keyword">void</strong> revokeUser(String username, <strong class="jxr_keyword">int</strong> reason,
<a class="jxr_linenumber" name="L670" href="#L670">670</a> 			<strong class="jxr_keyword">boolean</strong> deleteUser) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException,
<a class="jxr_linenumber" name="L671" href="#L671">671</a> 			NotFoundException, EjbcaException, ApprovalException,
<a class="jxr_linenumber" name="L672" href="#L672">672</a> 			WaitingForApprovalException, AlreadyRevokedException;
<a class="jxr_linenumber" name="L673" href="#L673">673</a> 
<a class="jxr_linenumber" name="L674" href="#L674">674</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L675" href="#L675">675</a> <em class="jxr_javadoccomment">	 * Marks the user's latest certificate for key recovery.</em>
<a class="jxr_linenumber" name="L676" href="#L676">676</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L677" href="#L677">677</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L678" href="#L678">678</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L679" href="#L679">679</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/keyrecovery</em>
<a class="jxr_linenumber" name="L680" href="#L680">680</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/keyrecovery</em>
<a class="jxr_linenumber" name="L681" href="#L681">681</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of users certificate&amp;gt;</em>
<a class="jxr_linenumber" name="L682" href="#L682">682</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L683" href="#L683">683</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L684" href="#L684">684</a> <em class="jxr_javadoccomment">	 * @param username unique username in EJBCA</em>
<a class="jxr_linenumber" name="L685" href="#L685">685</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L686" href="#L686">686</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized.</em>
<a class="jxr_linenumber" name="L687" href="#L687">687</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException if user doesn't exist</em>
<a class="jxr_linenumber" name="L688" href="#L688">688</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException if request has bean added to list of tasks to be approved</em>
<a class="jxr_linenumber" name="L689" href="#L689">689</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException if there already exists an approval request for this task</em>
<a class="jxr_linenumber" name="L690" href="#L690">690</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if there is a configuration or other error</em>
<a class="jxr_linenumber" name="L691" href="#L691">691</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L692" href="#L692">692</a> 	<strong class="jxr_keyword">void</strong> keyRecoverNewest(String username) <strong class="jxr_keyword">throws</strong>
<a class="jxr_linenumber" name="L693" href="#L693">693</a> 			CADoesntExistsException, AuthorizationDeniedException,
<a class="jxr_linenumber" name="L694" href="#L694">694</a> 			NotFoundException, EjbcaException, ApprovalException,
<a class="jxr_linenumber" name="L695" href="#L695">695</a> 			WaitingForApprovalException;
<a class="jxr_linenumber" name="L696" href="#L696">696</a> 
<a class="jxr_linenumber" name="L697" href="#L697">697</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L698" href="#L698">698</a> <em class="jxr_javadoccomment">     * Marks a user's certificate for key recovery.</em>
<a class="jxr_linenumber" name="L699" href="#L699">699</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L700" href="#L700">700</a> <em class="jxr_javadoccomment">     * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L701" href="#L701">701</a> <em class="jxr_javadoccomment">     * - /administrator</em>
<a class="jxr_linenumber" name="L702" href="#L702">702</a> <em class="jxr_javadoccomment">     * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/keyrecovery</em>
<a class="jxr_linenumber" name="L703" href="#L703">703</a> <em class="jxr_javadoccomment">     * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_end_entity</em>
<a class="jxr_linenumber" name="L704" href="#L704">704</a> <em class="jxr_javadoccomment">     * - /ca/&amp;lt;ca of users certificate&amp;gt;</em>
<a class="jxr_linenumber" name="L705" href="#L705">705</a> <em class="jxr_javadoccomment">     * - /ca_functionality/view_certificate</em>
<a class="jxr_linenumber" name="L706" href="#L706">706</a> <em class="jxr_javadoccomment">     * - /ra_functionality/keyrecovery</em>
<a class="jxr_linenumber" name="L707" href="#L707">707</a> <em class="jxr_javadoccomment">     * - /ra_functionality/view_end_entity</em>
<a class="jxr_linenumber" name="L708" href="#L708">708</a> <em class="jxr_javadoccomment">     * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L709" href="#L709">709</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L710" href="#L710">710</a> <em class="jxr_javadoccomment">     * @param username unique username in EJBCA</em>
<a class="jxr_linenumber" name="L711" href="#L711">711</a> <em class="jxr_javadoccomment">     * @param certSNinHex unique certificate serialnumber in EJBCA, hex encoded</em>
<a class="jxr_linenumber" name="L712" href="#L712">712</a> <em class="jxr_javadoccomment">     * @param issuerDN DN of CA, in EJBCA, that issued the certificate</em>
<a class="jxr_linenumber" name="L713" href="#L713">713</a> <em class="jxr_javadoccomment">     * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L714" href="#L714">714</a> <em class="jxr_javadoccomment">     * @throws AuthorizationDeniedException if client isn't authorized.</em>
<a class="jxr_linenumber" name="L715" href="#L715">715</a> <em class="jxr_javadoccomment">     * @throws NotFoundException if user doesn't exist</em>
<a class="jxr_linenumber" name="L716" href="#L716">716</a> <em class="jxr_javadoccomment">     * @throws WaitingForApprovalException if request has bean added to list of tasks to be approved</em>
<a class="jxr_linenumber" name="L717" href="#L717">717</a> <em class="jxr_javadoccomment">     * @throws ApprovalException if there already exists an approval request for this task</em>
<a class="jxr_linenumber" name="L718" href="#L718">718</a> <em class="jxr_javadoccomment">     * @throws EjbcaException if there is a configuration or other error</em>
<a class="jxr_linenumber" name="L719" href="#L719">719</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L720" href="#L720">720</a>     <strong class="jxr_keyword">void</strong> keyRecover(String username, String certSNinHex, String issuerDN) <strong class="jxr_keyword">throws</strong>
<a class="jxr_linenumber" name="L721" href="#L721">721</a>             CADoesntExistsException, AuthorizationDeniedException,
<a class="jxr_linenumber" name="L722" href="#L722">722</a>             NotFoundException, EjbcaException, ApprovalException,
<a class="jxr_linenumber" name="L723" href="#L723">723</a>             WaitingForApprovalException;
<a class="jxr_linenumber" name="L724" href="#L724">724</a> 
<a class="jxr_linenumber" name="L725" href="#L725">725</a>     <em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L726" href="#L726">726</a> <em class="jxr_javadoccomment">     * Key recovers specified certificate and generates a new keystore in one</em>
<a class="jxr_linenumber" name="L727" href="#L727">727</a> <em class="jxr_javadoccomment">     * atomic operation.</em>
<a class="jxr_linenumber" name="L728" href="#L728">728</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L729" href="#L729">729</a> <em class="jxr_javadoccomment">     * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L730" href="#L730">730</a> <em class="jxr_javadoccomment">     * - /administrator</em>
<a class="jxr_linenumber" name="L731" href="#L731">731</a> <em class="jxr_javadoccomment">     * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/keyrecovery</em>
<a class="jxr_linenumber" name="L732" href="#L732">732</a> <em class="jxr_javadoccomment">     * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_end_entity</em>
<a class="jxr_linenumber" name="L733" href="#L733">733</a> <em class="jxr_javadoccomment">     * - /ca/&amp;lt;ca of users certificate&amp;gt;</em>
<a class="jxr_linenumber" name="L734" href="#L734">734</a> <em class="jxr_javadoccomment">     * - /ca_functionality/view_certificate</em>
<a class="jxr_linenumber" name="L735" href="#L735">735</a> <em class="jxr_javadoccomment">     * - /ca_functionality/create_certificate</em>
<a class="jxr_linenumber" name="L736" href="#L736">736</a> <em class="jxr_javadoccomment">     * - /ra_functionality/view_end_entity</em>
<a class="jxr_linenumber" name="L737" href="#L737">737</a> <em class="jxr_javadoccomment">     * - /ra_functionality/keyrecovery</em>
<a class="jxr_linenumber" name="L738" href="#L738">738</a> <em class="jxr_javadoccomment">     * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L739" href="#L739">739</a> <em class="jxr_javadoccomment">     * @param username unique username (end entity) in EJBCA</em>
<a class="jxr_linenumber" name="L740" href="#L740">740</a> <em class="jxr_javadoccomment">     * @param certSNinHex unique certificate serialnumber in EJBCA, hex encoded</em>
<a class="jxr_linenumber" name="L741" href="#L741">741</a> <em class="jxr_javadoccomment">     * @param issuerDN DN of CA, in EJBCA, that issued the certificate</em>
<a class="jxr_linenumber" name="L742" href="#L742">742</a> <em class="jxr_javadoccomment">     * @param password new password</em>
<a class="jxr_linenumber" name="L743" href="#L743">743</a> <em class="jxr_javadoccomment">     * @param hardTokenSN If the certificate should be connected with a hardtoken, it is</em>
<a class="jxr_linenumber" name="L744" href="#L744">744</a> <em class="jxr_javadoccomment">     * possible to map it by give the hardTokenSN here, this will simplify revocation of a token</em>
<a class="jxr_linenumber" name="L745" href="#L745">745</a> <em class="jxr_javadoccomment">     * certificates. Use null if no hardtokenSN should be associated with the certificate.</em>
<a class="jxr_linenumber" name="L746" href="#L746">746</a> <em class="jxr_javadoccomment">     * @return the generated keystore</em>
<a class="jxr_linenumber" name="L747" href="#L747">747</a> <em class="jxr_javadoccomment">     * @throws AuthorizationDeniedException if the requesting administrator is unauthorized to perform this operation</em>
<a class="jxr_linenumber" name="L748" href="#L748">748</a> <em class="jxr_javadoccomment">     * @throws CADoesntExistsException referenced CA cannot be found in any EJBCA instance</em>
<a class="jxr_linenumber" name="L749" href="#L749">749</a> <em class="jxr_javadoccomment">     * @throws WaitingForApprovalException request has bean added to list of tasks to be approved</em>
<a class="jxr_linenumber" name="L750" href="#L750">750</a> <em class="jxr_javadoccomment">     * @throws EjbcaException other exceptions</em>
<a class="jxr_linenumber" name="L751" href="#L751">751</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L752" href="#L752">752</a>     <a name="KeyStore" href="../../../../../../org/ejbca/core/protocol/ws/objects/KeyStore.html#KeyStore">KeyStore</a> keyRecoverEnroll(String username, String certSNinHex, String issuerDN, String password, String hardTokenSN)
<a class="jxr_linenumber" name="L753" href="#L753">753</a>             <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, EjbcaException, CADoesntExistsException, WaitingForApprovalException;
<a class="jxr_linenumber" name="L754" href="#L754">754</a> 
<a class="jxr_linenumber" name="L755" href="#L755">755</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L756" href="#L756">756</a> <em class="jxr_javadoccomment">	 * Revokes all certificates mapped to a hardtoken.</em>
<a class="jxr_linenumber" name="L757" href="#L757">757</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L758" href="#L758">758</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L759" href="#L759">759</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L760" href="#L760">760</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/revoke_end_entity</em>
<a class="jxr_linenumber" name="L761" href="#L761">761</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile of the user owning the token&amp;gt;/revoke_end_entity</em>
<a class="jxr_linenumber" name="L762" href="#L762">762</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of certificates on token&amp;gt;</em>
<a class="jxr_linenumber" name="L763" href="#L763">763</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L764" href="#L764">764</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L765" href="#L765">765</a> <em class="jxr_javadoccomment">	 * @param hardTokenSN of the hardTokenSN</em>
<a class="jxr_linenumber" name="L766" href="#L766">766</a> <em class="jxr_javadoccomment">	 * @param reason for revocation, one of  org.ejbca.core.protocol.ws.client.gen.RevokeStatus.REVOKATION_REASON_ constants</em>
<a class="jxr_linenumber" name="L767" href="#L767">767</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L768" href="#L768">768</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized.</em>
<a class="jxr_linenumber" name="L769" href="#L769">769</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException if token doesn't exist</em>
<a class="jxr_linenumber" name="L770" href="#L770">770</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException If request has bean added to list of tasks to be approved</em>
<a class="jxr_linenumber" name="L771" href="#L771">771</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException There already exists an approval request for this task</em>
<a class="jxr_linenumber" name="L772" href="#L772">772</a> <em class="jxr_javadoccomment">	 * @throws AlreadyRevokedException The token was already revoked.</em>
<a class="jxr_linenumber" name="L773" href="#L773">773</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L774" href="#L774">774</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L775" href="#L775">775</a> 	<strong class="jxr_keyword">void</strong> revokeToken(String hardTokenSN, <strong class="jxr_keyword">int</strong> reason)
<a class="jxr_linenumber" name="L776" href="#L776">776</a> 			<strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException,
<a class="jxr_linenumber" name="L777" href="#L777">777</a> 			NotFoundException, EjbcaException, ApprovalException,
<a class="jxr_linenumber" name="L778" href="#L778">778</a> 			WaitingForApprovalException, AlreadyRevokedException;
<a class="jxr_linenumber" name="L779" href="#L779">779</a> 
<a class="jxr_linenumber" name="L780" href="#L780">780</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L781" href="#L781">781</a> <em class="jxr_javadoccomment">	 * Returns revocation status for given user.</em>
<a class="jxr_linenumber" name="L782" href="#L782">782</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L783" href="#L783">783</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L784" href="#L784">784</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L785" href="#L785">785</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of certificate&amp;gt;</em>
<a class="jxr_linenumber" name="L786" href="#L786">786</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L787" href="#L787">787</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L788" href="#L788">788</a> <em class="jxr_javadoccomment">	 * @param issuerDN DN</em>
<a class="jxr_linenumber" name="L789" href="#L789">789</a> <em class="jxr_javadoccomment">	 * @param certificateSN a hexa decimal string</em>
<a class="jxr_linenumber" name="L790" href="#L790">790</a> <em class="jxr_javadoccomment">	 * @return the revocation status or null if certificate does not exist.</em>
<a class="jxr_linenumber" name="L791" href="#L791">791</a> <em class="jxr_javadoccomment">	 *         For CAs in throw-away mode and with the option "accept revocation of</em>
<a class="jxr_linenumber" name="L792" href="#L792">792</a> <em class="jxr_javadoccomment">	 *         non-existing entries", this function returns OK for non-existing entries.</em>
<a class="jxr_linenumber" name="L793" href="#L793">793</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L794" href="#L794">794</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized.</em>
<a class="jxr_linenumber" name="L795" href="#L795">795</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException FAil</em>
<a class="jxr_linenumber" name="L796" href="#L796">796</a> <em class="jxr_javadoccomment">	 * @see RevokeStatus</em>
<a class="jxr_linenumber" name="L797" href="#L797">797</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L798" href="#L798">798</a> 	RevokeStatus checkRevokationStatus(String issuerDN,
<a class="jxr_linenumber" name="L799" href="#L799">799</a> 			String certificateSN) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException,
<a class="jxr_linenumber" name="L800" href="#L800">800</a> 			EjbcaException;
<a class="jxr_linenumber" name="L801" href="#L801">801</a> 
<a class="jxr_linenumber" name="L802" href="#L802">802</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L803" href="#L803">803</a> <em class="jxr_javadoccomment">	 * Checks if a user is authorized to a given resource.</em>
<a class="jxr_linenumber" name="L804" href="#L804">804</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L805" href="#L805">805</a> <em class="jxr_javadoccomment">	 * Authorization requirements: a valid client certificate</em>
<a class="jxr_linenumber" name="L806" href="#L806">806</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L807" href="#L807">807</a> <em class="jxr_javadoccomment">	 * &lt;p&gt; This request will be process locally and is forwarded upstream peer systems (if any) </em>
<a class="jxr_linenumber" name="L808" href="#L808">808</a> <em class="jxr_javadoccomment">	 *     until an instance with an active CA was found there the authorization can be verified. &lt;/p&gt;</em>
<a class="jxr_linenumber" name="L809" href="#L809">809</a> <em class="jxr_javadoccomment">     * </em>
<a class="jxr_linenumber" name="L810" href="#L810">810</a> <em class="jxr_javadoccomment">	 * @param resource the access rule to test</em>
<a class="jxr_linenumber" name="L811" href="#L811">811</a> <em class="jxr_javadoccomment">	 * @return true if the user is authorized to the resource otherwise false.</em>
<a class="jxr_linenumber" name="L812" href="#L812">812</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L813" href="#L813">813</a> <em class="jxr_javadoccomment">	 * @see RevokeStatus</em>
<a class="jxr_linenumber" name="L814" href="#L814">814</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L815" href="#L815">815</a> 	<strong class="jxr_keyword">boolean</strong> isAuthorized(String resource) <strong class="jxr_keyword">throws</strong> EjbcaException;
<a class="jxr_linenumber" name="L816" href="#L816">816</a> 
<a class="jxr_linenumber" name="L817" href="#L817">817</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L818" href="#L818">818</a> <em class="jxr_javadoccomment">	 * Fetches userdata from an existing UserDataSource.</em>
<a class="jxr_linenumber" name="L819" href="#L819">819</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L820" href="#L820">820</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L821" href="#L821">821</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L822" href="#L822">822</a> <em class="jxr_javadoccomment">	 * - /userdatasourcesrules/&amp;lt;user data source&amp;gt;/fetch_userdata (for all the given user data sources)</em>
<a class="jxr_linenumber" name="L823" href="#L823">823</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;all cas defined in all the user data sources&amp;gt;</em>
<a class="jxr_linenumber" name="L824" href="#L824">824</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L825" href="#L825">825</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L826" href="#L826">826</a> <em class="jxr_javadoccomment">	 * If not turned of in jaxws.properties then only a valid certificate required</em>
<a class="jxr_linenumber" name="L827" href="#L827">827</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L828" href="#L828">828</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L829" href="#L829">829</a> <em class="jxr_javadoccomment">	 * @param userDataSourceNames a List of User Data Source Names</em>
<a class="jxr_linenumber" name="L830" href="#L830">830</a> <em class="jxr_javadoccomment">	 * @param searchString to identify the userdata.</em>
<a class="jxr_linenumber" name="L831" href="#L831">831</a> <em class="jxr_javadoccomment">	 * @return a List of UserDataSourceVOWS of the data in the specified UserDataSources, if no user data is found will an empty list be returned.</em>
<a class="jxr_linenumber" name="L832" href="#L832">832</a> <em class="jxr_javadoccomment">	 * @throws UserDataSourceException if an error occurred connecting to one of UserDataSources</em>
<a class="jxr_linenumber" name="L833" href="#L833">833</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException FAil</em>
<a class="jxr_linenumber" name="L834" href="#L834">834</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L835" href="#L835">835</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L836" href="#L836">836</a> 	List&lt;UserDataSourceVOWS&gt; fetchUserData(
<a class="jxr_linenumber" name="L837" href="#L837">837</a> 			List&lt;String&gt; userDataSourceNames, String searchString)
<a class="jxr_linenumber" name="L838" href="#L838">838</a> 			<strong class="jxr_keyword">throws</strong> UserDataSourceException, EjbcaException, AuthorizationDeniedException;
<a class="jxr_linenumber" name="L839" href="#L839">839</a> 
<a class="jxr_linenumber" name="L840" href="#L840">840</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L841" href="#L841">841</a> <em class="jxr_javadoccomment">	 * Adds certificates and/or data to a hardtoken.</em>
<a class="jxr_linenumber" name="L842" href="#L842">842</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L843" href="#L843">843</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L844" href="#L844">844</a> <em class="jxr_javadoccomment">	 * If the caller is an administrator</em>
<a class="jxr_linenumber" name="L845" href="#L845">845</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L846" href="#L846">846</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/create_end_entity and/or edit_end_entity</em>
<a class="jxr_linenumber" name="L847" href="#L847">847</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/create_end_entity and/or edit_end_entity</em>
<a class="jxr_linenumber" name="L848" href="#L848">848</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/revoke_end_entity (if overwrite flag is set)</em>
<a class="jxr_linenumber" name="L849" href="#L849">849</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/revoke_end_entity (if overwrite flag is set)</em>
<a class="jxr_linenumber" name="L850" href="#L850">850</a> <em class="jxr_javadoccomment">	 * - /ca_functionality/create_certificate</em>
<a class="jxr_linenumber" name="L851" href="#L851">851</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of all requested certificates&amp;gt;</em>
<a class="jxr_linenumber" name="L852" href="#L852">852</a> <em class="jxr_javadoccomment">	 * - /hardtoken_functionality/issue_hardtokens</em>
<a class="jxr_linenumber" name="L853" href="#L853">853</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L854" href="#L854">854</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L855" href="#L855">855</a> <em class="jxr_javadoccomment">	 * If the user isn't an administrator the request will be added to a queue for approval.</em>
<a class="jxr_linenumber" name="L856" href="#L856">856</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L857" href="#L857">857</a> <em class="jxr_javadoccomment">	 * @param userData of the user that should be generated</em>
<a class="jxr_linenumber" name="L858" href="#L858">858</a> <em class="jxr_javadoccomment">	 * @param tokenRequests a list of certificate requests</em>
<a class="jxr_linenumber" name="L859" href="#L859">859</a> <em class="jxr_javadoccomment">	 * @param hardTokenData data containing PIN/PUK info</em>
<a class="jxr_linenumber" name="L860" href="#L860">860</a> <em class="jxr_javadoccomment">	 * @param overwriteExistingSN if the the current hardtoken should be overwritten instead of throwing HardTokenExists exception.</em>
<a class="jxr_linenumber" name="L861" href="#L861">861</a> <em class="jxr_javadoccomment">	 * If a card is overwritten, all previous certificates on the card is revoked.</em>
<a class="jxr_linenumber" name="L862" href="#L862">862</a> <em class="jxr_javadoccomment">	 * @param revokePreviousCards tells the service to revoke old cards issued to this user. If the present card have the label TEMPORARY_CARD</em>
<a class="jxr_linenumber" name="L863" href="#L863">863</a> <em class="jxr_javadoccomment">	 * old cards is set to CERTIFICATE_ONHOLD otherwise UNSPECIFIED.</em>
<a class="jxr_linenumber" name="L864" href="#L864">864</a> <em class="jxr_javadoccomment">	 * @return a List of the generated certificates.</em>
<a class="jxr_linenumber" name="L865" href="#L865">865</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L866" href="#L866">866</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if the administrator isn't authorized.</em>
<a class="jxr_linenumber" name="L867" href="#L867">867</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException if the caller is a non-admin a must be approved before it is executed.</em>
<a class="jxr_linenumber" name="L868" href="#L868">868</a> <em class="jxr_javadoccomment">	 * @throws HardTokenExistsException if the given hardtoken serial number already exists.</em>
<a class="jxr_linenumber" name="L869" href="#L869">869</a> <em class="jxr_javadoccomment">	 * @throws ApprovalRequestExpiredException if the request for approval have expired.</em>
<a class="jxr_linenumber" name="L870" href="#L870">870</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException  if error happened with the approval mechanisms</em>
<a class="jxr_linenumber" name="L871" href="#L871">871</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException if the request haven't been processed yet.</em>
<a class="jxr_linenumber" name="L872" href="#L872">872</a> <em class="jxr_javadoccomment">	 * @throws ApprovalRequestExecutionException if the approval request was rejected</em>
<a class="jxr_linenumber" name="L873" href="#L873">873</a> <em class="jxr_javadoccomment">	 * @throws UserDoesntFullfillEndEntityProfile Fail</em>
<a class="jxr_linenumber" name="L874" href="#L874">874</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException Fail</em>
<a class="jxr_linenumber" name="L875" href="#L875">875</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L876" href="#L876">876</a>     @SuppressWarnings(<span class="jxr_string">"javadoc"</span>)
<a class="jxr_linenumber" name="L877" href="#L877">877</a> 	List&lt;TokenCertificateResponseWS&gt; genTokenCertificates(
<a class="jxr_linenumber" name="L878" href="#L878">878</a> 			UserDataVOWS userData,
<a class="jxr_linenumber" name="L879" href="#L879">879</a> 			List&lt;TokenCertificateRequestWS&gt; tokenRequests,
<a class="jxr_linenumber" name="L880" href="#L880">880</a> 			HardTokenDataWS hardTokenData,
<a class="jxr_linenumber" name="L881" href="#L881">881</a> 			<strong class="jxr_keyword">boolean</strong> overwriteExistingSN,
<a class="jxr_linenumber" name="L882" href="#L882">882</a> 			<strong class="jxr_keyword">boolean</strong> revokePreviousCards) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException,
<a class="jxr_linenumber" name="L883" href="#L883">883</a> 			WaitingForApprovalException, HardTokenExistsException,
<a class="jxr_linenumber" name="L884" href="#L884">884</a> 			UserDoesntFullfillEndEntityProfile, ApprovalException,
<a class="jxr_linenumber" name="L885" href="#L885">885</a> 			EjbcaException, ApprovalRequestExpiredException, ApprovalRequestExecutionException;
<a class="jxr_linenumber" name="L886" href="#L886">886</a> 
<a class="jxr_linenumber" name="L887" href="#L887">887</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L888" href="#L888">888</a> <em class="jxr_javadoccomment">	 * Looks up if a serial number already have been generated.</em>
<a class="jxr_linenumber" name="L889" href="#L889">889</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L890" href="#L890">890</a> <em class="jxr_javadoccomment">	 * Authorization requirements: A valid certificate</em>
<a class="jxr_linenumber" name="L891" href="#L891">891</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L892" href="#L892">892</a> <em class="jxr_javadoccomment">	 * @param hardTokenSN the serial number of the token to look for.</em>
<a class="jxr_linenumber" name="L893" href="#L893">893</a> <em class="jxr_javadoccomment">	 * @return true if hard token exists</em>
<a class="jxr_linenumber" name="L894" href="#L894">894</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if error occurred server side</em>
<a class="jxr_linenumber" name="L895" href="#L895">895</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L896" href="#L896">896</a> 	<strong class="jxr_keyword">boolean</strong> existsHardToken(String hardTokenSN)
<a class="jxr_linenumber" name="L897" href="#L897">897</a> 			<strong class="jxr_keyword">throws</strong> EjbcaException;
<a class="jxr_linenumber" name="L898" href="#L898">898</a> 
<a class="jxr_linenumber" name="L899" href="#L899">899</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L900" href="#L900">900</a> <em class="jxr_javadoccomment">	 * Fetches information about a hard token.</em>
<a class="jxr_linenumber" name="L901" href="#L901">901</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L902" href="#L902">902</a> <em class="jxr_javadoccomment">	 * If the caller is an administrator&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L903" href="#L903">903</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L904" href="#L904">904</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/view_hardtoken</em>
<a class="jxr_linenumber" name="L905" href="#L905">905</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_hardtoken</em>
<a class="jxr_linenumber" name="L906" href="#L906">906</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_hardtoken/puk_data (if viewPUKData = true)</em>
<a class="jxr_linenumber" name="L907" href="#L907">907</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L908" href="#L908">908</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L909" href="#L909">909</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L910" href="#L910">910</a> <em class="jxr_javadoccomment">	 * If the user isn't an administrator the request will be added to a queue for approval.</em>
<a class="jxr_linenumber" name="L911" href="#L911">911</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L912" href="#L912">912</a> <em class="jxr_javadoccomment">	 * @param hardTokenSN of the token to look for.</em>
<a class="jxr_linenumber" name="L913" href="#L913">913</a> <em class="jxr_javadoccomment">	 * @param viewPUKData if PUK data of the hard token should be returned.</em>
<a class="jxr_linenumber" name="L914" href="#L914">914</a> <em class="jxr_javadoccomment">	 * @param onlyValidCertificates of all revoked and expired certificates should be filtered.</em>
<a class="jxr_linenumber" name="L915" href="#L915">915</a> <em class="jxr_javadoccomment">	 * @return the HardTokenData</em>
<a class="jxr_linenumber" name="L916" href="#L916">916</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L917" href="#L917">917</a> <em class="jxr_javadoccomment">	 * @throws HardTokenDoesntExistsException if the hardtokensn don't exist in database.</em>
<a class="jxr_linenumber" name="L918" href="#L918">918</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException if user for wich the hard token is registered does not exist</em>
<a class="jxr_linenumber" name="L919" href="#L919">919</a> <em class="jxr_javadoccomment">	 * @throws ApprovalRequestExpiredException if the request for approval have expired.</em>
<a class="jxr_linenumber" name="L920" href="#L920">920</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException  if error happened with the approval mechanisms</em>
<a class="jxr_linenumber" name="L921" href="#L921">921</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException if the request haven't been processed yet.</em>
<a class="jxr_linenumber" name="L922" href="#L922">922</a> <em class="jxr_javadoccomment">	 * @throws ApprovalRequestExecutionException if the approval request was rejected</em>
<a class="jxr_linenumber" name="L923" href="#L923">923</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException Fail</em>
<a class="jxr_linenumber" name="L924" href="#L924">924</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if an exception occurred on server side.</em>
<a class="jxr_linenumber" name="L925" href="#L925">925</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L926" href="#L926">926</a> 	HardTokenDataWS getHardTokenData(String hardTokenSN, <strong class="jxr_keyword">boolean</strong> viewPUKData, <strong class="jxr_keyword">boolean</strong> onlyValidCertificates)
<a class="jxr_linenumber" name="L927" href="#L927">927</a> 			<strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException,
<a class="jxr_linenumber" name="L928" href="#L928">928</a> 			HardTokenDoesntExistsException, NotFoundException, ApprovalException, ApprovalRequestExpiredException, WaitingForApprovalException, ApprovalRequestExecutionException, EjbcaException;
<a class="jxr_linenumber" name="L929" href="#L929">929</a> 
<a class="jxr_linenumber" name="L930" href="#L930">930</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L931" href="#L931">931</a> <em class="jxr_javadoccomment">	 * Fetches all hard tokens for a given user.</em>
<a class="jxr_linenumber" name="L932" href="#L932">932</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L933" href="#L933">933</a> <em class="jxr_javadoccomment">	 * If the caller is an administrator&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L934" href="#L934">934</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L935" href="#L935">935</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/view_hardtoken</em>
<a class="jxr_linenumber" name="L936" href="#L936">936</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_hardtoken</em>
<a class="jxr_linenumber" name="L937" href="#L937">937</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_hardtoken/puk_data (if viewPUKData = true)</em>
<a class="jxr_linenumber" name="L938" href="#L938">938</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L939" href="#L939">939</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L940" href="#L940">940</a> <em class="jxr_javadoccomment">	 * @param username to look for.</em>
<a class="jxr_linenumber" name="L941" href="#L941">941</a> <em class="jxr_javadoccomment">	 * @param viewPUKData if PUK data of the hard token should be returned.</em>
<a class="jxr_linenumber" name="L942" href="#L942">942</a> <em class="jxr_javadoccomment">	 * @param onlyValidCertificates of all revoked and expired certificates should be filtered.</em>
<a class="jxr_linenumber" name="L943" href="#L943">943</a> <em class="jxr_javadoccomment">	 * @return a list of the HardTokenData generated for the user never null.</em>
<a class="jxr_linenumber" name="L944" href="#L944">944</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if an exception occurred on server side.</em>
<a class="jxr_linenumber" name="L945" href="#L945">945</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException fail</em>
<a class="jxr_linenumber" name="L946" href="#L946">946</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException fail</em>
<a class="jxr_linenumber" name="L947" href="#L947">947</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L948" href="#L948">948</a> 	List&lt;HardTokenDataWS&gt; getHardTokenDatas(String username, <strong class="jxr_keyword">boolean</strong> viewPUKData, <strong class="jxr_keyword">boolean</strong> onlyValidCertificates)
<a class="jxr_linenumber" name="L949" href="#L949">949</a> 			<strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, EjbcaException;
<a class="jxr_linenumber" name="L950" href="#L950">950</a> 
<a class="jxr_linenumber" name="L951" href="#L951">951</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L952" href="#L952">952</a> <em class="jxr_javadoccomment">	 * Republishes a selected certificate.</em>
<a class="jxr_linenumber" name="L953" href="#L953">953</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L954" href="#L954">954</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L955" href="#L955">955</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L956" href="#L956">956</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/view_end_entity</em>
<a class="jxr_linenumber" name="L957" href="#L957">957</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_end_entity</em>
<a class="jxr_linenumber" name="L958" href="#L958">958</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L959" href="#L959">959</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L960" href="#L960">960</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L961" href="#L961">961</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the CA does not exist on the local system, then the request will be forwarded </em>
<a class="jxr_linenumber" name="L962" href="#L962">962</a> <em class="jxr_javadoccomment">	 *    to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L963" href="#L963">963</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L964" href="#L964">964</a> <em class="jxr_javadoccomment">	 * @param serialNumberInHex of the certificate to republish</em>
<a class="jxr_linenumber" name="L965" href="#L965">965</a> <em class="jxr_javadoccomment">	 * @param issuerDN of the certificate to republish</em>
<a class="jxr_linenumber" name="L966" href="#L966">966</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L967" href="#L967">967</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if the administrator isn't authorized to republish</em>
<a class="jxr_linenumber" name="L968" href="#L968">968</a> <em class="jxr_javadoccomment">	 * @throws PublisherException if something went wrong during publication</em>
<a class="jxr_linenumber" name="L969" href="#L969">969</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if other error occured on the server side.</em>
<a class="jxr_linenumber" name="L970" href="#L970">970</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L971" href="#L971">971</a> 	<strong class="jxr_keyword">void</strong> republishCertificate(String serialNumberInHex,
<a class="jxr_linenumber" name="L972" href="#L972">972</a> 			String issuerDN) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException,
<a class="jxr_linenumber" name="L973" href="#L973">973</a> 			PublisherException, EjbcaException;
<a class="jxr_linenumber" name="L974" href="#L974">974</a> 
<a class="jxr_linenumber" name="L975" href="#L975">975</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L976" href="#L976">976</a> <em class="jxr_javadoccomment">     * Looks up if a requested action has been approved. &lt;b&gt;Note:&lt;/b&gt; This method uses the "approvalId" hash to identify the approval.</em>
<a class="jxr_linenumber" name="L977" href="#L977">977</a> <em class="jxr_javadoccomment">     * The hash is generated by {@link org.ejbca.core.model.approval.ApprovalRequest#generateApprovalId() ApprovalRequest.generateApprovalId()},</em>
<a class="jxr_linenumber" name="L978" href="#L978">978</a> <em class="jxr_javadoccomment">     * which is implemented in each of the ApprovalRequest sub classes. It is the same for identical approval requests, so you can create an</em>
<a class="jxr_linenumber" name="L979" href="#L979">979</a> <em class="jxr_javadoccomment">     * ApprovalRequest object with the same parameters and call the generateApprovalId method to obtain the approvalId hash.</em>
<a class="jxr_linenumber" name="L980" href="#L980">980</a> <em class="jxr_javadoccomment">     * &lt;p&gt;</em>
<a class="jxr_linenumber" name="L981" href="#L981">981</a> <em class="jxr_javadoccomment">     * If you have a requestId, please use {@link #getRemainingNumberOfApprovals} instead.</em>
<a class="jxr_linenumber" name="L982" href="#L982">982</a> <em class="jxr_javadoccomment">     * &lt;p&gt;</em>
<a class="jxr_linenumber" name="L983" href="#L983">983</a> <em class="jxr_javadoccomment">	 * Authorization requirements: A valid certificate</em>
<a class="jxr_linenumber" name="L984" href="#L984">984</a> <em class="jxr_javadoccomment">     * &lt;p&gt;</em>
<a class="jxr_linenumber" name="L985" href="#L985">985</a> <em class="jxr_javadoccomment">     * If an approval was found but it is pending or suspended on the local system, </em>
<a class="jxr_linenumber" name="L986" href="#L986">986</a> <em class="jxr_javadoccomment">     * then the request will be forwarded to upstream peer systems (if any).</em>
<a class="jxr_linenumber" name="L987" href="#L987">987</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L988" href="#L988">988</a> <em class="jxr_javadoccomment">     * @param approvalId unique hash for the action, generated by ApprovalRequest.generateApprovalId(). Note that this is &lt;b&gt;not&lt;/b&gt; the same as requestId. Please use {@link #getRemainingNumberOfApprovals} if you have a requestId. </em>
<a class="jxr_linenumber" name="L989" href="#L989">989</a> <em class="jxr_javadoccomment">	 * @return the number of approvals left, 0 if approved otherwise is the ApprovalDataVO.STATUS constants returned indicating the status. If the request was proxied to a CA instance, and the request fails for technical reasons -9 is returned.</em>
<a class="jxr_linenumber" name="L990" href="#L990">990</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException if approvalId does not exist</em>
<a class="jxr_linenumber" name="L991" href="#L991">991</a> <em class="jxr_javadoccomment">	 * @throws ApprovalRequestExpiredException Throws this exception one time if one of the approvals have expired, once notified it won't throw it anymore.</em>
<a class="jxr_linenumber" name="L992" href="#L992">992</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if error occurred server side</em>
<a class="jxr_linenumber" name="L993" href="#L993">993</a> <em class="jxr_javadoccomment">     * @see #getRemainingNumberOfApprovals</em>
<a class="jxr_linenumber" name="L994" href="#L994">994</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L995" href="#L995">995</a> 	<strong class="jxr_keyword">int</strong> isApproved(<strong class="jxr_keyword">int</strong> approvalId) <strong class="jxr_keyword">throws</strong> ApprovalException,
<a class="jxr_linenumber" name="L996" href="#L996">996</a> 			EjbcaException, ApprovalRequestExpiredException;
<a class="jxr_linenumber" name="L997" href="#L997">997</a> 
<a class="jxr_linenumber" name="L998" href="#L998">998</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L999" href="#L999">999</a> <em class="jxr_javadoccomment">     * Returns the number of remaining approvals.</em>
<a class="jxr_linenumber" name="L1000" href="#L1000">1000</a> <em class="jxr_javadoccomment">     * &lt;p&gt;</em>
<a class="jxr_linenumber" name="L1001" href="#L1001">1001</a> <em class="jxr_javadoccomment">     * If an approval was found but it is pending or suspended on the local system, </em>
<a class="jxr_linenumber" name="L1002" href="#L1002">1002</a> <em class="jxr_javadoccomment">     * then the request will be forwarded to upstream peer systems (if any).</em>
<a class="jxr_linenumber" name="L1003" href="#L1003">1003</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1004" href="#L1004">1004</a> <em class="jxr_javadoccomment">     * @param requestId the ID of an approval request. This value can be obtained from {@link WaitingForApprovalException#getRequestId}</em>
<a class="jxr_linenumber" name="L1005" href="#L1005">1005</a> <em class="jxr_javadoccomment">     * @return the remaining number of approvals for this request (with 0 meaning that the request has passed) or -1 if the request has been denied. If the request was proxied to a CA instance, and the request fails for technical reasons -9 is returned.</em>
<a class="jxr_linenumber" name="L1006" href="#L1006">1006</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException if a request of the given ID didn't exist</em>
<a class="jxr_linenumber" name="L1007" href="#L1007">1007</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if the current requester wasn't authorized.</em>
<a class="jxr_linenumber" name="L1008" href="#L1008">1008</a> <em class="jxr_javadoccomment">     * @throws ApprovalRequestExpiredException if approval request was expired before having a definite status</em>
<a class="jxr_linenumber" name="L1009" href="#L1009">1009</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1010" href="#L1010">1010</a> 	<strong class="jxr_keyword">int</strong> getRemainingNumberOfApprovals(<strong class="jxr_keyword">int</strong> requestId) <strong class="jxr_keyword">throws</strong> ApprovalException, AuthorizationDeniedException, ApprovalRequestExpiredException;
<a class="jxr_linenumber" name="L1011" href="#L1011">1011</a> 
<a class="jxr_linenumber" name="L1012" href="#L1012">1012</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1013" href="#L1013">1013</a> <em class="jxr_javadoccomment">	 * Generates a Custom Log event in the database. In a setup with connected peer systems,</em>
<a class="jxr_linenumber" name="L1014" href="#L1014">1014</a> <em class="jxr_javadoccomment">	 * the log entry is written at the first peer where the CA exists, starting with remote systems,</em>
<a class="jxr_linenumber" name="L1015" href="#L1015">1015</a> <em class="jxr_javadoccomment">	 * then the local system.</em>
<a class="jxr_linenumber" name="L1016" href="#L1016">1016</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1017" href="#L1017">1017</a> <em class="jxr_javadoccomment">	 * Authorization requirements: &lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1018" href="#L1018">1018</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L1019" href="#L1019">1019</a> <em class="jxr_javadoccomment">	 * - /secureaudit/log_custom_events (must be configured in advanced mode when editing access rules)</em>
<a class="jxr_linenumber" name="L1020" href="#L1020">1020</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1021" href="#L1021">1021</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1022" href="#L1022">1022</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the CA does not exist or authorization was denied on the local system, then the request will </em>
<a class="jxr_linenumber" name="L1023" href="#L1023">1023</a> <em class="jxr_javadoccomment">	 *    be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1024" href="#L1024">1024</a> <em class="jxr_javadoccomment">     * </em>
<a class="jxr_linenumber" name="L1025" href="#L1025">1025</a> <em class="jxr_javadoccomment">	 * @param level of the event, one of IEjbcaWS.CUSTOMLOG_LEVEL_ constants</em>
<a class="jxr_linenumber" name="L1026" href="#L1026">1026</a> <em class="jxr_javadoccomment">	 * @param type userdefined string used as a prefix in the log comment</em>
<a class="jxr_linenumber" name="L1027" href="#L1027">1027</a> <em class="jxr_javadoccomment">	 * @param caName of the ca related to the event, use null if no specific CA is related.</em>
<a class="jxr_linenumber" name="L1028" href="#L1028">1028</a> <em class="jxr_javadoccomment">	 * Then will the ca of the administrator be used.</em>
<a class="jxr_linenumber" name="L1029" href="#L1029">1029</a> <em class="jxr_javadoccomment">	 * @param username of the related user, use null if no related user exists.</em>
<a class="jxr_linenumber" name="L1030" href="#L1030">1030</a> <em class="jxr_javadoccomment">	 * @param certificate that relates to the log event, use null if no certificate is related</em>
<a class="jxr_linenumber" name="L1031" href="#L1031">1031</a> <em class="jxr_javadoccomment">	 * @param msg message data used in the log comment. The log comment will have</em>
<a class="jxr_linenumber" name="L1032" href="#L1032">1032</a> <em class="jxr_javadoccomment">	 * a syntax of 'type : msg'</em>
<a class="jxr_linenumber" name="L1033" href="#L1033">1033</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L1034" href="#L1034">1034</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if the administrators isn't authorized to log.</em>
<a class="jxr_linenumber" name="L1035" href="#L1035">1035</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if error occured server side</em>
<a class="jxr_linenumber" name="L1036" href="#L1036">1036</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1037" href="#L1037">1037</a> 	<strong class="jxr_keyword">void</strong> customLog(<strong class="jxr_keyword">int</strong> level, String type, String caName, String username, <a name="Certificate" href="../../../../../../org/ejbca/core/protocol/ws/objects/Certificate.html#Certificate">Certificate</a> certificate, String msg) <strong class="jxr_keyword">throws</strong>
<a class="jxr_linenumber" name="L1038" href="#L1038">1038</a> 		CADoesntExistsException, AuthorizationDeniedException, EjbcaException;
<a class="jxr_linenumber" name="L1039" href="#L1039">1039</a> 
<a class="jxr_linenumber" name="L1040" href="#L1040">1040</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1041" href="#L1041">1041</a> <em class="jxr_javadoccomment">	 * Removes user data from a user data source.</em>
<a class="jxr_linenumber" name="L1042" href="#L1042">1042</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1043" href="#L1043">1043</a> <em class="jxr_javadoccomment">	 * Important removal functionality of a user data source is optional to</em>
<a class="jxr_linenumber" name="L1044" href="#L1044">1044</a> <em class="jxr_javadoccomment">	 * implement so it isn't certain that this method works with the given</em>
<a class="jxr_linenumber" name="L1045" href="#L1045">1045</a> <em class="jxr_javadoccomment">	 * user data source.</em>
<a class="jxr_linenumber" name="L1046" href="#L1046">1046</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1047" href="#L1047">1047</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1048" href="#L1048">1048</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L1049" href="#L1049">1049</a> <em class="jxr_javadoccomment">	 * - /userdatasourcesrules/&amp;lt;user data source&amp;gt;/remove_userdata (for all the given user data sources)</em>
<a class="jxr_linenumber" name="L1050" href="#L1050">1050</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;all cas defined in all the user data sources&amp;gt;</em>
<a class="jxr_linenumber" name="L1051" href="#L1051">1051</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1052" href="#L1052">1052</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1053" href="#L1053">1053</a> <em class="jxr_javadoccomment">	 * @param userDataSourceNames the names of the userdata source to remove from</em>
<a class="jxr_linenumber" name="L1054" href="#L1054">1054</a> <em class="jxr_javadoccomment">	 * @param searchString the search string to search for</em>
<a class="jxr_linenumber" name="L1055" href="#L1055">1055</a> <em class="jxr_javadoccomment">	 * @param removeMultipleMatch if multiple matches of a search string should be removed othervise is none removed.</em>
<a class="jxr_linenumber" name="L1056" href="#L1056">1056</a> <em class="jxr_javadoccomment">	 * @return true if the user was remove successfully from at least one of the user data sources.</em>
<a class="jxr_linenumber" name="L1057" href="#L1057">1057</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if the user isn't authorized to remove userdata from any of the specified user data sources</em>
<a class="jxr_linenumber" name="L1058" href="#L1058">1058</a> <em class="jxr_javadoccomment">	 * @throws MultipleMatchException if the searchstring resulted in a multiple match and the removeMultipleMatch was set to false.</em>
<a class="jxr_linenumber" name="L1059" href="#L1059">1059</a> <em class="jxr_javadoccomment">	 * @throws UserDataSourceException if an error occured during the communication with the user data source.</em>
<a class="jxr_linenumber" name="L1060" href="#L1060">1060</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if error occured server side</em>
<a class="jxr_linenumber" name="L1061" href="#L1061">1061</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1062" href="#L1062">1062</a> 	<strong class="jxr_keyword">boolean</strong> deleteUserDataFromSource(List&lt;String&gt; userDataSourceNames, String searchString, <strong class="jxr_keyword">boolean</strong> removeMultipleMatch) <strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, MultipleMatchException, UserDataSourceException, EjbcaException;
<a class="jxr_linenumber" name="L1063" href="#L1063">1063</a> 
<a class="jxr_linenumber" name="L1064" href="#L1064">1064</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1065" href="#L1065">1065</a> <em class="jxr_javadoccomment">	 * Fetches an issued certificate. If the request is proxied, the certificate on the first proxied instance found is returned.</em>
<a class="jxr_linenumber" name="L1066" href="#L1066">1066</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1067" href="#L1067">1067</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1068" href="#L1068">1068</a> <em class="jxr_javadoccomment">	 * - A valid certificate</em>
<a class="jxr_linenumber" name="L1069" href="#L1069">1069</a> <em class="jxr_javadoccomment">	 * - /ca_functionality/view_certificate</em>
<a class="jxr_linenumber" name="L1070" href="#L1070">1070</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;of the issing CA&amp;gt;</em>
<a class="jxr_linenumber" name="L1071" href="#L1071">1071</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1072" href="#L1072">1072</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1073" href="#L1073">1073</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the CA does not exist or authorization was denied on the local system, </em>
<a class="jxr_linenumber" name="L1074" href="#L1074">1074</a> <em class="jxr_javadoccomment">     *     then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1075" href="#L1075">1075</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L1076" href="#L1076">1076</a> <em class="jxr_javadoccomment">	 * @param certSNinHex the certificate serial number in hexadecimal representation</em>
<a class="jxr_linenumber" name="L1077" href="#L1077">1077</a> <em class="jxr_javadoccomment">	 * @param issuerDN the issuer of the certificate</em>
<a class="jxr_linenumber" name="L1078" href="#L1078">1078</a> <em class="jxr_javadoccomment">	 * @return the certificate (in WS representation) or null if certificate couldn't be found.</em>
<a class="jxr_linenumber" name="L1079" href="#L1079">1079</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L1080" href="#L1080">1080</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if the calling administrator isn't authorized to view the certificate</em>
<a class="jxr_linenumber" name="L1081" href="#L1081">1081</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if error occured server side</em>
<a class="jxr_linenumber" name="L1082" href="#L1082">1082</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1083" href="#L1083">1083</a> 	Certificate getCertificate(String certSNinHex, String issuerDN) <strong class="jxr_keyword">throws</strong>
<a class="jxr_linenumber" name="L1084" href="#L1084">1084</a> 		CADoesntExistsException, AuthorizationDeniedException, EjbcaException;
<a class="jxr_linenumber" name="L1085" href="#L1085">1085</a> 
<a class="jxr_linenumber" name="L1086" href="#L1086">1086</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1087" href="#L1087">1087</a> <em class="jxr_javadoccomment">	 * Fetch a list of the ids and names of available CAs.</em>
<a class="jxr_linenumber" name="L1088" href="#L1088">1088</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1089" href="#L1089">1089</a> <em class="jxr_javadoccomment">	 * Note: available means not having status "external" or "waiting for certificate response".</em>
<a class="jxr_linenumber" name="L1090" href="#L1090">1090</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1091" href="#L1091">1091</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1092" href="#L1092">1092</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L1093" href="#L1093">1093</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1094" href="#L1094">1094</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1095" href="#L1095">1095</a> <em class="jxr_javadoccomment">	 * If not turned of in jaxws.properties then only a valid certificate required</em>
<a class="jxr_linenumber" name="L1096" href="#L1096">1096</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1097" href="#L1097">1097</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the local system is not a CA, then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1098" href="#L1098">1098</a> <em class="jxr_javadoccomment">     * </em>
<a class="jxr_linenumber" name="L1099" href="#L1099">1099</a> <em class="jxr_javadoccomment">	 * Authored by Sebastien Levesque, Linagora. Javadoced by Tomas Gustavsson</em>
<a class="jxr_linenumber" name="L1100" href="#L1100">1100</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1101" href="#L1101">1101</a> <em class="jxr_javadoccomment">	 * @return array of NameAndId of available CAs, if no CAs are found will an empty array be returned of size 0, never null.</em>
<a class="jxr_linenumber" name="L1102" href="#L1102">1102</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if an error occured</em>
<a class="jxr_linenumber" name="L1103" href="#L1103">1103</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException fail</em>
<a class="jxr_linenumber" name="L1104" href="#L1104">1104</a> <em class="jxr_javadoccomment">	 * @see "ICAAdminSessionLocal#getAvailableCAs()"</em>
<a class="jxr_linenumber" name="L1105" href="#L1105">1105</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1106" href="#L1106">1106</a> 	NameAndId[] getAvailableCAs()
<a class="jxr_linenumber" name="L1107" href="#L1107">1107</a> 			<strong class="jxr_keyword">throws</strong> EjbcaException, AuthorizationDeniedException;
<a class="jxr_linenumber" name="L1108" href="#L1108">1108</a> 
<a class="jxr_linenumber" name="L1109" href="#L1109">1109</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1110" href="#L1110">1110</a> <em class="jxr_javadoccomment">	 * Fetches the end-entity profiles that the administrator is authorized to use.</em>
<a class="jxr_linenumber" name="L1111" href="#L1111">1111</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1112" href="#L1112">1112</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1113" href="#L1113">1113</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L1114" href="#L1114">1114</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;</em>
<a class="jxr_linenumber" name="L1115" href="#L1115">1115</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1116" href="#L1116">1116</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1117" href="#L1117">1117</a> <em class="jxr_javadoccomment">	 * Authored by Sebastien Levesque, Linagora. Javadoced by Tomas Gustavsson</em>
<a class="jxr_linenumber" name="L1118" href="#L1118">1118</a> 
<a class="jxr_linenumber" name="L1119" href="#L1119">1119</a> <em class="jxr_javadoccomment">	 * @return array of NameAndId of available end entity profiles, if no profiles are found will an empty array be returned of size 0, never null.</em>
<a class="jxr_linenumber" name="L1120" href="#L1120">1120</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if an error occured</em>
<a class="jxr_linenumber" name="L1121" href="#L1121">1121</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException fail</em>
<a class="jxr_linenumber" name="L1122" href="#L1122">1122</a> <em class="jxr_javadoccomment">	 * @see "IRaAdminSessionLocal#getAuthorizedEndEntityProfileIds()"</em>
<a class="jxr_linenumber" name="L1123" href="#L1123">1123</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1124" href="#L1124">1124</a> 	NameAndId[] getAuthorizedEndEntityProfiles()
<a class="jxr_linenumber" name="L1125" href="#L1125">1125</a> 			<strong class="jxr_keyword">throws</strong> EjbcaException, AuthorizationDeniedException;
<a class="jxr_linenumber" name="L1126" href="#L1126">1126</a> 
<a class="jxr_linenumber" name="L1127" href="#L1127">1127</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1128" href="#L1128">1128</a> <em class="jxr_javadoccomment">	 * Fetches available certificate profiles in an end entity profile.</em>
<a class="jxr_linenumber" name="L1129" href="#L1129">1129</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1130" href="#L1130">1130</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1131" href="#L1131">1131</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L1132" href="#L1132">1132</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;</em>
<a class="jxr_linenumber" name="L1133" href="#L1133">1133</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1134" href="#L1134">1134</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1135" href="#L1135">1135</a> <em class="jxr_javadoccomment">	 * Authored by Sebastien Levesque, Linagora. Javadoced by Tomas Gustavsson</em>
<a class="jxr_linenumber" name="L1136" href="#L1136">1136</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1137" href="#L1137">1137</a> <em class="jxr_javadoccomment">	 * @param entityProfileId id of an end entity profile where we want to find which certificate profiles are available</em>
<a class="jxr_linenumber" name="L1138" href="#L1138">1138</a> <em class="jxr_javadoccomment">	 * @return array of NameAndId of available certificate profiles, if no profiles are found will an empty array be returned of size 0, never null.</em>
<a class="jxr_linenumber" name="L1139" href="#L1139">1139</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if an error occured</em>
<a class="jxr_linenumber" name="L1140" href="#L1140">1140</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException fail</em>
<a class="jxr_linenumber" name="L1141" href="#L1141">1141</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1142" href="#L1142">1142</a> 	NameAndId[] getAvailableCertificateProfiles(<strong class="jxr_keyword">int</strong> entityProfileId)
<a class="jxr_linenumber" name="L1143" href="#L1143">1143</a> 			<strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, EjbcaException;
<a class="jxr_linenumber" name="L1144" href="#L1144">1144</a> 
<a class="jxr_linenumber" name="L1145" href="#L1145">1145</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1146" href="#L1146">1146</a> <em class="jxr_javadoccomment">	 * Fetches the ids and names of available CAs in an end entity profile.</em>
<a class="jxr_linenumber" name="L1147" href="#L1147">1147</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1148" href="#L1148">1148</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1149" href="#L1149">1149</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L1150" href="#L1150">1150</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;</em>
<a class="jxr_linenumber" name="L1151" href="#L1151">1151</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1152" href="#L1152">1152</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1153" href="#L1153">1153</a> <em class="jxr_javadoccomment">	 * If not turned of in jaxws.properties then only a valid certificate required</em>
<a class="jxr_linenumber" name="L1154" href="#L1154">1154</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1155" href="#L1155">1155</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the end entity profile does not exist or authorization was denied on the local system, </em>
<a class="jxr_linenumber" name="L1156" href="#L1156">1156</a> <em class="jxr_javadoccomment">     *     then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1157" href="#L1157">1157</a> <em class="jxr_javadoccomment">     * </em>
<a class="jxr_linenumber" name="L1158" href="#L1158">1158</a> <em class="jxr_javadoccomment">	 * Authorws by Sebastien Levesque, Linagora. Javadoced by Tomas Gustavsson</em>
<a class="jxr_linenumber" name="L1159" href="#L1159">1159</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1160" href="#L1160">1160</a> <em class="jxr_javadoccomment">	 * @param entityProfileId id of an end entity profile where we want to find which CAs are available</em>
<a class="jxr_linenumber" name="L1161" href="#L1161">1161</a> <em class="jxr_javadoccomment">	 * @return array of NameAndId of available CAs in the specified end entity profile, if no CAs are found will an empty array be returned of size 0, never null.</em>
<a class="jxr_linenumber" name="L1162" href="#L1162">1162</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if an error occured</em>
<a class="jxr_linenumber" name="L1163" href="#L1163">1163</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException fail</em>
<a class="jxr_linenumber" name="L1164" href="#L1164">1164</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1165" href="#L1165">1165</a> 	NameAndId[] getAvailableCAsInProfile(<strong class="jxr_keyword">int</strong> entityProfileId)
<a class="jxr_linenumber" name="L1166" href="#L1166">1166</a> 			<strong class="jxr_keyword">throws</strong> AuthorizationDeniedException, EjbcaException;
<a class="jxr_linenumber" name="L1167" href="#L1167">1167</a> 
<a class="jxr_linenumber" name="L1168" href="#L1168">1168</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1169" href="#L1169">1169</a> <em class="jxr_javadoccomment">	 * Fetches the profile specified by profileId and profileType in XML format.</em>
<a class="jxr_linenumber" name="L1170" href="#L1170">1170</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1171" href="#L1171">1171</a> <em class="jxr_javadoccomment">	 * Authorization requirements for an EEP:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1172" href="#L1172">1172</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L1173" href="#L1173">1173</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/view_end_entity_profiles</em>
<a class="jxr_linenumber" name="L1174" href="#L1174">1174</a> <em class="jxr_javadoccomment">	 * - any CA's referenced to in the EEP, or in any CPs referenced to in the EEP</em>
<a class="jxr_linenumber" name="L1175" href="#L1175">1175</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1176" href="#L1176">1176</a> <em class="jxr_javadoccomment">	 * </em>
<a class="jxr_linenumber" name="L1177" href="#L1177">1177</a> <em class="jxr_javadoccomment">	 * Authorization requirements for an CP:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1178" href="#L1178">1178</a> <em class="jxr_javadoccomment">     * - /administrator</em>
<a class="jxr_linenumber" name="L1179" href="#L1179">1179</a> <em class="jxr_javadoccomment">     * - /ca_functionality/view_certificate_profiles</em>
<a class="jxr_linenumber" name="L1180" href="#L1180">1180</a> <em class="jxr_javadoccomment">     * - any CA's referenced to in the CP</em>
<a class="jxr_linenumber" name="L1181" href="#L1181">1181</a> <em class="jxr_javadoccomment">     * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1182" href="#L1182">1182</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1183" href="#L1183">1183</a> <em class="jxr_javadoccomment">	 * For detailed documentation for how to parse an End Entity Profile XML, see the org.ejbca.core.model.ra.raadmin.EndEntity class.</em>
<a class="jxr_linenumber" name="L1184" href="#L1184">1184</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1185" href="#L1185">1185</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the end entity profile (or certificate profile) does not exist or authorization was denied on the local system, </em>
<a class="jxr_linenumber" name="L1186" href="#L1186">1186</a> <em class="jxr_javadoccomment">     *    then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1187" href="#L1187">1187</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L1188" href="#L1188">1188</a> <em class="jxr_javadoccomment">	 * @param profileId ID of the profile we want to retrieve.</em>
<a class="jxr_linenumber" name="L1189" href="#L1189">1189</a> <em class="jxr_javadoccomment">	 * @param profileType The type of the profile we want to retrieve. 'eep' for End Entity Profiles and 'cp' for Certificate Profiles</em>
<a class="jxr_linenumber" name="L1190" href="#L1190">1190</a> <em class="jxr_javadoccomment">	 * @return a byte array containing the specified profile in XML format</em>
<a class="jxr_linenumber" name="L1191" href="#L1191">1191</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if a profile of the specified type was not found</em>
<a class="jxr_linenumber" name="L1192" href="#L1192">1192</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if the requesting user wasn't authorized to the requested profile</em>
<a class="jxr_linenumber" name="L1193" href="#L1193">1193</a> <em class="jxr_javadoccomment">	 * @throws UnknownProfileTypeException if the submitted profile type was not 'eep' or 'cp'</em>
<a class="jxr_linenumber" name="L1194" href="#L1194">1194</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1195" href="#L1195">1195</a> 	 byte[] getProfile(<strong class="jxr_keyword">int</strong> profileId, String profileType)
<a class="jxr_linenumber" name="L1196" href="#L1196">1196</a>                  <strong class="jxr_keyword">throws</strong> EjbcaException, AuthorizationDeniedException, UnknownProfileTypeException;
<a class="jxr_linenumber" name="L1197" href="#L1197">1197</a> 
<a class="jxr_linenumber" name="L1198" href="#L1198">1198</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1199" href="#L1199">1199</a> <em class="jxr_javadoccomment">	 * Generates a CRL for the given CA.</em>
<a class="jxr_linenumber" name="L1200" href="#L1200">1200</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1201" href="#L1201">1201</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1202" href="#L1202">1202</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;caid&amp;gt;</em>
<a class="jxr_linenumber" name="L1203" href="#L1203">1203</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1204" href="#L1204">1204</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1205" href="#L1205">1205</a> <em class="jxr_javadoccomment">	 * @param caname the name in EJBCA of the CA that should have a new CRL generated</em>
<a class="jxr_linenumber" name="L1206" href="#L1206">1206</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L1207" href="#L1207">1207</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException fail</em>
<a class="jxr_linenumber" name="L1208" href="#L1208">1208</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException if an error occured, for example authorization denied</em>
<a class="jxr_linenumber" name="L1209" href="#L1209">1209</a> <em class="jxr_javadoccomment">	 * @throws ApprovalRequestExpiredException fail</em>
<a class="jxr_linenumber" name="L1210" href="#L1210">1210</a> <em class="jxr_javadoccomment">	 * @throws CAOfflineException fail</em>
<a class="jxr_linenumber" name="L1211" href="#L1211">1211</a> <em class="jxr_javadoccomment">	 * @throws CryptoTokenOfflineException fail</em>
<a class="jxr_linenumber" name="L1212" href="#L1212">1212</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1213" href="#L1213">1213</a> 	<strong class="jxr_keyword">void</strong> createCRL(String caname)
<a class="jxr_linenumber" name="L1214" href="#L1214">1214</a> 			<strong class="jxr_keyword">throws</strong> CADoesntExistsException, ApprovalException, EjbcaException, ApprovalRequestExpiredException, CryptoTokenOfflineException, CAOfflineException;
<a class="jxr_linenumber" name="L1215" href="#L1215">1215</a> 
<a class="jxr_linenumber" name="L1216" href="#L1216">1216</a>     <em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1217" href="#L1217">1217</a> <em class="jxr_javadoccomment">     * Retrieves the latest CRL issued by the given CA.</em>
<a class="jxr_linenumber" name="L1218" href="#L1218">1218</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1219" href="#L1219">1219</a> <em class="jxr_javadoccomment">     * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1220" href="#L1220">1220</a> <em class="jxr_javadoccomment">     * - /ca/&amp;lt;caid&amp;gt;</em>
<a class="jxr_linenumber" name="L1221" href="#L1221">1221</a> <em class="jxr_javadoccomment">     * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1222" href="#L1222">1222</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1223" href="#L1223">1223</a> <em class="jxr_javadoccomment">     * &lt;p&gt;If the CA does not exist on the local system, then the request will be forwarded </em>
<a class="jxr_linenumber" name="L1224" href="#L1224">1224</a> <em class="jxr_javadoccomment">     *    to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1225" href="#L1225">1225</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L1226" href="#L1226">1226</a> <em class="jxr_javadoccomment">     * @param caname the name in EJBCA of the CA that issued the desired CRL</em>
<a class="jxr_linenumber" name="L1227" href="#L1227">1227</a> <em class="jxr_javadoccomment">     * @param deltaCRL false to fetch a full CRL, true to fetch a deltaCRL (if issued)</em>
<a class="jxr_linenumber" name="L1228" href="#L1228">1228</a> <em class="jxr_javadoccomment">     * @return the latest CRL issued for the CA as a DER encoded byte array</em>
<a class="jxr_linenumber" name="L1229" href="#L1229">1229</a> <em class="jxr_javadoccomment">     * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L1230" href="#L1230">1230</a> <em class="jxr_javadoccomment">     * @throws EjbcaException if an error occured, for example authorization denied</em>
<a class="jxr_linenumber" name="L1231" href="#L1231">1231</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L1232" href="#L1232">1232</a>     byte[] getLatestCRL(String caname, <strong class="jxr_keyword">boolean</strong> deltaCRL) <strong class="jxr_keyword">throws</strong> CADoesntExistsException, EjbcaException;
<a class="jxr_linenumber" name="L1233" href="#L1233">1233</a> 
<a class="jxr_linenumber" name="L1234" href="#L1234">1234</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1235" href="#L1235">1235</a> <em class="jxr_javadoccomment">	 * Returns the version of the EJBCA server.</em>
<a class="jxr_linenumber" name="L1236" href="#L1236">1236</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1237" href="#L1237">1237</a> <em class="jxr_javadoccomment">	 * Authorization requirements:</em>
<a class="jxr_linenumber" name="L1238" href="#L1238">1238</a> <em class="jxr_javadoccomment">	 *  - none</em>
<a class="jxr_linenumber" name="L1239" href="#L1239">1239</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1240" href="#L1240">1240</a> <em class="jxr_javadoccomment">	 * @return String with the version of EJBCA, i.e. "EJBCA 3.6.2"</em>
<a class="jxr_linenumber" name="L1241" href="#L1241">1241</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1242" href="#L1242">1242</a> 	String getEjbcaVersion();
<a class="jxr_linenumber" name="L1243" href="#L1243">1243</a> 
<a class="jxr_linenumber" name="L1244" href="#L1244">1244</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1245" href="#L1245">1245</a> <em class="jxr_javadoccomment">	 * Generates a soft token certificate for a user.</em>
<a class="jxr_linenumber" name="L1246" href="#L1246">1246</a> <em class="jxr_javadoccomment">	 * If the user is not already present in the database, the user is added.&lt;br&gt;</em>
<a class="jxr_linenumber" name="L1247" href="#L1247">1247</a> <em class="jxr_javadoccomment">	 * Status is automatically set to STATUS_NEW.&lt;br&gt;</em>
<a class="jxr_linenumber" name="L1248" href="#L1248">1248</a> <em class="jxr_javadoccomment">	 * The user's token type must be set to org.ejbca.core.protocol.ws.client.gen.UserDataVOWS.TOKEN_TYPE_ (JKS or P12).</em>
<a class="jxr_linenumber" name="L1249" href="#L1249">1249</a> <em class="jxr_javadoccomment">	 * A token password must also be defined.&lt;p&gt;</em>
<a class="jxr_linenumber" name="L1250" href="#L1250">1250</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1251" href="#L1251">1251</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L1252" href="#L1252">1252</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/create_end_entity and/or edit_end_entity</em>
<a class="jxr_linenumber" name="L1253" href="#L1253">1253</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile of user&amp;gt;/create_end_entity and/or edit_end_entity</em>
<a class="jxr_linenumber" name="L1254" href="#L1254">1254</a> <em class="jxr_javadoccomment">	 * - /ca_functionality/create_certificate</em>
<a class="jxr_linenumber" name="L1255" href="#L1255">1255</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L1256" href="#L1256">1256</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1257" href="#L1257">1257</a> <em class="jxr_javadoccomment">	 * @param userData the user</em>
<a class="jxr_linenumber" name="L1258" href="#L1258">1258</a> <em class="jxr_javadoccomment">	 * @param hardTokenSN If the certificate should be connected with a hardtoken, it is</em>
<a class="jxr_linenumber" name="L1259" href="#L1259">1259</a> <em class="jxr_javadoccomment">	 * possible to map it by give the hardTokenSN here, this will simplify revocation of a token</em>
<a class="jxr_linenumber" name="L1260" href="#L1260">1260</a> <em class="jxr_javadoccomment">	 * certificates. Use null if no hardtokenSN should be associated with the certificate.</em>
<a class="jxr_linenumber" name="L1261" href="#L1261">1261</a> <em class="jxr_javadoccomment">	 * @param keyspec that the generated key should have, examples are 2048 for RSA or secp256r1 for ECDSA.</em>
<a class="jxr_linenumber" name="L1262" href="#L1262">1262</a> <em class="jxr_javadoccomment">	 * @param keyalg that the generated key should have, RSA, ECDSA. Use one of the constants in</em>
<a class="jxr_linenumber" name="L1263" href="#L1263">1263</a> <em class="jxr_javadoccomment">	 * {@link org.cesecore.certificates.util.AlgorithmConstants}.KEYALGORITHM_...</em>
<a class="jxr_linenumber" name="L1264" href="#L1264">1264</a> <em class="jxr_javadoccomment">	 * @return the generated token data</em>
<a class="jxr_linenumber" name="L1265" href="#L1265">1265</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L1266" href="#L1266">1266</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized to request</em>
<a class="jxr_linenumber" name="L1267" href="#L1267">1267</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException if user cannot be found</em>
<a class="jxr_linenumber" name="L1268" href="#L1268">1268</a> <em class="jxr_javadoccomment">	 * @throws UserDoesntFullfillEndEntityProfile fail</em>
<a class="jxr_linenumber" name="L1269" href="#L1269">1269</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException fail</em>
<a class="jxr_linenumber" name="L1270" href="#L1270">1270</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException fail</em>
<a class="jxr_linenumber" name="L1271" href="#L1271">1271</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException fail</em>
<a class="jxr_linenumber" name="L1272" href="#L1272">1272</a> <em class="jxr_javadoccomment">	 * @see #editUser(UserDataVOWS)</em>
<a class="jxr_linenumber" name="L1273" href="#L1273">1273</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1274" href="#L1274">1274</a> 	@SuppressWarnings(<span class="jxr_string">"javadoc"</span>)
<a class="jxr_linenumber" name="L1275" href="#L1275">1275</a> 	KeyStore softTokenRequest(<a name="UserDataVOWS" href="../../../../../../org/ejbca/core/protocol/ws/objects/UserDataVOWS.html#UserDataVOWS">UserDataVOWS</a> userData, String hardTokenSN, String keyspec, String keyalg)
<a class="jxr_linenumber" name="L1276" href="#L1276">1276</a> 	<strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, NotFoundException, UserDoesntFullfillEndEntityProfile,
<a class="jxr_linenumber" name="L1277" href="#L1277">1277</a> 	ApprovalException, WaitingForApprovalException, EjbcaException;
<a class="jxr_linenumber" name="L1278" href="#L1278">1278</a> 	
<a class="jxr_linenumber" name="L1279" href="#L1279">1279</a> 	<em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1280" href="#L1280">1280</a> <em class="jxr_javadoccomment">	 * Generates a certificate for a user.</em>
<a class="jxr_linenumber" name="L1281" href="#L1281">1281</a> <em class="jxr_javadoccomment">	 * If the user is not already present in the database it will be added otherwise it will be overwritten.&lt;br&gt;</em>
<a class="jxr_linenumber" name="L1282" href="#L1282">1282</a> <em class="jxr_javadoccomment">	 * Status is automatically set to STATUS_NEW.&lt;p&gt;</em>
<a class="jxr_linenumber" name="L1283" href="#L1283">1283</a> <em class="jxr_javadoccomment">	 * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1284" href="#L1284">1284</a> <em class="jxr_javadoccomment">	 * - /administrator</em>
<a class="jxr_linenumber" name="L1285" href="#L1285">1285</a> <em class="jxr_javadoccomment">	 * - /ra_functionality/create_end_entity and/or edit_end_entity</em>
<a class="jxr_linenumber" name="L1286" href="#L1286">1286</a> <em class="jxr_javadoccomment">	 * - /endentityprofilesrules/&amp;lt;end entity profile of user&amp;gt;/create_end_entity and/or edit_end_entity</em>
<a class="jxr_linenumber" name="L1287" href="#L1287">1287</a> <em class="jxr_javadoccomment">	 * - /ca_functionality/create_certificate</em>
<a class="jxr_linenumber" name="L1288" href="#L1288">1288</a> <em class="jxr_javadoccomment">	 * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L1289" href="#L1289">1289</a> <em class="jxr_javadoccomment">	 * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1290" href="#L1290">1290</a> <em class="jxr_javadoccomment">	 * When the requestType is PUBLICKEY the requestData should be an</em>
<a class="jxr_linenumber" name="L1291" href="#L1291">1291</a> <em class="jxr_javadoccomment">	 * SubjectPublicKeyInfo structure either base64 encoded or in PEM format.</em>
<a class="jxr_linenumber" name="L1292" href="#L1292">1292</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1293" href="#L1293">1293</a> <em class="jxr_javadoccomment">	 * &lt;p&gt;If the CA does not exist on the local system, then the request will be forwarded to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1294" href="#L1294">1294</a> <em class="jxr_javadoccomment">	 * </em>
<a class="jxr_linenumber" name="L1295" href="#L1295">1295</a> <em class="jxr_javadoccomment">	 * Using this call to create end entities on CAs/Certificate Profiles with approval restrictions is not possible. If such a usecase is desired,</em>
<a class="jxr_linenumber" name="L1296" href="#L1296">1296</a> <em class="jxr_javadoccomment">	 * use org.ejbca.core.protocol.ws.common.IEjbcaWS.editUser(UserDataVOWS) in conjunction with </em>
<a class="jxr_linenumber" name="L1297" href="#L1297">1297</a> <em class="jxr_javadoccomment">	 * org.ejbca.core.protocol.ws.common.IEjbcaWS.getRemainingNumberOfApprovals(int) and </em>
<a class="jxr_linenumber" name="L1298" href="#L1298">1298</a> <em class="jxr_javadoccomment">	 * org.ejbca.core.protocol.ws.common.IEjbcaWS.pkcs10Request(String, String, String, String, String) instead. </em>
<a class="jxr_linenumber" name="L1299" href="#L1299">1299</a> <em class="jxr_javadoccomment">	 *</em>
<a class="jxr_linenumber" name="L1300" href="#L1300">1300</a> <em class="jxr_javadoccomment">	 * @param userData the user</em>
<a class="jxr_linenumber" name="L1301" href="#L1301">1301</a> <em class="jxr_javadoccomment">	 * @param requestData the PKCS10/CRMF/SPKAC/PUBLICKEY request in base64</em>
<a class="jxr_linenumber" name="L1302" href="#L1302">1302</a> <em class="jxr_javadoccomment">	 * @param requestType PKCS10, CRMF, SPKAC or PUBLICKEY request as specified by</em>
<a class="jxr_linenumber" name="L1303" href="#L1303">1303</a> <em class="jxr_javadoccomment">	 * {@link org.ejbca.core.protocol.ws.common.CertificateHelper}.CERT_REQ_TYPE_ parameters.</em>
<a class="jxr_linenumber" name="L1304" href="#L1304">1304</a> <em class="jxr_javadoccomment">	 * @param hardTokenSN If the certificate should be connected with a hardtoken, it is</em>
<a class="jxr_linenumber" name="L1305" href="#L1305">1305</a> <em class="jxr_javadoccomment">	 * possible to map it by give the hardTokenSN here, this will simplify revocation of a token</em>
<a class="jxr_linenumber" name="L1306" href="#L1306">1306</a> <em class="jxr_javadoccomment">	 * certificates. Use null if no hardtokenSN should be associated with the certificate.</em>
<a class="jxr_linenumber" name="L1307" href="#L1307">1307</a> <em class="jxr_javadoccomment">	 * @param responseType indicating which type of answer that should be returned, on of the</em>
<a class="jxr_linenumber" name="L1308" href="#L1308">1308</a> <em class="jxr_javadoccomment">	 * {@link org.ejbca.core.protocol.ws.common.CertificateHelper}.RESPONSETYPE_ parameters.</em>
<a class="jxr_linenumber" name="L1309" href="#L1309">1309</a> <em class="jxr_javadoccomment">	 * @return the generated certificate, in either just X509Certificate or PKCS7</em>
<a class="jxr_linenumber" name="L1310" href="#L1310">1310</a> <em class="jxr_javadoccomment">	 * @throws CADoesntExistsException if a referenced CA does not exist</em>
<a class="jxr_linenumber" name="L1311" href="#L1311">1311</a> <em class="jxr_javadoccomment">	 * @throws AuthorizationDeniedException if client isn't authorized to request</em>
<a class="jxr_linenumber" name="L1312" href="#L1312">1312</a> <em class="jxr_javadoccomment">	 * @throws NotFoundException if user cannot be found</em>
<a class="jxr_linenumber" name="L1313" href="#L1313">1313</a> <em class="jxr_javadoccomment">	 * @throws UserDoesntFullfillEndEntityProfile fail</em>
<a class="jxr_linenumber" name="L1314" href="#L1314">1314</a> <em class="jxr_javadoccomment">	 * @throws ApprovalException thrown if a end needs to be created as part of this request, but that action requires approvals.</em>
<a class="jxr_linenumber" name="L1315" href="#L1315">1315</a> <em class="jxr_javadoccomment">	 * @throws WaitingForApprovalException never thrown, but remains for legacy reasons</em>
<a class="jxr_linenumber" name="L1316" href="#L1316">1316</a> <em class="jxr_javadoccomment">	 * @throws EjbcaException fail </em>
<a class="jxr_linenumber" name="L1317" href="#L1317">1317</a> <em class="jxr_javadoccomment">	 * @see #editUser(UserDataVOWS)</em>
<a class="jxr_linenumber" name="L1318" href="#L1318">1318</a> <em class="jxr_javadoccomment">	 */</em>
<a class="jxr_linenumber" name="L1319" href="#L1319">1319</a> 	@SuppressWarnings(<span class="jxr_string">"javadoc"</span>)
<a class="jxr_linenumber" name="L1320" href="#L1320">1320</a> 	CertificateResponse certificateRequest(<a name="UserDataVOWS" href="../../../../../../org/ejbca/core/protocol/ws/objects/UserDataVOWS.html#UserDataVOWS">UserDataVOWS</a> userData, String requestData, <strong class="jxr_keyword">int</strong> requestType, String hardTokenSN, String responseType)
<a class="jxr_linenumber" name="L1321" href="#L1321">1321</a> 	<strong class="jxr_keyword">throws</strong> CADoesntExistsException, AuthorizationDeniedException, NotFoundException, UserDoesntFullfillEndEntityProfile,
<a class="jxr_linenumber" name="L1322" href="#L1322">1322</a> 	ApprovalException, WaitingForApprovalException, EjbcaException;
<a class="jxr_linenumber" name="L1323" href="#L1323">1323</a> 
<a class="jxr_linenumber" name="L1324" href="#L1324">1324</a> 
<a class="jxr_linenumber" name="L1325" href="#L1325">1325</a>     <em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1326" href="#L1326">1326</a> <em class="jxr_javadoccomment">     * Returns the length of a publisher queue.</em>
<a class="jxr_linenumber" name="L1327" href="#L1327">1327</a> <em class="jxr_javadoccomment">     * </em>
<a class="jxr_linenumber" name="L1328" href="#L1328">1328</a> <em class="jxr_javadoccomment">     * If the request is proxied from the RA to CA instances, the result of the first queue found is returned, </em>
<a class="jxr_linenumber" name="L1329" href="#L1329">1329</a> <em class="jxr_javadoccomment">     * to not to count the queue length multiple times on a cluster environment. Therefore the method MUST NOT be </em>
<a class="jxr_linenumber" name="L1330" href="#L1330">1330</a> <em class="jxr_javadoccomment">     * called for deployment scenarios, where the request is proxied to multiple different CA instances not sharing </em>
<a class="jxr_linenumber" name="L1331" href="#L1331">1331</a> <em class="jxr_javadoccomment">     * the same data store.</em>
<a class="jxr_linenumber" name="L1332" href="#L1332">1332</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1333" href="#L1333">1333</a> <em class="jxr_javadoccomment">     * &lt;p&gt;If the publisher does not exist on the local system, then the request will be forwarded </em>
<a class="jxr_linenumber" name="L1334" href="#L1334">1334</a> <em class="jxr_javadoccomment">     *    to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1335" href="#L1335">1335</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L1336" href="#L1336">1336</a> <em class="jxr_javadoccomment">     * @param name of the queue</em>
<a class="jxr_linenumber" name="L1337" href="#L1337">1337</a> <em class="jxr_javadoccomment">     * @return the length or -4 if the publisher does not exist.</em>
<a class="jxr_linenumber" name="L1338" href="#L1338">1338</a> <em class="jxr_javadoccomment">     * @throws EjbcaException fail</em>
<a class="jxr_linenumber" name="L1339" href="#L1339">1339</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L1340" href="#L1340">1340</a>     <strong class="jxr_keyword">int</strong> getPublisherQueueLength(String name) <strong class="jxr_keyword">throws</strong> EjbcaException;
<a class="jxr_linenumber" name="L1341" href="#L1341">1341</a> 
<a class="jxr_linenumber" name="L1342" href="#L1342">1342</a>     <em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1343" href="#L1343">1343</a> <em class="jxr_javadoccomment">     * Retrieves the certificates whose expiration date is before the specified number of days.</em>
<a class="jxr_linenumber" name="L1344" href="#L1344">1344</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1345" href="#L1345">1345</a> <em class="jxr_javadoccomment">     *  Note the whole certificate chain is returned.</em>
<a class="jxr_linenumber" name="L1346" href="#L1346">1346</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1347" href="#L1347">1347</a> <em class="jxr_javadoccomment">     * Authorization requirements:&lt;pre&gt;</em>
<a class="jxr_linenumber" name="L1348" href="#L1348">1348</a> <em class="jxr_javadoccomment">     * - /administrator</em>
<a class="jxr_linenumber" name="L1349" href="#L1349">1349</a> <em class="jxr_javadoccomment">     * - /ra_functionality/view_end_entity</em>
<a class="jxr_linenumber" name="L1350" href="#L1350">1350</a> <em class="jxr_javadoccomment">     * - /endentityprofilesrules/&amp;lt;end entity profile&amp;gt;/view_end_entity</em>
<a class="jxr_linenumber" name="L1351" href="#L1351">1351</a> <em class="jxr_javadoccomment">     * - /ca/&amp;lt;ca of user&amp;gt;</em>
<a class="jxr_linenumber" name="L1352" href="#L1352">1352</a> <em class="jxr_javadoccomment">     * &lt;/pre&gt;</em>
<a class="jxr_linenumber" name="L1353" href="#L1353">1353</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1354" href="#L1354">1354</a> <em class="jxr_javadoccomment">     * &lt;p&gt;If authorization was denied on the local system, then the request will be forwarded </em>
<a class="jxr_linenumber" name="L1355" href="#L1355">1355</a> <em class="jxr_javadoccomment">     *    to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1356" href="#L1356">1356</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L1357" href="#L1357">1357</a> <em class="jxr_javadoccomment">     * @param days the number of days before the certificates will expire</em>
<a class="jxr_linenumber" name="L1358" href="#L1358">1358</a> <em class="jxr_javadoccomment">     * @param maxNumberOfResults the maximum number of returned certificates</em>
<a class="jxr_linenumber" name="L1359" href="#L1359">1359</a> <em class="jxr_javadoccomment">     * @return A list of certificates, never null</em>
<a class="jxr_linenumber" name="L1360" href="#L1360">1360</a> <em class="jxr_javadoccomment">     * @throws EjbcaException if at least one of the certificates is unreadable</em>
<a class="jxr_linenumber" name="L1361" href="#L1361">1361</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L1362" href="#L1362">1362</a>     List&lt;Certificate&gt; getCertificatesByExpirationTime(<strong class="jxr_keyword">long</strong> days, <strong class="jxr_keyword">int</strong> maxNumberOfResults) <strong class="jxr_keyword">throws</strong> EjbcaException;
<a class="jxr_linenumber" name="L1363" href="#L1363">1363</a> 
<a class="jxr_linenumber" name="L1364" href="#L1364">1364</a> 
<a class="jxr_linenumber" name="L1365" href="#L1365">1365</a>     <em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1366" href="#L1366">1366</a> <em class="jxr_javadoccomment">     * List certificates that will expire within the given number of days and issued by the given issuer</em>
<a class="jxr_linenumber" name="L1367" href="#L1367">1367</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1368" href="#L1368">1368</a> <em class="jxr_javadoccomment">     * &lt;p&gt;If authorization was denied on the local system, then the request will be forwarded </em>
<a class="jxr_linenumber" name="L1369" href="#L1369">1369</a> <em class="jxr_javadoccomment">     *    to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1370" href="#L1370">1370</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L1371" href="#L1371">1371</a> <em class="jxr_javadoccomment">     * @param days Expire time in days</em>
<a class="jxr_linenumber" name="L1372" href="#L1372">1372</a> <em class="jxr_javadoccomment">     * @param issuerDN The issuerDN of the certificates</em>
<a class="jxr_linenumber" name="L1373" href="#L1373">1373</a> <em class="jxr_javadoccomment">     * @param maxNumberOfResults the maximum number of returned certificates</em>
<a class="jxr_linenumber" name="L1374" href="#L1374">1374</a> <em class="jxr_javadoccomment">     * @return A list of certificates, never null</em>
<a class="jxr_linenumber" name="L1375" href="#L1375">1375</a> <em class="jxr_javadoccomment">     * @throws EjbcaException if at least one of the certificates is unreadable</em>
<a class="jxr_linenumber" name="L1376" href="#L1376">1376</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L1377" href="#L1377">1377</a>     List&lt;Certificate&gt; getCertificatesByExpirationTimeAndIssuer(<strong class="jxr_keyword">long</strong> days, String issuerDN, <strong class="jxr_keyword">int</strong> maxNumberOfResults) <strong class="jxr_keyword">throws</strong> EjbcaException;
<a class="jxr_linenumber" name="L1378" href="#L1378">1378</a> 
<a class="jxr_linenumber" name="L1379" href="#L1379">1379</a>     <em class="jxr_javadoccomment">/**</em>
<a class="jxr_linenumber" name="L1380" href="#L1380">1380</a> <em class="jxr_javadoccomment">     * List certificates that will expire within the given number of days and of the given type</em>
<a class="jxr_linenumber" name="L1381" href="#L1381">1381</a> <em class="jxr_javadoccomment">     *</em>
<a class="jxr_linenumber" name="L1382" href="#L1382">1382</a> <em class="jxr_javadoccomment">     * &lt;p&gt;If authorization was denied on the local system, then the request will be forwarded </em>
<a class="jxr_linenumber" name="L1383" href="#L1383">1383</a> <em class="jxr_javadoccomment">     *    to upstream peer systems (if any).&lt;/p&gt;</em>
<a class="jxr_linenumber" name="L1384" href="#L1384">1384</a> <em class="jxr_javadoccomment">     *     </em>
<a class="jxr_linenumber" name="L1385" href="#L1385">1385</a> <em class="jxr_javadoccomment">     * @param days Expire time in days</em>
<a class="jxr_linenumber" name="L1386" href="#L1386">1386</a> <em class="jxr_javadoccomment">     * @param certificateType The type of the certificates. Use 0=Unknown  1=EndEntity  2=SUBCA  8=ROOTCA  16=HardToken</em>
<a class="jxr_linenumber" name="L1387" href="#L1387">1387</a> <em class="jxr_javadoccomment">     * @param maxNumberOfResults the maximum number of returned certificates</em>
<a class="jxr_linenumber" name="L1388" href="#L1388">1388</a> <em class="jxr_javadoccomment">     * @return A list of certificates, never null</em>
<a class="jxr_linenumber" name="L1389" href="#L1389">1389</a> <em class="jxr_javadoccomment">     * @throws EjbcaException if at least one of the certificates is unreadable</em>
<a class="jxr_linenumber" name="L1390" href="#L1390">1390</a> <em class="jxr_javadoccomment">     */</em>
<a class="jxr_linenumber" name="L1391" href="#L1391">1391</a>     List&lt;Certificate&gt; getCertificatesByExpirationTimeAndType(<strong class="jxr_keyword">long</strong> days, <strong class="jxr_keyword">int</strong> certificateType, <strong class="jxr_keyword">int</strong> maxNumberOfResults) <strong class="jxr_keyword">throws</strong> EjbcaException;
<a class="jxr_linenumber" name="L1392" href="#L1392">1392</a> 
<a class="jxr_linenumber" name="L1393" href="#L1393">1393</a> }
</pre>
<hr/>
<div id="footer">Copyright &#169; 2020. All rights reserved.</div>
</body>
</html>