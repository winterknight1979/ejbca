<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>EJBCA 6.0 Upgrade Notes - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=26772577"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Release_Information.html">EJBCA Release Information</a></li>
                                                                                     <li><a href="EJBCA_Upgrade_Notes.html">EJBCA Upgrade Notes</a></li>
                                                            </ul>
</div>            <h1 id="src-26772577"> <span>EJBCA 6.0 Upgrade Notes</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<hr>
    <div class="section section-1" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-EJBCA5.0.xtoEJBCA6.0.x">
        <h1 class="heading p1"><span>EJBCA 5.0.x to EJBCA 6.0.x</span></h1>
<p  class="toc-link" 
>The following lists important notes on upgrading to EJBCA version 6.0.x:</p>
<p  class="toc-link" 
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-BasicUpgradeProcedureforEJBCA">Basic Upgrade Procedure for EJBCA</a></p>
</li><li class=" "><p   
><a   href="#src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-BasicUpgradeProcedureforValidationAuthorities">Basic Upgrade Procedure for Validation Authorities</a></p>
</li><li class=" "><p   
><a   href="#src-26772577_safe-id-aWQtLkVKQkNBNi4wVXBncmFkZU5vdGVzdjYuMTUuMS0xMDAlVXB0aW1lVXBncmFkZU5vdGVz">100% Uptime Upgrade Notes</a></p>
</li><li class=" "><p   
><a   href="#src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-CMPConfigurationHandling">CMP Configuration Handling</a></p>
</li><li class=" "><p   
><a   href="#src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-CLICommandsRenamed">CLI Commands Renamed</a></p>
</li><li class=" "><p   
><a   href="#src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-MiscellaneousIssues">Miscellaneous Issues</a></p>
</li></ul><p   
>For upgrade instructions and information on upgrade paths, see <a   href="Upgrading_EJBCA.html">Upgrading EJBCA</a>.</p>
<p   
>For details of the new features and improvements in the releases, see the <a   href="EJBCA_Release_Notes.html">EJBCA Release Notes</a>.</p>
<p   
></p>
<hr>
    <div class="section section-2" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-BasicUpgradeProcedureforEJBCA">
        <h2 class="heading "><span>Basic Upgrade Procedure for EJBCA</span></h2>
<p  class="p1" 
>The 'ant bootstrap' target has been deprecated, and now it's covered by the 'ant deploy' target. Behavior for the 'ant deploy' has been changed, and the old command is equivalent to the following sequence:</p>
<ul class="alternate "><li class=" "><p   
>ant deploy</p>
</li></ul><ul class="alternate "><li class=" "><p   
>ant deploy-keystore</p>
</li></ul><ul class="alternate "><li class=" "><p   
>ant web-configure</p>
</li></ul><p  class="p1" 
>(there is also an ant deployear target that only deploys an updated ejbca.ear file, excellent for upgrading or changing configuration)</p>
<p  class="p1" 
>For more information about new deployment instructions and ant targets, refer to <a   href="EJBCA_Installations.html">EJBCA Installations</a>.</p>
<p  class="p1" 
>Backup your database first! If the upgrade fails, you can always go back to the earlier version.</p>
<p  class="p1" 
>If you are upgrading a cluster, update the software on all the nodes.</p>
<ol class=" "><li class=" "><p   
>Copy conf/*.properties from the earlier installation into the conf directory of the new release.<br/>Or better yet, use the ejbca-custom feature for easier upgrades, see <a   href="EJBCA_User_Guide.html">EJBCA User Guide</a><br/><img  class="emoticon emoticon-warning"  src="images/s/en_US/8100/b0984b7297905b7c7bd946458f753ce0130bfc8c/_/images/icons/emoticons/warning.svg" alt="images/s/en_US/8100/b0984b7297905b7c7bd946458f753ce0130bfc8c/_/images/icons/emoticons/warning.svg"   />
 If you are using the default Hypersonic database in JBoss 5, you now need to configure this in database.properties (default test database is now for JBoss 7/EAP6).</p>
</li><li class=" "><p   
>Copy the directory 'p12' from the earlier installation.</p>
</li><li class=" "><p   
>If using JBoss 5.1 or older, then shut down JBoss.</p>
</li><li class=" "><p   
>Run the 'ant deploy' target with new version.</p>
</li><li class=" "><p   
>Run the 'ant deploy-keystore' target with new version (not needed if deploying to same JBoss instance as the old version).</p>
</li><li class=" "><p   
>Run the 'ant web-configure' target with new version (not needed if deploying to same JBoss instance as the old version).</p>
</li><li class=" "><p   
>Clear the tmp and work directories in the servers, then restart JBoss.</p>
</li><li class=" "><p   
>If you are running in a cluster, you should now upgrade on all cluster nodes.<br/>The newly deployed nodes should be running now.</p>
</li><li class=" "><p   
>Restart JBoss to flush all caches.</p>
</li><li class=" "><p   
>Go into the Admin GUI and verify your settings.</p>
</li></ol><p  class="p1" 
>If you get a &quot;java.lang.NoSuchMethodError&quot; in the admin GUI it is because JBoss 5 does not clean temporary files very well.</p>
<p  class="p1" 
>Delete the directories JBOSS_HOME/server/default/tmp and JBOSS_HOME/server/default/work and restart JBoss to get it working.</p>
<p  class="p1" 
>If you are upgrading from EJBCA 4.x, you also need to run additional upgrade targets, see upgrade notes from EJBCA 4 to EJBCA 5.</p>
    </div>
    <div class="section section-2" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-BasicUpgradeProcedureforValidationAuthorities">
        <h2 class="heading p1"><span>Basic Upgrade Procedure for Validation Authorities</span></h2>
    <div class="section section-3" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-NotableChanges">
        <h3 class="heading p1"><span>Notable Changes</span></h3>
<p  class="p1" 
>The external Validation Authority build has been removed and external VA deployments are now full EJBCA deployments.</p>
<ul class="alternate "><li class=" "><p   
>Database privileges on the VA host must be the same as used by the CA (all tables must exist).</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Key-stores, certificates and trust-stores (both soft and HSM based) will be automatically converted on first startup.<br/>(or as soon as the password has been made available using clientToolBox if ocsp.activation.doNotStorePasswordsInMemory=true) to CryptoTokens and OcspKeyBindings.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Trusted certificates (ocsp.signtrustdir) must be imported in EJBCA as &quot;External CAs&quot;, for example using the &quot;bin/ejbca.sh ca importcacert&quot; command.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Health-check URL is now the same as for CA installations, and it will check the usability of ACTIVE OcspKeyBindings.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>OcspKeyBindings and CryptoTokens can still be managed without the AdminGUI using the EJB CLI (bin/ejbca.sh).</p>
</li></ul><ul class="alternate "><li class=" "><p   
>OCSP signing or re-keying certificates no longer need to be present in the HSM slot (migrated to the CertificateData table).</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Using a manually activated CryptoToken replaces the use of ocsp.activation.doNotStorePasswordsInMemory.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Behavior of OCSP responses (like untilNextUpdate etc) can now be configured per OcspKeyBinding.<br/>(Certificate Profile or URL specific settings in ocsp.properties has highest priority, then the OcspKeyBinding properties and finally the default configuration in ocsp.properties).</p>
</li></ul><ul class="alternate "><li class=" "><p   
>The re-keying key-store will be migrated to an AuthenticationKeyBinding.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Management of *KeyBindings and CryptoTokens will be audit logged. Configure it before the upgrade to have proper traceability from this point on.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>The 'ejbca.productionmode' property should be set to 'true' or 'false'. 'va' or 'ocsp' options are no longer supported.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Some configuration options in ocsp.properties have moved to (or been deprecated by) web.properties. You should migrate these configuration changes. You will be warned during build if you are using these options and have not migrated them.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Usage of Crypto Tokens, where you can configure multiple tokens to be used. The responder is not longer limited to one PKCS#11 configuration in ocsp.properties.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Usage of Internal Key Binding, where you can configure specific key pairs matching specific certificates in the database. This enables flexible and simple configuration of OCSP responder keys and certificates. It is no longer necessary to import the OCSP signer certificate into a slot on the HSM.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Usage of the Admin GUI. You can now use the EJBCA Admin GUI to manage Crypto Tokens and Key Bindings, making configuration and administration of the OCSP responder so much easier.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>The OCSP healthcheck has been integrated into the standard EJBCA healtcheck, so no separate call is required.</p>
</li></ul><p  class="p1" 
>All this means that the upgrade from an earlier version of EJBCA OCSP is a process. Naturally EJBCA 6 handles all the upgrade for you and will try to automatically import your old configuration seamlessly. To benefit from all the new features you should read the VA Installation, OCSP Installation and User Guide in the documentation.</p>
    </div>
    <div class="section section-3" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-UpgradeProcess">
        <h3 class="heading p1"><span>Upgrade Process</span></h3>
<p  class="p1" 
>1. Copy configuration files, database.properties, ocsp.properties and web.properties from your old installation.</p>
<p  class="p1" 
>2. Note that there can be some deprecated properties (j2ee.web-noconfigure). You will be notified of this during build.</p>
<p  class="p1" 
>3. Configure logging in conf/cesecore.properties if you do not want to audit log security events in the database (see OCSP Installation).</p>
<p  class="p1" 
>4. Build and configure the EJBCA VA as described in &quot;Standalone VA Installation&quot;.</p>
<p  class="p1" 
>5. When JBoss is started the first time new database tables will be created. These are the same tables as exist in an EJBCA installation. If your database user has restricted access, you can create the tables manually from the database scripts in doc/sql-scripts.</p>
<p  class="p1" 
>6. The next step involves creating OCSP Key Bindings, which are objects that represent an external OCSP responder.</p>
<p  class="p1" 
>a. If passwords are allowed to be store in memory (ocsp.activation.doNotStorePasswordsInMemory=true in ocsp.properties) then all key bindings are created automatically. When JBoss is started the first time your ocsp.properties will be read and upgraded into crypto tokens and ocsp key bindings. This will create objects in your database in the CryptoTokenData and InternalKeyBindingData. Also initial access rules will be created, see &quot;OCSP Installation&quot; for more information about this.</p>
<p  class="p1" 
>b. If passwords are not stored in memory, the slot has to be opened up. To do this, make a call via the OCSPActivate command in clientToolBox, and the internal key binding will be created automatically at the first call.</p>
<p  class="p1" 
>7. If you are requiring signed requests, verified by specific CAs, you need to import those CA certificates as &quot;External CAs&quot; in EJBCA, and configure the trust anchors in the OCSP Key Binding (use bin/ejbca.sh ca importcacert or the Admin GUI).</p>
    </div>
    <div class="section section-3" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-PostUpgrade">
        <h3 class="heading p1"><span>Post Upgrade</span></h3>
<p  class="p1" 
>Once all OCSP Responders have been recreated as OCSP Key Bindings and crypto tokens, the following properties can be removed from ocsp.properties</p>
<ul class=" "><li class=" "><p   
>ocsp.restrictsignatures</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.restrictsignaturesbymethod</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.signtrustdir</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.signtrustvalidtime</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.keys.dir</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.keys.storePassword</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.keys.keyPassword</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.activation.doNotStorePasswordsInMemory</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.p11.sharedLibrary</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.p11.sunConfigurationFile</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.p11.p11password</p>
</li></ul><ul class=" "><li class=" "><p   
>ocsp.p11.slot</p>
</li></ul>    </div>
    </div>
    <div class="section section-2" id="src-26772577_safe-id-aWQtLkVKQkNBNi4wVXBncmFkZU5vdGVzdjYuMTUuMS0xMDAlVXB0aW1lVXBncmFkZU5vdGVz">
        <h2 class="heading p1"><span>100% Uptime Upgrade Notes</span></h2>
    <div class="section section-3" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-UpgradingCryotoTokens">
        <h3 class="heading p1"><span>Upgrading CryotoTokens</span></h3>
<p  class="p1" 
>The CryptoToken concept has extended the internal CA Token concept. CA's now reference a named set of keys in a CryptoToken and CA Service and CryptoToken activation are clearly separated. Upgrades are made during first startup. Older EJBCA nodes will continue to function during a 100% up-time upgrade, as long as newer instances has been deployed with &quot;db.keepinternalcakeystores&quot; set to true. For 100% up-time upgrade, or possibilityto back out of upgrade, set db.keepinternalcakeystores to true (default is false).</p>
<p  class="p1" 
>Settings relevant for 100% up-time upgrades are:</p>
<ul class="alternate "><li class=" "><p   
>db.keepinternalcakeystores (5.0-&gt;5.2)</p>
</li></ul><ul class="alternate "><li class=" "><p   
>db.keepjbossserialization (4.0-&gt;5.0)</p>
</li></ul><ul class="alternate "><li class=" "><p   
>app.version.effective (3.11-&gt;4.0)</p>
</li></ul>    </div>
    <div class="section section-3" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-UpgradingtheOCSPCAExtendedService">
        <h3 class="heading p1"><span>Upgrading the OCSP CA Extended Service</span></h3>
<p  class="p1" 
>The service for running OCSP services on internal CAs has now become an integral part of the OCSP responder. For this reason, the old CA Extended Service will be removed at first upstart when a system has been upgraded from 5.0 to 6.0. The result of this is that for nodes sharing a database, those nodes that haven't been upgraded to 6.0 will lose OCSP services until they've been upgraded as well. In order to keep internal OCSP services running (external OCSP services are not affected) on the entire cluster during the whole upgrade process, set &quot;ca.keepocspextendedservice&quot; to 'true' for all nodes except the last one, which then finally remove the service from the database.</p>
<p  class="p1" 
>- ca.keepocspextendedservice (5.0 -&gt; 6.0)</p>
    </div>
    </div>
    <div class="section section-2" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-CMPConfigurationHandling">
        <h2 class="heading p1"><span>CMP Configuration Handling</span></h2>
<p  class="p1" 
>In EJBCA 6.0.0, the CMP configuration handling has been rewritten. CMP configurations are no longer read from conf/cmp.properties file, instead, CMP configurations can be set either in the admin GUI or in the command line (execute './bin/ejbca.sh config cmp' from EJBCA home directory for command line documentation). If you do use CMP, you can upload your old cmp.properties file by executing the following command in EJBCA home directory:</p>
<p  class="p1" 
>$ ./bin/ejbca.sh config cmp uploadfile --file conf/cmp.properties --alias cmp</p>
<p  class="p1" 
>In the adminGUI -&gt; CMP Configuration, you will see the alias 'cmp' among the list of CMP alias. This alias will contain all your old CMP</p>
<p  class="p1" 
>configurations (except for one, see next note) and should be used to manage your CMP configurations in the future.</p>
<p  class="p1" 
>For CMP users who use NestedMessageContent in RA mode and use EndEntityCertificate as an authentication module: if you now skip performing some verifications on the certificate in extraCert field by setting the authentication parameter of EndEntityCertificate to '-', this will no longer be possible in EJBCA 6.0.0. Instead, a new configuration variable should be set to reflect this option. After uploading the conf/cmp.properties file according to the instructions above, go to the admin GUI -&gt; CMP Configurations; in the page for editing the CMP alias 'cmp', check the box that says 'Omit Verifications in EndEntityCertificate Authentication Module'For CMP users who use KeyUpdateRequest in RA mode, in EJBCA 6.0.0, the authentication module EndEntityCertificate would have to be set among the configured authentication modules, otherwise, the request will fail.</p>
<p  class="p1" 
>In EJBCA 6.0.0, TCP configurations have been moved from conf/cmp.properties file (which has been removed) to conf/cmptcp.properties. So if you are using TCP (a deprecated protocol in EJBCA and the RFC), you should set your TCP configuration values in the new file. You should also upload conf/cmp.properties file according to the instructions above, and rename the alias 'cmp' to 'tcp'. See Admin Guide -&gt; CMP -&gt; 'CMP over TCP' and execute './bin/ejbca.sh config cmp' for details.</p>
    </div>
    <div class="section section-2" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-CLICommandsRenamed">
        <h2 class="heading p1"><span>CLI Commands Renamed</span></h2>
<p  class="p1" 
>CLI commands have been updated to reflect the new nomenclature introduced in EJBCA 5.0. This mainly involves the change of the command 'admins' -&gt; 'roles' (to reflect that Admin Groups have been renamed Roles) and to the subcommmands under 'ra' which have been renamed to reflect the name change from 'User' to 'End Entity' (e.g. adduser -&gt; addendentity). The old commands have been deprecated but are still functional, and may be removed entirely in a future version.</p>
    </div>
    <div class="section section-2" id="src-26772577_id-.EJBCA6.0UpgradeNotesv6.15.1-MiscellaneousIssues">
        <h2 class="heading p1"><span>Miscellaneous Issues</span></h2>
<ul class="alternate "><li class=" "><p   
>batchtool.properties is no longer searched for in bin/ but in conf/ instead. Note that everything in this file is commented out by default, so it can be removed if it hasn't been modified.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>In EJBCA 6.0.0 new versions of BouncyCastle jars are included. If you have been copying ejbca/lib/bc*.jar files to JBoss (jboss/server/default/lib), you must remove the old jars from JBoss and copy new jars from EJBCA.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>In EJBCA 6.0.0 the API for custom certificate extensions was changed. If you have created your own custom certificate extension java classes, you need to update the API with one new argument (can be null). There is no effect if you used standard custom extensions in the certextensions.properties, only custom java classes.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>In EJBCA 6.0.5 the Public Web interface logo filename was changed. If you have customized your own logo, you need to rename the logo filename from 'logotype.png' or 'ejbca_pki_by_primekey_logo.png' to 'banner_ejbca-public.png'.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>Starting with EJBCA 6.0.0 custom services and publishers are automatically detected using meta-data in the Jar files, and class names can no longer be specified manually. If you need to use old custom classes from before 6.0 (i.e. not autodetected classes) you can enable manual entry with the option web.manualclasspathsenabled=true in web.properties.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>The class CliAuthenticationToken and associated classes have been moved from the CLI module to reside next to the other authentication classes under src. This means that approval requests using the CliAuthenticationToken created in 5.0.x will not be forwards compatible.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>PKCS#11 libraries for presentation in the AdminGUI are auto-detected. If you have a library that is not automatically detected by EJBCA you can add it to the configuration. See web.properties.sample for PKCS#11 library auto-detection configuration.</p>
</li></ul><ul class="alternate "><li class=" "><p   
>HSM configuration options have been updated to support different slot reference types (slot id, index or label).</p>
</li></ul><p   
>See Admin Guide, databaseprotection.properties.sample, ocsp.properties.sample and catoken.properties.sample for information and examples how to update you current PKCS#11 configuration in these files. Configuration in the Admin GUI should be automatically upgraded.</p>
<ul class="alternate "><li class=" "><p   
>If you are using the default Hypersonic database in JBoss 5 for testing, you now need to configure this in database.properties. The default test database (when no database.properties is configured) is now H2 for JBoss 7/EAP6.</p>
</li></ul><hr>
<p   
></p>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="EJBCA_6.1_Upgrade_Notes.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>EJBCA 6.1 Upgrade Notes</span>
        </a>
                <a href="EJBCA_Upgrade_Notes_Summary.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>EJBCA Upgrade Notes Summary</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
