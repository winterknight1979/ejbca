<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>E-mail Notifications - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=16224401"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Operations.html">EJBCA Operations</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Concept_Guide.html">EJBCA Concept Guide</a></li>
                                                                                                         <li class="shortcut"><a href="End_Entities_Overview.html">End Entities Overview</a></li>
                                                                                     <li><a href="End_Entity_Profiles_Overview.html">End Entity Profiles Overview</a></li>
                                                            </ul>
</div>            <h1 id="src-16224401"> <span>E-mail Notifications</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>Mail settings in JBoss is created when running the 'ant deploy' or 'ant deploy-service' using the values specified in conf/mail.properties (or default). It is (automatically) configured in $APPSRV_HOME/server/default/deploy/ejbca-mail-service.xml for JBoss. For other containers you must create a mail service with the same JNDI name as specified in conf/mail.properties.</p>
    <div class="section section-1" id="src-16224401_id-.E-mailNotificationsv6.12.0-End_entity_email_notificationsEndEntityE-mailNotifications">
        <h1 class="heading "><span id="src-16224401_id-.E-mailNotificationsv6.12.0-End_entity_email_notifications" class="confluence-anchor-link"></span><span>End Entity E-mail Notifications</span></h1>
<p   
>Email notification can be sent when status changes for an end entity, for example when a new user is added (status changes to new).</p>
<p   
>To configure email notifications in EJBCA:</p>
<ol class=" "><li class=" "><p   
>You must create a new end-entity profile to be able to issue certificates to end users using email notifications. Under the RA functions, choose <strong class=" ">Edit End Entity Profiles</strong> and add a new profile. Select the profile and go into <strong class=" ">Edit End Entity profile</strong>. In this page you can Enable Send Notifications and create the notification message. Make sure the checkbox <strong class=" ">Use Send Notification</strong> is checked.</p>
</li><li class=" "><p   
>Add a new end entity. You must select the new end entity profile you created above. Make sure the checkbox <strong class=" ">Send Notification</strong> is checked. Enter the from-address and subject. Enter a message using the variables defined for dynamic substitution in the next section. Use ${NL} for newline in the mail message.</p>
</li></ol><p   
>The Notification Recipient can have a few different values:</p>
<ul class=" "><li class=" "><p   
>USER: send notification to the email registered for the end entity.</p>
</li><li class=" "><p   
>foo@bar.com: send notification to the specified email address. Multiple email addresses can be entered comma separated.</p>
</li><li class=" "><p   
>CUSTOM: plug-in mechanism to retrieve addresses your own way. See interface org.ejbca.core.model.ra.raadmin.ICustomNotificationRecipient for implementation details. Enter a string like &quot;CUSTOM:org.ejbca.MyCustomPluginClass&quot; to use.</p>
</li></ul><p   
>You can also use substitution variable in the notification sender and recipie/nt fields. See samples below.</p>
<p   
>The Notification Events specify which status changes for a user that will trigger a notification. The default values are suitable to send an email to a user when he/she should go and pick up a certificate. You can also select for example STATUSGENERATED to send email notifications to an administrator when the user picks up the certificate.</p>
<p   
>When STATUSREVOKED is selected, the notification will be triggered either if the entire user is revoked or if an individual certificate is revoked or re-activated (even though the End Entity's status will not change by the individual certificate revocation or re-activation).</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>If you configure autogenerated password in end entity profile you don't need to enter one in the adduser page. A generated one will automatically be sent with the email.</p>
<p   
>If you want to re-send a notification for a user, reset the status to NEW.</p>
        </div>
    </div>
    </div>
    <div class="section section-1" id="src-16224401_id-.E-mailNotificationsv6.12.0-DynamicSubstitutionVariablesDynamic_Substitution_Variables">
        <h1 class="heading "><span id="src-16224401_id-.E-mailNotificationsv6.12.0-Dynamic_Substitution_Variables" class="confluence-anchor-link"></span><span>Dynamic Substitution Variables </span></h1>
<p   
>Parameters that can be used with different usages of email notification. All parameters isn't always set, it depends on the input data.</p>
<p   
>The following parameters can be set:</p>
<ul class=" "><li class=" "><p   
>${NL} = New Line in message</p>
</li><li class=" "><p   
>${DATE} or ${current.DATE} = The current date</p>
</li></ul><p   
>Variables used with userdata:</p>
<ul class=" "><li class=" "><p   
>${USERNAME} or ${user.USERNAME} = The user's username.</p>
</li><li class=" "><p   
>${PASSWORD} or ${user.PASSWORD} = The user's password, or &quot;enrollment code&quot; as it is called in most pages in the public web.</p>
</li><li class=" "><p   
>${UID} or ${user.UID} = The user's unique identifier.</p>
</li><li class=" "><p   
>${CN} or ${user.CN} = The common name of the user.</p>
</li><li class=" "><p   
>${SN} or ${user.SN} = The serial number (in DN) of the user.</p>
</li><li class=" "><p   
>${O} or ${user.O} = The user's organization.</p>
</li><li class=" "><p   
>${OU} or ${user.OU} = The user's organizational unit.</p>
</li><li class=" "><p   
>${C} or ${user.C} = The user's country.</p>
</li><li class=" "><p   
>${user.E} = The user's email address from Subject DN.</p>
</li><li class=" "><p   
>${user.EE.EMAIL} = Ther user's email address from the End Entity data.</p>
</li><li class=" "><p   
>${user.SAN.EMAIL} = The user's email address from Subject Alternative Name, RFC822Name field.</p>
</li><li class=" "><p   
>${user.TIMECREATED} = The time the user was created.</p>
</li><li class=" "><p   
>${user.TIMEMODIFIED} = The time the user was modified.</p>
</li><li class=" "><p   
>${requestAdmin.CN} = The common name of the requesting administrator.</p>
</li><li class=" "><p   
>${requestAdmin.EE.EMAIL} = The email address of the administrator adding the end entity according to the administrator's End Entity data.</p>
</li><li class=" "><p   
>${requestAdmin.SAN.EMAIL} = The email address of the administrator adding the end entity according to the administrator's Subject Alternative Name, RFC822Name field.</p>
</li><li class=" "><p   
>${approvalAdmin.XX} variables from below can be used to get the administrator who adds an end entity.</p>
</li></ul><p   
>Variables used with approvals:</p>
<ul class=" "><li class=" "><p   
>${approvalAdmin.USERNAME} = The last approving administrator's username</p>
</li><li class=" "><p   
>${approvalAdmin.CN} = The common name of the last approving administrator.</p>
</li><li class=" "><p   
>${approvalAdmin.SN} = The last approving administrator's DN serialNumber.</p>
</li><li class=" "><p   
>${approvalAdmin.O} = The last approving administrator's organization</p>
</li><li class=" "><p   
>${approvalAdmin.OU} = The last approving administrator's organization unit</p>
</li><li class=" "><p   
>${approvalAdmin.C} = The last approving administrator's country</p>
</li><li class=" "><p   
>${approvalAdmin.E} = The last approving administrator's email address from Subject DN</p>
</li><li class=" "><p   
>${approvalRequestID} = The ID of the approval request that was created</p>
</li></ul><p   
>Variables used with expiring certificates:</p>
<ul class=" "><li class=" "><p   
>${expiringCert.CERTSERIAL} = The serial number of the certificate about to expire</p>
</li><li class=" "><p   
>${expiringCert.EXPIREDATE} = The date the certificate will expire</p>
</li><li class=" "><p   
>${expiringCert.CERTSUBJECTDN} = The certificate subject DN</p>
</li><li class=" "><p   
>${expiringCert.CERTISSUERDN} = The certificate issuer DN</p>
</li></ul><p   
>Variables used with revocation or re-activation of individual End Entity certificates:</p>
<ul class=" "><li class=" "><p   
>${revokedCertificate.CERTSERIAL} = The serial number of the revoked certificate</p>
</li><li class=" "><p   
>${revokedCertificate.EXPIREDATE} = The date the revoked certificate will expire</p>
</li><li class=" "><p   
>${revokedCertificate.CERTSUBJECTDN} = The certificate subject DN</p>
</li><li class=" "><p   
>${revokedCertificate.CERTISSUERDN} = The certificate issuer DN</p>
</li><li class=" "><p   
>${revokedCertificate.REVOCATIONSTATUS} = The new revocation status of the certificate (Active/Revoked)</p>
</li><li class=" "><p   
>${revokedCertificate.REVOCATIONREASON} = The new revocation reason of the certificate (unspecified, keyCompromise, ...)</p>
</li></ul>    </div>
    <div class="section section-1" id="src-16224401_id-.E-mailNotificationsv6.12.0-ExamplesExamples">
        <h1 class="heading "><span id="src-16224401_id-.E-mailNotificationsv6.12.0-Examples" class="confluence-anchor-link"></span><span>Examples</span></h1>
<p   
>In certain circumstances, e.g. when you need to comply with PCI or the lighter levels of FIPS-140/160, it may be required to configure a 2 step issuance process. This can by done by using the notifications. Create 3 email notifications:</p>
<ol class=" "><li class=" "><p   
>To: USER<br/>Email notification to <del class=" ">just</del> the user with the URL to pick up the cert and the username. Make clear in the message that he or she will be contacted by the approving admin with the password.</p>
</li><li class=" "><p   
>To: ${approvalAdmin.E}<br/>Email notification to the apporiving admin with the password (but not the username) and a message which makes clear that this password is to be passed to the user - by phone or f2f (but not by email).</p>
</li><li class=" "><p   
>To: ca-team@foo... **<br/>Email notification of the issuing to the auditor mailing lists - without above username/password.</p>
</li></ol>    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="End_Entity_Profiles_Overview.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>End Entity Profiles Overview</span>
        </a>
                <a href="Self_Registration.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Self Registration</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
