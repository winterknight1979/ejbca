<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Logging - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=23858529"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Operations.html">EJBCA Operations</a></li>
                                                                                     <li><a href="EJBCA_Concept_Guide.html">EJBCA Concept Guide</a></li>
                                                            </ul>
</div>            <h1 id="src-23858529"> <span>Logging</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-SecurityAuditLogSecurity_Audit_Log">Security Audit Log</a></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-23858529_safe-id-aWQtLkxvZ2dpbmd2Ni4xNS4wLVNlcnZpY2VzLE1vZHVsZXMsRXZlbnRzYW5kU3RhdHVzU2VydmljZXMsX01vZHVsZXMsX0V2ZW50c19hbmRfU3RhdHVz">Services, Modules, Events and Status</a></p>
</li><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-Log4JLogDeviceLog4JLogDevice">Log4JLogDevice</a></p>
</li><li class=" "><p   
><a   href="#src-23858529_safe-id-aWQtLkxvZ2dpbmd2Ni4xNS4wLUludGVncml0eVByb3RlY3RlZERldmljZUludGVncml0eVByb3RlY3RlZERldmljZV8oRUpCQ0FfRW50ZXJwcmk">IntegrityProtectedDevice</a></p>
</li><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-OldLogDeviceOldLogDevice">OldLogDevice</a></p>
</li></ul></li><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-SystemLogSystem_Log">System Log</a></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-LoggingtoSyslog">Logging to Syslog</a></p>
</li></ul></li><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-LogSigningLog_Signing">Log Signing</a></p>
</li><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-ExportingAuditLogs">Exporting Audit Logs</a></p>
</li><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-LogMonitoring">Log Monitoring</a></p>
</li><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-IntegratingwithaSIEM">Integrating with a SIEM</a></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-23858529_id-.Loggingv6.15.0-Graylog">Graylog</a></p>
</li></ul></li></ul><p   
><span id="src-23858529_id-.Loggingv6.15.0-Security_Audit_log_vs_System_log"></span></p>
<p   
>A PKI system has the following types of logs:</p>
<ul class=" "><li class=" "><p   
>Security Audit Log: Used for PKI auditors to audit important security PKI events that the system performs.</p>
</li><li class=" "><p   
>System Log: Used to monitor daily operations in the system, debug and track down errors etc.</p>
</li><li class=" "><p   
>Transaction Log: Used for accounting of specific functions, mainly validation (OCSP).</p>
</li></ul><p   
>The Security Audit Log specifies in detail what it logs and does not log any other events. The Security Audit log logs important events such as &quot;Certificate issued&quot;, &quot;Certificate Profile edited&quot;, &quot;Administrator accessed resource&quot;. One of the most important aspects to consider is that the Security Audit log does <strong class=" "><i class=" ">not</i></strong> log things that do not happen. Things that do not happen are for example invalid requests that the system rejects, because the PKI system did not perform any important auditable event.</p>
<p   
>The System Log logs all events that are interesting to monitor, such as rejecting invalid requests, reading profiles etc.</p>
<p   
>The main purpose of the Security Audit Log is to provide information to an auditor, and the auditor wants to know what the system has done, what certificates were issued etc, but is not so interested in what the system did not do.</p>
<p   
>The Security Audit Log is stored in the database and the System Log is stored in log files. By default the System Log also contains the Security Audit Log, but this can be configured.</p>
<p   
>For more information on the OCSP Transaction Log, see <a   href="OCSP.html">Audit and Account Logging</a> and for information on the WS Transaction Log, see <a   href="Web_Service_Interface.html">Web Service Interface</a>.</p>
    <div class="section section-1" id="src-23858529_id-.Loggingv6.15.0-SecurityAuditLogSecurity_Audit_Log">
        <h1 class="heading "><span id="src-23858529_id-.Loggingv6.15.0-Security_Audit_Log" class="confluence-anchor-link"></span><span>Security Audit Log </span></h1>
<p   
>The are different logging devices available for official security audit events (creation of certificate etc) and the log device to use is configured in conf/cesecore.properties.</p>
<p   
>These devices should not be confused with the info/debug output that is sent to Log4J directly. You can find more information on how to configure Log4J in doc/howto/log4j.txt.</p>
<p   
>It is recommended to only allow new log posts to the database tables. For more information, refer to doc/howto/HOWTO-database.txt.</p>
    <div class="section section-2" id="src-23858529_safe-id-aWQtLkxvZ2dpbmd2Ni4xNS4wLVNlcnZpY2VzLE1vZHVsZXMsRXZlbnRzYW5kU3RhdHVzU2VydmljZXMsX01vZHVsZXMsX0V2ZW50c19hbmRfU3RhdHVz">
        <h2 class="heading "><span id="src-23858529_safe-id-aWQtLkxvZ2dpbmd2Ni4xNS4wLVNlcnZpY2VzLF9Nb2R1bGVzLF9FdmVudHNfYW5kX1N0YXR1cw" class="confluence-anchor-link"></span><span>Services, Modules, Events and Status </span></h2>
<p   
>The security audit events are divided into Services, Modules, Events according to from where it originates. The full list of the different Service, Module and Event types and a short explanation for each type can be found in <a  class="external-link" href="https://www.ejbca.org/docs/logtypes/index.html">JavaDoc format of the API</a>. Since EJBCA is built around the CESeCore project, to see all possible event types that EJBCA can generate both <a  class="external-link" href="https://www.ejbca.org/docs/logtypes/org/cesecore/audit/enums/EventTypes.html">EventTypes </a>and <a  class="external-link" href="https://www.ejbca.org/docs/logtypes/org/ejbca/core/ejb/audit/enums/EjbcaEventTypes.html">EjbcaEventTypes </a>in the API doc needs to be considered.</p>
<p   
>An example of how such an event would look like in the server log using the Log4jDevice is the event that the application is starting:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">... INFO  [Log4jDevice] 2015-03-20 12:47:51+01:00;EJBCA_STARTING;SUCCESS;SERVICE;EJBCA;StartServicesServlet.init;;hostname;;msg=Init, EJBCA 6.3.1Alpha (working copy) startup.</code></div>
</div>
    </div>
<p   
>and the same kind of event using IntegrityProtectedDevice that writes the log entry to the database:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">mysql&gt; select * from AuditRecordData where eventType='EJBCA_STARTING' ... \G</code></div>
<div class="line"><code class="plain">               pk: 24861ebf7f00010106e5a024d82c694d</code></div>
<div class="line"><code class="plain">additionalDetails: ...  Init, EJBCA 6.3.1Alpha (working copy) startup.  ...</code></div>
<div class="line"><code class="plain">        authToken: StartServicesServlet.init</code></div>
<div class="line"><code class="plain">         customId: NULL</code></div>
<div class="line"><code class="plain">      eventStatus: SUCCESS</code></div>
<div class="line"><code class="plain">        eventType: EJBCA_STARTING</code></div>
<div class="line"><code class="plain">           module: SERVICE</code></div>
<div class="line"><code class="plain">           nodeId: hostname</code></div>
<div class="line"><code class="plain">    rowProtection: 1:2:123:4d2f6...</code></div>
<div class="line"><code class="plain">       rowVersion: 0</code></div>
<div class="line"><code class="plain">    searchDetail1: hostname</code></div>
<div class="line"><code class="plain">    searchDetail2: NULL</code></div>
<div class="line"><code class="plain">   sequenceNumber: 17640195</code></div>
<div class="line"><code class="plain">          service: EJBCA</code></div>
<div class="line"><code class="plain">        timeStamp: 1426205614754</code></div>
</div>
    </div>
<p   
>This should be interpreted as the following:</p>
<ul class=" "><li class=" "><p   
>Service is EJBCA (not shown in the Admin GUI) : the event originates from the part of the application that not part of the core shared with other projects.</p>
</li><li class=" "><p   
>Module is SERVICE: this event was generated from a module in EJBCA that is responsible for background services.</p>
</li><li class=" "><p   
>Event is EJBCA_STARTING: the application EJBCA is starting up.</p>
</li><li class=" "><p   
>Status (named <strong class=" ">Outcome</strong> in the Admin GUI) is SUCCESS: in the context of the event, this should be interpreted as no error were detected during the EJBCA startup.</p>
</li><li class=" "><p   
>Additionally there is an event specific message with additional information telling us (in this case) the version of EJBCA that was started.</p>
</li></ul><p   
>Also note that the time in the log entry itself is the time of the event and might differ from the time when this was written to the server log.</p>
<p   
>Other references:</p>
<ul class=" "><li class=" "><p   
>Security information about the Database Integrity Protection. For more information, see <a   href="EJBCA_Security.html">EJBCA Security</a>.</p>
</li><li class=" "><p   
><a   href="Command_Line_Interfaces.html">Local Database CLI</a> to verify protection and export/import data.</p>
</li><li class=" "><p   
>For information about the security features and possibilities to repair gaps, see <a   href="EJBCA_Security.html">EJBCA Security</a>.</p>
</li></ul>    </div>
    <div class="section section-2" id="src-23858529_id-.Loggingv6.15.0-Log4JLogDeviceLog4JLogDevice">
        <h2 class="heading "><span id="src-23858529_id-.Loggingv6.15.0-Log4JLogDevice" class="confluence-anchor-link"></span><span>Log4JLogDevice </span></h2>
<p   
>Appends the information from the official event to the console or file. This is the same target where all the other info/debug output is sent to. There is no protection from alteration and events sent to this device cannot be fetched back to EJBCA for display in the Admin GUI.</p>
    </div>
    <div class="section section-2" id="src-23858529_safe-id-aWQtLkxvZ2dpbmd2Ni4xNS4wLUludGVncml0eVByb3RlY3RlZERldmljZUludGVncml0eVByb3RlY3RlZERldmljZV8oRUpCQ0FfRW50ZXJwcmk">
        <h2 class="heading "><span id="src-23858529_safe-id-aWQtLkxvZ2dpbmd2Ni4xNS4wLUludGVncml0eVByb3RlY3RlZERldmljZV8oRUpCQ0FfRW50ZXJwcmk" class="confluence-anchor-link"></span><span>IntegrityProtectedDevice </span></h2>
<p   
></p>
<p   
><span class="status blue " >ENTERPRISE</span>
 This is an EJBCA Enterprise feature.</p>
<p   
>The integrity protected log device stores audit record in the AuditRecordData table in the database. The record can be protected using either HMAC or digital signatures. See conf/cesecore.properties for configuration options. For more information on Database Integrity Protection, see <a   href="EJBCA_Security.html">EJBCA Security</a>.</p>
    </div>
    <div class="section section-2" id="src-23858529_id-.Loggingv6.15.0-OldLogDeviceOldLogDevice">
        <h2 class="heading "><span id="src-23858529_id-.Loggingv6.15.0-OldLogDevice" class="confluence-anchor-link"></span><span>OldLogDevice</span></h2>
<p   
>The old log device, as it was called in EJBCA 4.0 is no longer available.</p>
<p   
>From EJBCA 5.0 the LogEntryData table is no longer used for audit log. The existing log entries can be exported using by using a small export CLI.</p>
<p   
>Configure conf/database.properties with (if not done already):<br/>database.url=... database.username=... database.password=... then build with $ ant oldlogexport-cli</p>
<p   
>This will create the CLI in &quot;dist/oldlogexport-cli/&quot;. Refer to the README file in this directory for further instructions on how to run it.</p>
<p   
>OldLogDevice stores log-events in the database. Viewed events can be exported from the Admin GUI.</p>
    </div>
    </div>
    <div class="section section-1" id="src-23858529_id-.Loggingv6.15.0-SystemLogSystem_Log">
        <h1 class="heading "><span id="src-23858529_id-.Loggingv6.15.0-System_Log" class="confluence-anchor-link"></span><span>System Log </span></h1>
<p   
>The system log is logged using Log4J and has several configurable log levels:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">ERROR</strong>: Errors that should cause the IT staff to look into the system. It could be fatal, causing the system to stop working.</p>
</li><li class=" "><p   
><strong class=" ">WARNING</strong>: Warnings about misconfiguration. The system is still working, but functionality could be degraded.</p>
</li><li class=" "><p   
><strong class=" ">INFO</strong>: Informational messages that are interesting for monitoring purposes and statistic purposes.</p>
</li><li class=" "><p   
><strong class=" ">DEBUG</strong>: Debug information useful to see details of what is happening in the system.</p>
</li><li class=" "><p   
><strong class=" ">TRACE</strong>: Trace information that can be useful to track down bugs or small misconfigurations. Very rich output showing detailed trace of what happens in the system code.</p>
</li></ul><p   
>System log configuration is dependent on the application server used, see <a   href="Installation_Instructions.html">Installation Instructions</a>. It is recommended to configure logging in the application server, i.e. JBoss.</p>
<p   
>In JBoss you can easily enable and disable DEBUG logging and switch back to INFO logging at runtime. To configure the DEBUG log level the first time, run the following JBoss CLI commands:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem=logging/logger=org.ejbca:add</code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore:add</code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.ejbca:write-attribute(name=level, value=DEBUG)</code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore:write-attribute(name=level, value=DEBUG)</code></div>
</div>
    </div>
<p   
>You can later switch between DEBUG and INFO logging at runtime, for example to specify INFO logging (normal production level):</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem=logging/logger=org.ejbca:write-attribute(name=level, value=INFO)</code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore:write-attribute(name=level, value=INFO) </code></div>
</div>
    </div>
<p   
>In JBoss 7/EAP6/WildFly10, you can configure the logging section of <tt class=" ">standalone.xml.</tt></p>
<p   
>The following displays an example of a configuration specifying a more advanced logger, logging of EJBCA events to a separate ejbca.log log file that rotates by size every 32MB, and keeping maximum 31 rotated log files:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">subsystem</code><code class="plain"> </code><code class="color1">xmlns</code><code class="plain">=</code><code class="string">"urn:jboss:domain:logging:3.0"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">console</code><code class="plain">-handler </code><code class="color1">name</code><code class="plain">=</code><code class="string">"CONSOLE"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"INFO"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">formatter</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">            &lt;</code><code class="keyword">named</code><code class="plain">-formatter </code><code class="color1">name</code><code class="plain">=</code><code class="string">"COLOR-PATTERN"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;/</code><code class="keyword">formatter</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">console</code><code class="plain">-handler&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">periodic</code><code class="plain">-rotating-file-handler </code><code class="color1">name</code><code class="plain">=</code><code class="string">"FILE"</code><code class="plain"> </code><code class="color1">autoflush</code><code class="plain">=</code><code class="string">"true"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">formatter</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">            &lt;</code><code class="keyword">named</code><code class="plain">-formatter </code><code class="color1">name</code><code class="plain">=</code><code class="string">"PATTERN"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;/</code><code class="keyword">formatter</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">file</code><code class="plain"> </code><code class="color1">relative-to</code><code class="plain">=</code><code class="string">"jboss.server.log.dir"</code><code class="plain"> </code><code class="color1">path</code><code class="plain">=</code><code class="string">"server.log"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">suffix</code><code class="plain"> </code><code class="color1">value</code><code class="plain">=</code><code class="string">".yyyy-MM-dd"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">append</code><code class="plain"> </code><code class="color1">value</code><code class="plain">=</code><code class="string">"true"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">periodic</code><code class="plain">-rotating-file-handler&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">size</code><code class="plain">-rotating-file-handler </code><code class="color1">name</code><code class="plain">=</code><code class="string">"EJBCAFILE"</code><code class="plain"> </code><code class="color1">autoflush</code><code class="plain">=</code><code class="string">"true"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">formatter</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">            &lt;</code><code class="keyword">pattern</code><code class="plain">-formatter </code><code class="color1">pattern</code><code class="plain">=</code><code class="string">"%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;/</code><code class="keyword">formatter</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">file</code><code class="plain"> </code><code class="color1">relative-to</code><code class="plain">=</code><code class="string">"jboss.server.log.dir"</code><code class="plain"> </code><code class="color1">path</code><code class="plain">=</code><code class="string">"ejbca.log"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">rotate</code><code class="plain">-size </code><code class="color1">value</code><code class="plain">=</code><code class="string">"32M"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">max</code><code class="plain">-backup-index </code><code class="color1">value</code><code class="plain">=</code><code class="string">"31"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">append</code><code class="plain"> </code><code class="color1">value</code><code class="plain">=</code><code class="string">"true"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">size</code><code class="plain">-rotating-file-handler&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">logger</code><code class="plain"> </code><code class="color1">category</code><code class="plain">=</code><code class="string">"com.arjuna"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"WARN"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">logger</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">logger</code><code class="plain"> </code><code class="color1">category</code><code class="plain">=</code><code class="string">"org.jboss.as.config"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"DEBUG"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">logger</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">logger</code><code class="plain"> </code><code class="color1">category</code><code class="plain">=</code><code class="string">"sun.rmi"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"WARN"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">logger</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">logger</code><code class="plain"> </code><code class="color1">category</code><code class="plain">=</code><code class="string">"org.ejbca"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"DEBUG"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">handlers</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">            &lt;</code><code class="keyword">handler</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"EJBCAFILE"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;/</code><code class="keyword">handlers</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">logger</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">logger</code><code class="plain"> </code><code class="color1">category</code><code class="plain">=</code><code class="string">"org.cesecore"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"DEBUG"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">handlers</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">            &lt;</code><code class="keyword">handler</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"EJBCAFILE"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;/</code><code class="keyword">handlers</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">logger</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">root</code><code class="plain">-logger&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"INFO"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">handlers</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">            &lt;</code><code class="keyword">handler</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"CONSOLE"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">            &lt;</code><code class="keyword">handler</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"FILE"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;/</code><code class="keyword">handlers</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">root</code><code class="plain">-logger&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">formatter</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"PATTERN"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">pattern</code><code class="plain">-formatter </code><code class="color1">pattern</code><code class="plain">=</code><code class="string">"%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">formatter</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">formatter</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"COLOR-PATTERN"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">pattern</code><code class="plain">-formatter </code><code class="color1">pattern</code><code class="plain">=</code><code class="string">"%K{level}%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">formatter</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">subsystem</code><code class="plain">&gt;</code></div>
</div>
    </div>
    <div class="section section-2" id="src-23858529_id-.Loggingv6.15.0-LoggingtoSyslog">
        <h2 class="heading "><span>Logging to Syslog</span></h2>
<p   
>You can configure JBoss/WildFly to log to syslog and there are different configurations you can use.</p>
<p   
>The following shows an example for JBoss EAP7/WildFly 10+ to log to a remote syslog server, using syslog on TCP port 514. You can tweak the settings to suit different syslog servers.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;custom-handler name=</code><code class="string">"SYSLOGTCP"</code><code class="plain"> </code><code class="keyword">class</code><code class="plain">=</code><code class="string">"org.jboss.logmanager.handlers.SyslogHandler"</code><code class="plain"> module=</code><code class="string">"org.jboss.logmanager"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;level name=</code><code class="string">"INFO"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;encoding value=</code><code class="string">"ISO-8859-1"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;formatter&gt;</code></div>
<div class="line"><code class="plain">        &lt;pattern-formatter pattern=</code><code class="string">"%-5p [%c] (%t) %s%E%n"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/formatter&gt;</code></div>
<div class="line"><code class="plain">    &lt;properties&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"appName"</code><code class="plain"> value=</code><code class="string">"EJBCA"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"facility"</code><code class="plain"> value=</code><code class="string">"LOCAL_USE_5"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"serverHostname"</code><code class="plain"> value=</code><code class="string">"syslogserver-at.mydomain.com"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"hostname"</code><code class="plain"> value=</code><code class="string">"-"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"port"</code><code class="plain"> value=</code><code class="string">"514"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"syslogType"</code><code class="plain"> value=</code><code class="string">"RFC5424"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"protocol"</code><code class="plain"> value=</code><code class="string">"TCP"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"messageDelimiter"</code><code class="plain"> value=</code><code class="string">"-"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"useMessageDelimiter"</code><code class="plain"> value=</code><code class="string">"true"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/properties&gt;</code></div>
<div class="line"><code class="plain">&lt;/custom-handler&gt;</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-23858529_id-.Loggingv6.15.0-LogSigningLog_Signing">
        <h1 class="heading "><span id="src-23858529_id-.Loggingv6.15.0-Log_Signing" class="confluence-anchor-link"></span><span>Log Signing </span></h1>
<p   
>Log signing requirements (signed log files) can be fulfilled in a number of ways. For example:</p>
<ul class=" "><li class=" "><p   
>Using the built in EJBCA Database Integrity Protection. For more information, see <a   href="EJBCA_Security.html">EJBCA Security</a>.</p>
</li><li class=" "><p   
>Signing logs using external logs as they are being rotated. For more information, see <strong class=" ">External Log Signing</strong> in <a   href="EJBCA_Security.html">EJBCA Security</a>.</p>
</li></ul>    </div>
    <div class="section section-1" id="src-23858529_id-.Loggingv6.15.0-ExportingAuditLogs">
        <h1 class="heading "><span>Exporting Audit Logs</span></h1>
<p   
>All installations have their specific requirements for how audit logs should be handled. There are a number of ways to Export Audit Logs:</p>
<ul class=" "><li class=" "><p   
>Rotate system log files (including the audit log) and archive/process the rotated log files</p>
</li><li class=" "><p   
>Use a SYSLOG appended to send the System log (including the Audit log) to a central log server that performs monitoring functions</p>
</li><li class=" "><p   
>Export the database audit log using the Local Database CLI</p>
</li><li class=" "><p   
>Export the database audit log using database tools</p>
</li><li class=" "><p   
>Export a specific view from the View Log page in Admin GUI to an XML file</p>
</li><li class=" "><p   
>Export a specific view from the View Log page in Admin GUI to a signed CMS (Cryptographic Message Syntax)</p>
</li></ul>    </div>
    <div class="section section-1" id="src-23858529_id-.Loggingv6.15.0-LogMonitoring">
        <h1 class="heading "><span>Log Monitoring</span></h1>
<p   
>When monitoring logs from EJBCA, the common trigger to monitor is ERROR events in the System Log.</p>
<p   
>For example, if there is an error to initialize an HSM during startup:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">10:46:53,099 ERROR [org.cesecore.keys.token.p11.Pkcs11Wrapper] (default task-9) Wrong arguments were passed to sun.security.pkcs11.wrapper.PKCS11.CK_C_INITIALIZE_ARGS.getInstance threw an exception</code></div>
</div>
    </div>
<p   
>An error event like this should trigger an operator to inspect the system to investigate the issue.</p>
    </div>
    <div class="section section-1" id="src-23858529_id-.Loggingv6.15.0-IntegratingwithaSIEM">
        <h1 class="heading "><span>Integrating with a SIEM</span></h1>
<p   
>You can integrate EJBCA with a Security Information and Event Management (SIEM) software by sending logs to it.</p>
    <div class="section section-2" id="src-23858529_id-.Loggingv6.15.0-Graylog">
        <h2 class="heading "><span>Graylog</span></h2>
<p   
><a  class="external-link" href="https://www.graylog.org/">Graylog</a> can consume syslog, and other log formats. The following sections list steps required to send syslog traffic to Graylog and configure it to visualize some interesting statistics.</p>
    <div class="section section-3" id="src-23858529_id-.Loggingv6.15.0-InstallGraylog">
        <h3 class="heading "><span>Install Graylog</span></h3>
<p   
>The first step is to install Graylog. You can get started quickly for testing by starting up a machine in AWS using the AMI, using the OVA VM, or using Docker containers. For more information, refer to the Graylog documentation on <a  class="external-link" href="http://docs.graylog.org/en/2.4/pages/getting_started/download_install.html">Download &amp; Install Graylog</a>.</p>
    </div>
    <div class="section section-3" id="src-23858529_id-.Loggingv6.15.0-EnableSyslogTCPinput">
        <h3 class="heading "><span>Enable Syslog TCP input</span></h3>
<p   
>This example uses syslog over TCP. To enable using syslog TCP input in Graylog, do the following:</p>
<ol class=" "><li class=" "><p   
>Go to the Graylog Web Console and select <strong class=" ">System &gt; Input</strong>.</p>
</li><li class=" "><p   
>Select <strong class=" ">Syslog TCP</strong> in the <strong class=" ">Select Input</strong> list menu and click <strong class=" ">Launch new input</strong>.</p>
</li></ol>    </div>
    <div class="section section-3" id="src-23858529_id-.Loggingv6.15.0-ConfigureEJBCALogging">
        <h3 class="heading "><span>Configure EJBCA Logging</span></h3>
<p   
>On the EJBCA server, configure WildFly to send messages to Graylog with syslog TCP. This is done by adding the following section in the logging subsystem in the JBoss/WildFly <tt class=" ">standalone.xml:</tt></p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;custom-handler name=</code><code class="string">"SYSLOGTCP"</code><code class="plain"> </code><code class="keyword">class</code><code class="plain">=</code><code class="string">"org.jboss.logmanager.handlers.SyslogHandler"</code><code class="plain"> module=</code><code class="string">"org.jboss.logmanager"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;level name=</code><code class="string">"INFO"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;encoding value=</code><code class="string">"ISO-8859-1"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;formatter&gt;</code></div>
<div class="line"><code class="plain">        &lt;pattern-formatter pattern=</code><code class="string">"%-5p [%c] (%t) %s%E%n"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/formatter&gt;</code></div>
<div class="line"><code class="plain">    &lt;properties&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"appName"</code><code class="plain"> value=</code><code class="string">"WildFly"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"facility"</code><code class="plain"> value=</code><code class="string">"LOCAL_USE_5"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"serverHostname"</code><code class="plain"> value=</code><code class="string">"ec2-52-72-41-146.compute-1.amazonaws.com"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"hostname"</code><code class="plain"> value=</code><code class="string">"-"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"port"</code><code class="plain"> value=</code><code class="string">"514"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"syslogType"</code><code class="plain"> value=</code><code class="string">"RFC5424"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"protocol"</code><code class="plain"> value=</code><code class="string">"TCP"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"messageDelimiter"</code><code class="plain"> value=</code><code class="string">"-"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;property name=</code><code class="string">"useMessageDelimiter"</code><code class="plain"> value=</code><code class="string">"true"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/properties&gt;</code></div>
<div class="line"><code class="plain">&lt;/custom-handler&gt;</code></div>
</div>
    </div>
<p   
>You also need to configure the root-logger to use the new handler, this will start sending the same logs to syslog. Add the new handler by modifying the root-loggers section in <tt class=" ">standalone.xml:</tt></p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;root-logger&gt;</code></div>
<div class="line"><code class="plain">    &lt;level name=</code><code class="string">"INFO"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;handlers&gt;</code></div>
<div class="line"><code class="plain">        &lt;handler name=</code><code class="string">"CONSOLE"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;handler name=</code><code class="string">"FILE"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;handler name=</code><code class="string">"SYSLOGTCP"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;/handlers&gt;</code></div>
<div class="line"><code class="plain">&lt;/root-logger&gt;</code></div>
</div>
    </div>
<p   
>You can limit the logging further to only include the audit log, by configuring to only send events from <tt class=" ">org.cesecore.audit.impl.log4j.Log4jDevice</tt> to the syslog handler. This may be good if your main interest is statistics, but you will then miss things like Exceptions in the log.</p>
<p   
>Send some log items by performing an action in the EJBCA Admin UI, for example saving a certificate profile.</p>
    </div>
    <div class="section section-3" id="src-23858529_id-.Loggingv6.15.0-CreateGraylogExtractors">
        <h3 class="heading "><span>Create Graylog Extractors</span></h3>
<p   
>Graylog <i class=" ">Extractors</i> are used to extract fields, that can be used in queries in Graylog, from the log stream. Create extractors for your log input under <strong class=" ">System &gt; Input</strong> in the Graylog Web Console.</p>
<p   
>You can analyze log items and create the extractors you need. In our example, the following extractors are created:</p>
<ul class=" "><li class=" "><p   
>RADN: An administrators DN who issued a certificate, for example 'CN=RA Admin,O=PrimeKey,C=SE'</p>
<ul class=" "><li class=" "><p   
>Extractor type: Split &amp; Index</p>
</li><li class=" "><p   
>Split by: ;</p>
</li><li class=" "><p   
>Target index: 6</p>
</li></ul></li><li class=" "><p   
>EVENT: The event that happened, for example 'CERT_CREATION'</p>
<ul class=" "><li class=" "><p   
>Extractor type: Split &amp; Index</p>
</li><li class=" "><p   
>Split by: ;</p>
</li><li class=" "><p   
>Target index: 2</p>
</li></ul></li><li class=" "><p   
>CERTPROFILE: the certificate profile a certificate was issued for, for example 'certprofile=346136222'</p>
<ul class=" "><li class=" "><p   
>Extractor type: Split &amp; Index</p>
</li><li class=" "><p   
>Split by: ;</p>
</li><li class=" "><p   
>Target index: 11</p>
</li></ul></li></ul><p   
>You can edit and create extractors of many different types, the above are simple examples.</p>
<p   
></p>
<p  class="tw-data-text tw-ta tw-text-small" 
>Once the extractors have been created, go to EJBCA and make some actions to log something you want to     <span style="color: #000000;">
visualize. For example, running the stresstest <i class=" ">clientToolBox stress</i> to issue a bunch of certificates, by different RAs.    </span>
</p>
    </div>
    <div class="section section-3" id="src-23858529_id-.Loggingv6.15.0-CreateGraylogDashboard">
        <h3 class="heading "><span>Create Graylog Dashboard</span></h3>
<p   
>Graylog dashboards allows you to build pre-defined views and visualize your data.</p>
<p   
>To create a new Graylog Dashboard, do the following:</p>
<ol class=" "><li class=" "><p   
>Go to the Dashboards section and click <strong class=" ">Create dashboard</strong> to create a new dashboard called <strong class=" ">EJBCA stats</strong>.</p>
</li><li class=" "><p   
>Go to <strong class=" ">Search</strong> and create some searches for your dashboard.</p>
</li></ol>    </div>
    <div class="section section-3" id="src-23858529_id-.Loggingv6.15.0-AddandVisualizeSearchesonDashboard">
        <h3 class="heading "><span>Add and Visualize Searches on Dashboard</span></h3>
<p   
>The following provides examples of search result information that you can add to your dashboard. This screenshot displays a dashboard with the search examples added and shows some sample test data:</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/23858529/graylog2.png" alt="images/download/attachments/23858529/graylog2.png"  height="250" />
    </p>
<p   
>Note that the examples may not suite your needs. For example, searching for <strong class=" ">all time</strong> may not be suitable if you have very large datasets, and will not give correct numbers if you start using Graylog when you have already run EJBCA for a while (thus it will not show <strong class=" ">all time</strong> since EJBCA was installed).</p>
<p   
>Examples of search result information to visualize:</p>
<ul class=" "><li class=" "><p   
>CERT_CREATION last day</p>
<ul class=" "><li class=" "><p   
>Search in the last 1 day</p>
</li><li class=" "><p   
>EVENT:CERT_CREATION</p>
</li><li class=" "><p   
>Click <strong class=" ">Add count to dashboard</strong></p>
</li></ul></li><li class=" "><p   
>CERT_REVOKED last day</p>
<ul class=" "><li class=" "><p   
>Search in the last 1 day</p>
</li><li class=" "><p   
>EVENT:CERT_REVOKED</p>
</li><li class=" "><p   
>Click <strong class=" ">Add count to dashboard</strong></p>
</li></ul></li><li class=" "><p   
>Certs issued by SuperAdmin all time</p>
<ul class=" "><li class=" "><p   
>Search in all messages</p>
</li><li class=" "><p   
>EVENT:CERT_CREATION AND RADN:CN=SuperAdmin</p>
</li><li class=" "><p   
>Click <strong class=" ">Add count to dashboard</strong></p>
</li></ul></li><li class=" "><p   
>Certs per RA</p>
<ul class=" "><li class=" "><p   
>Search in all messages</p>
</li><li class=" "><p   
>EVENT:CERT_CREATION</p>
</li><li class=" "><p   
>Select <strong class=" ">RADN</strong> and click to expand, click <strong class=" ">Quick values</strong>, and then <strong class=" ">Add to dashboard </strong>when you see the graph.</p>
</li></ul></li><li class=" "><p   
>Certs issued per day</p>
<ul class=" "><li class=" "><p   
>Search in the last 30 days</p>
</li><li class=" "><p   
>EVENT:CERT_CREATION</p>
</li><li class=" "><p   
>Select <strong class=" ">Day</strong> in the Histogram and then click <strong class=" ">Add to dashboard</strong></p>
</li></ul></li><li class=" "><p   
>Exceptions last week</p>
<ul class=" "><li class=" "><p   
>Search in the last 7 days</p>
</li><li class=" "><p   
>Exception</p>
</li><li class=" "><p   
>Select <strong class=" ">Hour</strong> in the Histogram and then click <strong class=" ">Add to dashboard</strong></p>
</li></ul></li></ul><p   
>You can now go to your dashboard and rearrange the widgets using <strong class=" ">Unlock/Edit.</strong></p>
    </div>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Web_Service_Interface.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Web Service Interface</span>
        </a>
                <a href="View_Log_Options.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>View Log Options</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
