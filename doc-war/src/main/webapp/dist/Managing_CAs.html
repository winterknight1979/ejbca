<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Managing CAs - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=16233789"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Operations.html">EJBCA Operations</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_User_Guide.html">EJBCA User Guide</a></li>
                                                                                     <li><a href="CA_Operations_Guide.html">CA Operations Guide</a></li>
                                                            </ul>
</div>            <h1 id="src-16233789"> <span>Managing CAs</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>This Certificate Authority Operations page provides information on how to manage CAs:</p>
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-16233789_id-.ManagingCAsv6.14.0-ExportandImportCAsExport_and_import_CAs">Export and Import CAs</a></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-16233789_id-.ManagingCAsv6.14.0-UsingCommandLineInterfaceUsing_command_line_interface">Using Command Line Interface</a></p>
</li><li class=" "><p   
><a   href="#src-16233789_id-.ManagingCAsv6.14.0-UsingtheCAUIUsing_admin-GUI">Using the CA UI</a></p>
</li></ul></li><li class=" "><p   
><a   href="#src-16233789_id-.ManagingCAsv6.14.0-RemoveandRestoreaCASoftKeyStoreRemove_and_restore_CA_soft_keystore">Remove and Restore a CA Soft Key Store</a></p>
</li><li class=" "><p   
><a   href="#src-16233789_id-.ManagingCAsv6.14.0-RenewingCAsRenew_CAs">Renewing CAs</a></p>
</li><li class=" "><p   
><a   href="#src-16233789_id-.ManagingCAsv6.14.0-RevokingCAsRevoke_CAs">Revoking CAs</a></p>
</li></ul><ul class="childpages-macro "><li class=" "><p   
><a   href="CA_Rollover.html">CA Rollover</a></p>
</li><li class=" "><p   
><a   href="Converting_an_OpenSSL_CA.html">Converting an OpenSSL CA</a></p>
</li><li class=" "><p   
><a   href="Creating_a_SubCA_Signed_by_an_External_CA.html">Creating a SubCA Signed by an External CA</a></p>
</li><li class=" "><p   
><a   href="Creating_CA%27s.html">Creating CA's</a></p>
</li><li class=" "><p   
><a   href="Renewing_a_SubCA_Signed_by_an_External_CA.html">Renewing a SubCA Signed by an External CA</a></p>
</li><li class=" "><p   
><a   href="Requesting_a_Cross_or_Bridge_certificate.html">Requesting a Cross or Bridge certificate</a></p>
</li><li class=" "><p   
><a   href="Signing_an_External_CA.html">Signing an External CA</a></p>
</li><li class=" "><p   
><a   href="Signing_a_Rollover_Certificate.html">Signing a Rollover Certificate</a></p>
</li></ul>    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>For more conceptual information on CAs, see <a   href="Certificate_Authority_Overview.html">Certificate Authority Overview</a>.</p>
        </div>
    </div>
    <div class="section section-1" id="src-16233789_id-.ManagingCAsv6.14.0-ExportandImportCAsExport_and_import_CAs">
        <h1 class="heading "><span id="src-16233789_id-.ManagingCAsv6.14.0-Export_and_import_CAs" class="confluence-anchor-link"></span><span>Export and Import CAs</span></h1>
<p   
>Under certain circumstances, it can be wise to back up the CA's signature and encryption keys. Remember to protect the backup in the same way as the CA itself.</p>
<ul class=" "><li class=" "><p   
>Soft token CAs can be exported and backed up. CAs with the keys on an HSM cannot be exported through EJBCA. Use the HSMs methods to back up such keys.</p>
</li><li class=" "><p   
>Soft token CAs can be imported using both the CLI and Admin GUI, while HSM CAs can only be imported using the CLI.</p>
</li></ul>    <div class="section section-2" id="src-16233789_id-.ManagingCAsv6.14.0-UsingCommandLineInterfaceUsing_command_line_interface">
        <h2 class="heading "><span id="src-16233789_id-.ManagingCAsv6.14.0-Using_command_line_interface" class="confluence-anchor-link"></span><span>Using Command Line Interface</span></h2>
<p   
>To export a CA named <strong class=" ">TestCA</strong> to the PKCS#12-file <strong class=" ">/path/TestCA.p12</strong> with password <strong class=" ">foo123</strong>, enter the following from the $EJBCA_HOME directory:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ bin</code><code class="plain">/ejbca</code><code class="plain">.sh ca exportca TestCA .</code><code class="plain">/TestCA</code><code class="plain">.p12</code></div>
<div class="line"><code class="plain">Using JBoss JNDI provider...</code></div>
<div class="line"><code class="plain">Enter keystore password: foo123</code></div>
<div class="line"><code class="plain">$</code></div>
</div>
    </div>
<p   
>To import the backup keys for <strong class=" ">TestCA</strong> later, enter the following from the $EJBCA_HOME directory:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ bin</code><code class="plain">/ejbca</code><code class="plain">.sh ca importca TestCA </code><code class="plain">/path/TestCA</code><code class="plain">.p12 SignatureKeyAlias EncryptionKeyAlias</code></div>
<div class="line"><code class="plain">Using JBoss JNDI provider...</code></div>
<div class="line"><code class="plain">Enter keystore password: foo123</code></div>
<div class="line"><code class="plain">$</code></div>
</div>
    </div>
<p   
>To view usage instructions on how to import HSM CAs, run the following command:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ bin</code><code class="plain">/ejbca</code><code class="plain">.sh ca importca --help</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-16233789_id-.ManagingCAsv6.14.0-UsingtheCAUIUsing_admin-GUI">
        <h2 class="heading "><span id="src-16233789_id-.ManagingCAsv6.14.0-Using_admin-GUI" class="confluence-anchor-link"></span><span>Using the CA UI </span></h2>
<p   
>To export and import the CA's keys using the Admin GUI, you need superadministrator access. Make sure that .p12 files are not automatically saved to an unsuitable place by your browser. before you perform an export.</p>
<p   
>To export the CA's keys, do the following:</p>
<ol class=" "><li class=" "><p   
>Select the <strong class=" ">Certificate Authorities</strong> menu option.</p>
</li><li class=" "><p   
>Select the CA to export and click <strong class=" ">Edit</strong>.</p>
</li><li class=" "><p   
>Next to <strong class=" ">CA export requires the keystore password</strong>, enter the keystore password.</p>
</li><li class=" "><p   
>Click <strong class=" ">Export CA keystore</strong>.</p>
</li><li class=" "><p   
>The PKCS#12-file will be downloaded by your browser to the location you specify.</p>
</li></ol><p   
>To import the CA's keys, do the following:</p>
<ol class=" "><li class=" "><p   
>Select the <strong class=" ">Certificate Authorities</strong> menu option.</p>
</li><li class=" "><p   
>Click <strong class=" ">Import CA keystore</strong>.</p>
</li><li class=" "><p   
>Specify the CA's name, full pathname to the PKCS#12-file, and keystore password.</p>
</li><li class=" "><p   
>If you exported the CA's keys using EJBCA, do not edit the two <strong class=" ">Alias</strong> field default values.</p>
</li><li class=" "><p   
>Click <strong class=" ">Import CA keystore</strong>.</p>
</li></ol>    </div>
    </div>
    <div class="section section-1" id="src-16233789_id-.ManagingCAsv6.14.0-RemoveandRestoreaCASoftKeyStoreRemove_and_restore_CA_soft_keystore">
        <h1 class="heading "><span id="src-16233789_id-.ManagingCAsv6.14.0-Remove_and_restore_CA_soft_keystore" class="confluence-anchor-link"></span><span>Remove and Restore a CA Soft Key Store </span></h1>
<p   
>Soft token CAs can have their keystore removed from the database. When the keystore is removed, the CA cannot issue certificates and its CA token status is set to <strong class=" ">offline</strong>.</p>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Before removing the keystore, export it first to allow restoring it later, see <a   href="#src-16233789_id-.ManagingCAsv6.14.0-Export_and_import_CAs">Export and Import CAs</a> above.</p>
        </div>
    </div>
<p   
>To remove the catoken keys for <strong class=" ">TestCA</strong>, enter the following from the $EJBCA_HOME directory:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ bin/ejbca.sh ca removekeystore TestCA</code></div>
<div class="line"><code class="plain">Using JBoss JNDI provider...</code></div>
<div class="line"><code class="plain">$ </code></div>
</div>
    </div>
<p   
>To restore the catoken keys again for <strong class=" ">TestCA</strong> with the keystore exported as <strong class=" ">TestCA-exported.p12</strong>, enter the following from the $EJBCA_HOME directory:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ bin/ejbca.sh ca restorekeystore TestCA /path/TestCA-exported.p12 -s SignatureKeyAlias -e EncryptionKeyAlias</code></div>
<div class="line"><code class="plain">Using JBoss JNDI provider...</code></div>
<div class="line"><code class="plain">Enter keystore password: foo123</code></div>
<div class="line"><code class="plain">$</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-16233789_id-.ManagingCAsv6.14.0-RenewingCAsRenew_CAs">
        <h1 class="heading "><span id="src-16233789_id-.ManagingCAsv6.14.0-Renew_CAs" class="confluence-anchor-link"></span><span>Renewing CAs </span></h1>
<p   
>You can renew CAs in different ways:</p>
<ul class=" "><li class=" "><p   
>Renew only CA certificate, using the same keys.</p>
</li><li class=" "><p   
>Renew CA keys and certificate.</p>
</li></ul><p   
>To renew only the CA certificate using the same keys, click <strong class=" ">Renew CA</strong>. Note that your CA must be online to be able to sign the new certificate (if a self-signed CA), or the certificate request (if a subCA). Additionally, if using a subCA with the rootCA in the same EJBCA instance, the root CA is also required to be online.</p>
<p   
>To renew the CA keys, set <strong class=" ">Next CA key</strong> to <strong class=" ">Generate new key using KeySequence </strong>and click <strong class=" ">Renew CA</strong>. Note that not all HSMs support renewal of CA keys.</p>
<p   
>When using an HSM, manual renewal of keys can also be made by generating new keys on the HSM, using for example the EJBCA CLI tools, and then selecting the generated keys in the <strong class=" ">Next CA key</strong> field and clicking <strong class=" ">Renew CA</strong>.</p>
    </div>
    <div class="section section-1" id="src-16233789_id-.ManagingCAsv6.14.0-RevokingCAsRevoke_CAs">
        <h1 class="heading "><span id="src-16233789_id-.ManagingCAsv6.14.0-Revoke_CAs" class="confluence-anchor-link"></span><span>Revoking CAs </span></h1>
<p   
>To revoke a CA, select <strong class=" ">Certificate Authorities</strong> and click <strong class=" ">Revoke CA</strong>.</p>
<ul class=" "><li class=" "><p   
>If you revoke a Root CA it will revoke all certificates in the database issued by the root CA and create a CRL.</p>
</li><li class=" "><p   
>If you revoke a Sub CA it will revoke all certificates in the database issued by and to the sub CA, and create a CRL. This works automatically if the sub CA and root CA are handled by the same EJBCA instance. If the Sub CA is signed by an external CA, the sub CA's certificate must be revoked by the external CA.</p>
</li><li class=" "><p   
>If you revoke an external CA (a sub CA to a CA in EJBCA), the external CAs certificate will be revoked and placed on the CRL of the issuing CA in EJBCA.</p>
</li></ul>    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Key_Recovery.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Key Recovery</span>
        </a>
                <a href="CA_Rollover.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>CA Rollover</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
