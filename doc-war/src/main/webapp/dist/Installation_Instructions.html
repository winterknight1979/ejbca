<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Installation Instructions - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=16232855"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Installations.html">EJBCA Installations</a></li>
                                                                                     <li><a href="EJBCA_Main_Installation.html">EJBCA Main Installation</a></li>
                                                            </ul>
</div>            <h1 id="src-16232855"> <span>Installation Instructions</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>The following describes how to install EJBCA on the most well supported application server JBoss AS. EJBCA can also be run on Glassfish and Weblogic, but your mileage may vary (see details below).</p>
<p   
>For information on quickly getting started with EJBCA, see <a   href="Quick_Start_Guide.html">Quick Start Guides</a>.</p>
    <div class="section section-1" id="src-16232855_id-.InstallationInstructionsv6.14.0-Prerequisites">
        <h1 class="heading "><span>Prerequisites</span></h1>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>EJBCA uses strong crypto and keystore passwords longer than 7 characters. This requires you to install the <i class=" ">Unlimited Strength Jurisdiction Policy Files</i> for JDK, available for download together with the JDK download at the <a  class="external-link" href="http://www.oracle.com/technetwork/java/index.html">Oracle</a> website. The text <i class=" ">Using exportable cryptography</i> will be shown on the first page in the Admin GUI if you fail to install the package. For more information, refer to the Oracle documentation on the JCE.</p>
        </div>
    </div>
<p   
>Needed to be built and run are:</p>
<ul class=" "><li class=" "><p   
>JDK 7 or 8, OpenJDK or Oracle JDK. If available OpenJDK is recommended.</p>
</li><li class=" "><p   
>Only if using OracleJDK - <i class=" ">Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files</i> for your JDK.</p>
</li><li class=" "><p   
>JBoss Application Server 7.1.x or later or JBoss EAP 6 or later. <a   href="Application_Servers.html">WildFly</a> 9 or later.</p>
<ul class=" "><li class=" "><p   
>The currently recommended Application Servers are WildFly 10, or JBoss EAP 7 (download<a  class="external-link" href="http://wildfly.org/downloads/"> WildFly</a> or download <a  class="external-link" href="https://developers.redhat.com/products/eap/download/">JBoss EAP</a>).</p>
</li></ul></li><li class=" "><p   
>Apache Ant 1.8 or later to build (available as standard package in Linux, or <a  class="external-link" href="http://ant.apache.org/">download</a>). Note that javascript support may be needed in ant for some components.</p>
</li></ul><p   
>Windows/Unix: When we describe command line commands below we use Unix notation, e.g. <code class=" ">ejbca.sh</code> for the executable command files. The same command files are available for windows as cmd-files, e.g. <code class=" ">ejbca.cmd</code>.</p>
<p   
>If you are unsure what version of EJBCA you are running, type <code class=" ">ant ejbcaversion</code> in the EJBCA_HOME directory.</p>
    </div>
    <div class="section section-1" id="src-16232855_id-.InstallationInstructionsv6.14.0-Configure">
        <h1 class="heading "><span>Configure</span></h1>
    <div class="section section-2" id="src-16232855_id-.InstallationInstructionsv6.14.0-ConfigurationFiles">
        <h2 class="heading "><span>Configuration Files</span></h2>
<p   
>The configuration of EJBCA that cannot be configured in the Admin GUI is located in properties files in the <strong class=" ">conf</strong> directory. All properties are documented in sample files and to configure an option you copy the sample file, for example copy <strong class=" ">conf/ejbca.properties.sample</strong> to <strong class=" ">conf/ejbca.properties</strong> and configure <strong class=" ">conf/ejbca.properties</strong>. You should at least familiarize yourself with the options in <strong class=" ">conf/install.properties</strong>, <strong class=" ">conf/ejbca.properties</strong> and <strong class=" ">conf/cesecore.properties</strong>. Most options, except those in install.properties can be changed after installation.</p>
    </div>
    <div class="section section-2" id="src-16232855_id-.InstallationInstructionsv6.14.0-EJBCAConfiguration">
        <h2 class="heading "><span>EJBCA Configuration</span></h2>
<p   
>Copy <strong class=" ">conf/install.properties.sample</strong> to <strong class=" ">conf/install.properties</strong>, <strong class=" ">conf/ejbca.properties.sample</strong> to <strong class=" ">conf/ejbca.properties</strong> and <strong class=" ">conf/cesecore.properties.sample</strong> to <strong class=" ">conf/cesecore.properties</strong>. Customize if needed. The default values work fine for a test installation.</p>
<p   
>You must configure <strong class=" ">appserver.home</strong> in <strong class=" ">ejbca.properties</strong> to point to your application server directory. You find examples of how to do this in <strong class=" ">ejbca.properties.sample</strong>.</p>
<p   
>This makes libraries from the application server available to EJBCA during the build.</p>
<p   
>If you are only testing EJBCA at this stage and is not setting up a production environment, you can skip the rest of this step. There are default configuration options, that should work in a test environment, for everything.</p>
<ul class=" "><li class=" "><p   
>If needed, customize the CA properties in <strong class=" ">conf/ejbca.properties</strong>. For production use you need to do this, don't forget to edit passwords to be secure and secret. Keep conf/ejbca.properties as secret as possible. DO NOT forget the passwords, if you need to re-install the software sometime.</p>
</li><li class=" "><p   
>To use a hard ca token from start, change <strong class=" ">ca.tokentype</strong>, <strong class=" ">ca.tokenpassword</strong> and <strong class=" ">ca.tokenproperties</strong> in <strong class=" ">install.properties</strong>. You also need to add the appropriate values to the <strong class=" ">ca.tokenproperties</strong> file for the HSM. Read the HSM documentation for the right values.</p>
</li><li class=" "><p   
>To put the initial superadmin certificate on a smartcard, set <i class=" ">superadmin.batch=false</i> in <strong class=" ">web.properties</strong>.<br/>Enroll from public web after the installation is complete, as you would with any other smartcard user.<br/>Username is <strong class=" ">superadmin</strong> and password is <strong class=" ">superadmin.password</strong> from <strong class=" ">web.properties</strong>.</p>
</li><li class=" "><p   
>If you are deploying on JBoss EAP you probably want to look at the property <strong class=" ">jboss.config</strong> as well, since <strong class=" ">production</strong> may be the default server to start on JBoss EAP (depends on your configuration).</p>
</li></ul><p   
>Do the same with other configuration files that you might want to customize. The default values are generally sufficient, and most options are documented in the sample files.</p>
<ul class=" "><li class=" "><p   
>If needed, customize the database in <strong class=" ">conf/database.properties</strong>. Most straightforward is to keep the default values, using the JBoss embedded HSQLDB. For production use you should use a real database instead of the embedded one.</p>
</li></ul>    </div>
    <div class="section section-2" id="src-16232855_id-.InstallationInstructionsv6.14.0-ConfigureApplicationServers">
        <h2 class="heading "><span>Configure Application Servers</span></h2>
<p   
>Due to differences between different application servers, configure your application server with certain settings, and EJBCA with server specific settings. For more information, see <a   href="Application_Servers.html">Application Servers</a>.</p>
<p   
></p>
    </div>
    <div class="section section-2" id="src-16232855_id-.InstallationInstructionsv6.14.0-Considerations">
        <h2 class="heading "><span>Considerations</span></h2>
<p   
>When everything is prepared, there are a few things to configure before starting your applications and running everything in a production environment.</p>
<p   
>In a production environment you should use something like the following structure:</p>
<ol class=" "><li class=" "><p   
>Go through the install process creating a ManagementCA.<br/>Use a simple DN. This CA should only be used to issue the administrator certificates, not published in LDAP. If you want to use an HSM for this CA, refer to the documentation in the configuration file <code class=" ">conf/ejbca.properties.sample</code>.</p>
</li><li class=" "><p   
>Once installed, create all your REAL CAs using the Admin GUI.<br/>Use your preferred certificate profiles etc. These certificates can be published in LDAP. For configuration information, refer to <code class=" ">doc/howto/HOWTO-multiplecas.txt.</code></p>
</li></ol><p   
>In a production environment, it is required to use something else than the default Hypersonic database provided with JBoss, for the following reasons:</p>
<ul class=" "><li class=" "><p   
>Hypersonic database is in-memory and will over time consume more memory. If a large number of certificates is issued, it will become an issue after a while.</p>
</li><li class=" "><p   
>Hypersonic does not support full SQL, in particular ALTER statements. When a new version of EJBCA is released we cannot create scripts that updates the database if some tables changed. This will complicate upgrades.</p>
</li></ul><p   
>For information about installing JDBC drivers for other databases, refer to <code class=" ">doc/howto/HOWTO-database.txt </code>in the distribution.</p>
    </div>
    </div>
    <div class="section section-1" id="src-16232855_id-.InstallationInstructionsv6.14.0-InstallonJBoss7.1.1orJBossEAP6">
        <h1 class="heading "><span>Install on JBoss 7.1.1 or JBoss EAP 6 </span></h1>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>If deploying on WildFly 10 or JBoss EAP 7, follow the installation instructions in <a   href="WildFly_10___JBoss_EAP_7.0.html">WildFly 10/JBoss EAP 7</a> to manually configure data sources and web.</p>
        </div>
    </div>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The installation must be done with a user with privileges to write to <strong class=" ">APPSRV_HOME</strong> and sub directories. Running the deploy and install commands as described will also configure the application server with data sources and web configuration automatically.</p>
        </div>
    </div>
<p   
></p>
<ol class=" "><li class=" "><p   
>Set the property appserver.home in conf/ejbca.properties to where your JBoss is installed, for example:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">appserver.home=/opt/jboss-7.1.1.Final</code></div>
</div>
    </div>
<p   
>Also make sure the right java tools (javac/keytool) are available in your system PATH, ie. <code class=" ">/usr/local/jdk1.7.0_25/bin.</code></p>
</li><li class=" "><p   
>Open a console (terminal) and start JBoss. You can start JBoss with the normal command <code class=" ">standalone.sh</code> (JBoss 7/EAP 6/WildFly) from APPSRV_HOME/bin. You should see JBoss picking up everything and deploying the ear without errors.</p>
</li><li class=" "><p   
>Open a console and type:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ant deploy</code></div>
</div>
    </div>
<p   
>It will compile and build EJBCA and deploy it to JBoss, as well as automatically create data sources and mail service. You will be prompted to enter the value for database.password if it has not already been defined in database.properties.</p>
</li><li class=" "><p   
>Type:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ant install</code></div>
</div>
    </div>
<p   
>The command will generate all certificates, keys, etc needed to run with an initial CA, and configure TLS in the servlet container to use the generated keystore and truststore files (which are also copied in the process). You will find admin keys in <code class=" ">${ejbca.home}/p12.</code> (do not delete these files!)<br/>The command is only run once, when the CA is first installed. It creates lots of things in the database and cannot be run again (it will give an error if you try).</p>
<ul class=" "><li class=" "><p   
>tomcat.jks is for the Servlet container (don't bother with it)</p>
</li><li class=" "><p   
>truststore.jks is for the Servlet container (don't bother with it)</p>
</li><li class=" "><p   
>superadmin.p12 should be imported in your browser, that's your administration certificate.</p>
</li></ul>    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Instead of creating an initial Admin CA and issuing administrator certificates from that, you can install using administrator certificates from an already existing external CA. For more information, see <a   href="Administrators_Issued_by_External_CAs.html">Administrators Issued by External CAs</a>. This would replace step 4-8, but instead require other steps.</p>
        </div>
    </div>
</li><li class=" "><p   
>Restart JBoss (Ctrl+C if you run JBoss in the foreground in a terminal).</p>
</li><li class=" "><p   
>Import the certificate from EJBCA_HOME/p12/superadmin.p12 in your web browser. This is the super administrators certificate used to access the Admin GUI. Other administrators with specific privileges can be created later on. The default password for superadmin.p12 is ejbca and is configured in web.properties.</p>
</li><li class=" "><p   
>Go to https://localhost:8443/ejbca/ to access the Admin GUI, or http://localhost:8080/ejbca for the public web pages.<br/>If you create other CAs that you want to add as acceptable CAs in the SSL server configuration, or if you renew the CA certificate, you can install any CA certificate in the SSL server configuration afterwards with the following command:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ant -Dca.name="My CA Name" javatruststore</code></div>
</div>
    </div>
<p   
>What this does in the background is that it adds the CA certificate to p12/truststore.jks and copies this file to JBOSS_HOME/server/default/conf/keystore, where the SSL keystores are located.</p>
<p   
>You must stop and start JBoss after doing this.</p>
</li></ol>    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="EJBCA_Main_Installation.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>EJBCA Main Installation</span>
        </a>
                <a href="Standalone_VA_Installation.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Standalone VA Installation</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
