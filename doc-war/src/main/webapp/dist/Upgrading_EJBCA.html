<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Upgrading EJBCA - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=16234296"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                     <li><a href="EJBCA_Installations.html">EJBCA Installations</a></li>
                                                            </ul>
</div>            <h1 id="src-16234296"> <span>Upgrading EJBCA</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>This section provides information on upgrading from your current version to a later version of EJBCA and the <a   href="#src-16234296_id-.UpgradingEJBCAv6.14.0-UpgradePaths">Upgrade Paths</a> table below helps you determine the most efficient upgrade path.</p>
<p   
>Also see the <a   href="EJBCA_Upgrade_Notes.html">EJBCA Upgrade Notes</a> for the version you plan to upgrade to (and any version in between).</p>
    <div class="section section-1" id="src-16234296_id-.UpgradingEJBCAv6.14.0-UpgradeInstructions">
        <h1 class="heading p1"><span>Upgrade Instructions</span></h1>
<p  class="p2" 
>When upgrading or changing a configuration setting in a properties file, it is not required to fully re-install EJBCA or re-configure the application server. Instead, deploy a new EJBCA application (ejbca.ear) to the application server using the <code class=" ">ant deployear</code> command.</p>
<p  class="p2" 
>Follow the steps below to upgrade from one version of EJBCA to a new version.</p>
<ol class=" "><li class="p1 "><p   
>Copy <code class=" ">conf/*.properties</code> from the earlier installation.<br/>This step is not required if you are using an ejbca-custom directory (see <a   href="#src-16234296_id-.UpgradingEJBCAv6.14.0-ejbca-custom">ejbca-custom</a> below).</p>
</li><li class="p1 "><p   
>Merge changes (if there are any) from <code class=" ">*.properties.sample</code> into your <code class=" ">*.properties</code>.</p>
</li><li class="p1 "><p   
>Copy the content of the <code class=" ">p12</code> directory from the earlier installation and run the following command with the new version:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ ant deployear</code></div>
</div>
    </div>
<p  class="p1" 
>Note that the command <code class=" ">deployear</code> deploys a new <code class=" ">ejbca.ear</code> to the application server, not performing the same configuration work as the <code class=" ">deploy</code><i class=" "> </i>command.</p>
</li><li class=" "><p   
>If you have switched application server (a new version, or just unpacked a fresh installation of it), you need to run the following additional command to copy the TLS keystores over to the new server:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ ant deploy-keystore</code></div>
</div>
    </div>
</li><li class=" "><p   
>You also need to configure TLS for your application server. See the application server specific instructions for the installation, for example for WildFly on <a   href="Application_Servers.html">Application Servers</a>.</p>
</li><li class=" "><p  class="p1" 
>All database upgrades require CREATE and ALTER TABLE privileges in addition to the usual privileges SELECT, UPDATE, INSERT, and DELETE. The SQL executed by database upgrades code is available in <code class=" ">src/upgrade/&lt;oldversion&gt;_&lt;newversion&gt;/&lt;oldversion&gt;_&lt;newversion&gt;-upgrade-&lt;database&gt;.sql</code>.</p>
</li></ol>    <div class="section section-2" id="src-16234296_id-.UpgradingEJBCAv6.14.0-ejbca-custom">
        <h2 class="heading "><span>ejbca-custom</span></h2>
<p   
>To ease upgrades and allow keeping your personal configurations from a version to another, you can store your personal EJBCA modifications in the <code class=" ">ejbca-custom</code> folder. Your modifications will automatically overwrite any existing files found in the <code class=" ">EJBCA_HOME</code> directory before executing an <code class=" ">ant</code> command. For more information, see <a   href="Customizing_EJBCA.html">Customizing EJBCA</a>.</p>
    </div>
    </div>
    <div class="section section-1" id="src-16234296_id-.UpgradingEJBCAv6.14.0-UpgradePaths">
        <h1 class="heading "><span>Upgrade Paths</span></h1>
<p   
>Use the table below to determine the most efficient upgrade path from your current version to the later versions of EJBCA and see the <a   href="#src-16234296_id-.UpgradingEJBCAv6.14.0-Notes">Notes</a> below for details.</p>
<p   
>Also see the <a   href="EJBCA_Upgrade_Notes.html">EJBCA Upgrade Notes</a> for the version you plan to upgrade to (and any in between).</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Your Version</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Recommended Upgrade Path</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Upgrade Steps</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>4.0.15 or earlier on JDK6 or earlier</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Upgrade to <strong class=" ">4.0.16</strong> and then upgrade to <strong class=" ">6.3.2.6</strong>.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ol class=" "><li class=" "><p   
>Upgrade to EJBCA <strong class=" ">4.0.16</strong></p>
</li><li class=" "><p   
>From the console, run <code class=" ">ant upgrade</code>.</p>
</li><li class=" "><p   
>From the console, run <code class=" ">ant post-upgrade</code>.</p>
</li><li class=" "><p   
>Continue by following the steps below to upgrade to <strong class=" ">6.3.2.6</strong>.</p>
</li></ol><p   
></p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>4.0.16 to 5.0.11 on JDK6 or earlier</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Upgrade to <strong class=" ">6.3.2.6</strong> and then upgrade to the latest version of EJBCA.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ol class=" "><li class=" "><p   
>Upgrade to EJBCA <strong class=" ">6.3.2.6</strong>.</p>
</li><li class=" "><p   
>From the console, run <code class=" ">ant upgrade</code>.</p>
</li><li class=" "><p   
>From the console, run <code class=" ">ant post-upgrade</code>.</p>
</li><li class=" "><p   
>Upgrade to JDK7 or JDK8.</p>
</li><li class=" "><p   
>Upgrade the application server to a JEE6 supporting server.</p>
</li><li class=" "><p   
>Deploy the latest version of EJBCA.</p>
</li><li class=" "><p   
>From the console, run <code class=" ">ant upgrade</code>.</p>
</li><li class=" "><p   
>Perform a post-upgrade by selecting <strong class=" ">System Upgrade</strong> in the Admin GUI.</p>
</li></ol><p   
></p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>5.0.12 to 6.3.x</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Upgrade to the latest version of EJBCA.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ol class=" "><li class=" "><p   
>If on JDK6, upgrade to JDK7 or JDK8 and if required,<br/>upgrade the application server to a JEE6 supporting server.</p>
</li><li class=" "><p   
>Upgrade to latest version of EJBCA.</p>
</li><li class=" "><p   
>From the console, run <code class=" ">ant upgrade</code>.</p>
</li><li class=" "><p   
>Perform a post-upgrade by selecting <strong class=" ">System Upgrade</strong> in the Admin GUI.</p>
</li></ol><p   
></p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>6.4.0 or later</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Upgrade to the latest version of EJBCA.</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <ol class=" "><li class=" "><p   
>Upgrade to latest version of EJBCA.</p>
</li><li class=" "><p   
>Perform a post-upgrade by selecting <strong class=" ">System Upgrade</strong> in the Admin GUI.</p>
</li></ol><p   
></p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-1" id="src-16234296_id-.UpgradingEJBCAv6.14.0-Notes">
        <h1 class="heading "><span>Notes</span></h1>
    <div class="section section-2" id="src-16234296_id-.UpgradingEJBCAv6.14.0-IntermediateReleaseEJBCA6.3.2.6">
        <h2 class="heading "><span>Intermediate Release EJBCA 6.3.2.6</span></h2>
<p   
>The intermediate release <strong class=" ">EJBCA 6.3.2.6</strong>, released 1 December 2017, handles intermediate upgrade steps when upgrading a version prior to 5.0.12 to a later EJBCA version.</p>
<p   
>Up until and including version 6.3.2.6, EJBCA can be run on JBoss 5.1, while higher versions of EJBCA require Java 7 or Java 8 and later versions of JBoss/WildFly.</p>
    </div>
    <div class="section section-2" id="src-16234296_id-.UpgradingEJBCAv6.14.0-TechnologyJumps">
        <h2 class="heading "><span>Technology Jumps</span></h2>
<p   
>Upgrading past these technology jumps requires not only upgrading EJBCA, but also the underlying software such as the JDK and the application server.</p>
<ul class=" "><li class=" "><p   
><strong class=" ">EJBCA 6.4.0: JDK6 &gt; JDK7</strong>: End of support for legacy runtime version JDK6 and moving to JDK7.</p>
</li><li class=" "><p   
><strong class=" ">EJBCA 6.4.0: JEE5 &gt; JEE6</strong>: With the move to runtime version JDK7, it can no longer be deployed to application servers based on JDK6 such as JBoss versions 4 and 5. The latest version that can still run under JDK6 is the EJBCA 6.3.2.6 intermediate release. Thus, EJBCA 6.3.2.6 and earlier can be run on JBoss 5.1.0.GA server (JEE5), while later versions require an upgrade of the JDK and application server, JDK8 and JBoss EAP 7 or WildFly 10 are recommended.</p>
</li></ul>    </div>
    <div class="section section-2" id="src-16234296_id-.UpgradingEJBCAv6.14.0-UpgradeProcessChanges">
        <h2 class="heading "><span>Upgrade Process Changes</span></h2>
<ul class=" "><li class=" "><p   
><strong class=" ">As of EJBCA 4.0</strong>, full up-time is supported during upgrades for clustered installations, using the upgrade process steps <code class=" ">upgrade</code> and <code class=" ">post-upgrade</code>:</p>
<ul class=" "><li class=" "><p   
><code class=" ">upgrade</code>: Performs steps required for upgrading the first node to be able to function once it comes online again.</p>
</li><li class=" "><p   
><code class=" ">post-upgrade</code>: Performs remaining upgrade steps (such as clean-up) that can only be performed once all nodes are running the latest code.</p>
</li></ul></li></ul><ul class=" "><li class=" "><p   
>As of<strong class=" "> EJBCA 6.4.0</strong>, the database version is tracked internally, making the upgrade automatically run from the first run running the upgraded code, making the <code class=" ">upgrade</code><i class=" "> </i>command redundant.</p>
</li></ul><ul class=" "><li class=" "><p   
>As of <strong class=" ">EJBCA 6.8.0</strong>, you can perform post-upgrades from the Admin Web. When a post-upgrade is required, the <strong class=" ">System Configuration</strong> menu option <strong class=" ">System Upgrade<i class=" "> </i></strong>is available.</p>
</li></ul><p   
></p>
<p   
></p>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Deployment_Reference.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Deployment Reference</span>
        </a>
                <a href="Code_Signing.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Code Signing</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
