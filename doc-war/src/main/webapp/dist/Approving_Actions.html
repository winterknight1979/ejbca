<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Approving Actions - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=16224729"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Operations.html">EJBCA Operations</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_User_Guide.html">EJBCA User Guide</a></li>
                                                                                     <li><a href="CA_Operations_Guide.html">CA Operations Guide</a></li>
                                                            </ul>
</div>            <h1 id="src-16224729"> <span>Approving Actions</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>This contains information on approvals in the following sections:</p>
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-16224729_id-.ApprovingActionsv6.12.0-ConfiguringApprovalsConfiguring_Approvals">Configuring Approvals</a></p>
</li><li class=" "><p   
><a   href="#src-16224729_id-.ApprovingActionsv6.12.0-ApprovalProfilesApproval_Profiles">Approval Profiles</a></p>
</li><li class=" "><p   
><a   href="#src-16224729_id-.ApprovingActionsv6.12.0-AuthorizingApprovingAdministratorsAuthorizing_Approving_Administrators">Authorizing Approving Administrators</a></p>
</li><li class=" "><p   
><a   href="#src-16224729_id-.ApprovingActionsv6.12.0-TwoDifferentApprovalRequestsTwo_Different_Approval_Requests">Two Different Approval Requests</a></p>
</li><li class=" "><p   
><a   href="#src-16224729_id-.ApprovingActionsv6.12.0-ApprovalStatusExplanation_of_approval_status">Approval Status</a></p>
</li><li class=" "><p   
><a   href="#src-16224729_id-.ApprovingActionsv6.12.0-ApprovalNotificationApproval_Notification">Approval Notification</a></p>
</li></ul><p   
>EJBCA allows enabling other administrators to approve an action in order to ensure that the correct data is entered.</p>
<p   
>The following actions are enabled for approvals:</p>
<ul class=" "><li class=" "><p   
>Add End Entity</p>
</li><li class=" "><p   
>Edit End Entity</p>
</li><li class=" "><p   
>Change User Status</p>
</li><li class=" "><p   
>Revoke End Entity</p>
</li><li class=" "><p   
>Revoke Token (approval for each certificate)</p>
</li><li class=" "><p   
>Revoke Certificate</p>
</li><li class=" "><p   
>Reactivate Certificate On Hold</p>
</li></ul><p   
>The main menu option <strong class=" ">Approve Actions</strong> allows the administrator to search for waiting requests, review their data, and approve or reject the action.</p>
    <div class="section section-1" id="src-16224729_id-.ApprovingActionsv6.12.0-ConfiguringApprovalsConfiguring_Approvals">
        <h1 class="heading "><span id="src-16224729_id-.ApprovingActionsv6.12.0-Configuring_Approvals" class="confluence-anchor-link"></span><span>Configuring Approvals </span></h1>
<p   
>Approvals are configured for each CA, in the <strong class=" ">Certificate Authorities</strong> page and for each certificate profile in the <strong class=" ">Certificate Profiles</strong> page.</p>
<p   
>Select the actions that need approval and the approval profile to use and save (see <a   href="http://confluence.primekey.com/display/EJBCADS/.Approval+Profiles+v6.15.2.6">Approval Profiles</a>). The actions <strong class=" ">Add End Entity</strong>, <strong class=" ">Change End Entity</strong> and <strong class=" ">Change User Status</strong> are all covered by the setting <strong class=" ">Add/Edit End Entity</strong>. <strong class=" ">Revoke End Entity</strong>, <strong class=" ">Revoke Certificate</strong>, <strong class=" ">Revoke Token</strong> and <strong class=" ">Reactivate Certificate</strong> are covered by setting <strong class=" ">Revocation</strong>. Approvals will be required if the CA or the certificate profile enforces it. In case both the CA and the certificate profile specify different approval profiles for the same actions, both approval profiles will apply in sequence; first the approval profile set in the CA, then the approval profile set in the certificate profile.</p>
<p   
>Noting that no administrator is allowed to take action regarding the same approval request more than once.</p>
    </div>
    <div class="section section-1" id="src-16224729_id-.ApprovingActionsv6.12.0-ApprovalProfilesApproval_Profiles">
        <h1 class="heading "><span id="src-16224729_id-.ApprovingActionsv6.12.0-Approval_Profiles" class="confluence-anchor-link"></span><span>Approval Profiles </span></h1>
<p   
>There are two types of approval profiles: Accumulative Approval Profile and Partitioned Approval Profile.</p>
    <div class="section section-2" id="src-16224729_id-.ApprovingActionsv6.12.0-AccumulativeApprovalProfileAccumulative_Approval_Profile">
        <h2 class="heading "><span id="src-16224729_id-.ApprovingActionsv6.12.0-Accumulative_Approval_Profile" class="confluence-anchor-link"></span><span>Accumulative Approval Profile </span></h2>
<p   
>In the Accumulative Approval Profile profile, only the number of required approvals is set. No requirements are specified for the approving administrators other than that no administrator is allowed to approve the same request more than once.</p>
    </div>
    <div class="section section-2" id="src-16224729_id-.ApprovingActionsv6.12.0-PartitionedApprovalProfilePartitioned_Approval_Profile">
        <h2 class="heading "><span id="src-16224729_id-.ApprovingActionsv6.12.0-Partitioned_Approval_Profile" class="confluence-anchor-link"></span><span>Partitioned Approval Profile </span></h2>
<p   
>In the Partitioned Approval Profile profile, several options can be set to specify which administrators can approve or reject a request. It is also possible to specify additional data that has to be acquired when a request is approved.</p>
<p   
>A partitioned approval consists of two concepts, Steps and Partitions:</p>
<ul class=" "><li class=" "><p   
>Approval Steps need to be performed sequentially, i.e. step 1 must be approved before step 2 can be acted upon.</p>
</li><li class=" "><p   
>Approval Partitions are non sequential parts that can be approved independently of each other, within a step. I.e. when step 1 has to be approved, Partition 1 and Partition 2 within this step can be approved in any order, independent of each other.</p>
</li></ul><p   
>Both approval profiles types allow configuring a notification to be sent to the end user and/or to the administrator expected to approve the request (see <a   href="#src-16224729_id-.ApprovingActionsv6.12.0-Approval_Notification">Approval Notification</a>). The profiles also allows setting the expiration period for the approval and for the request (see <a   href="#src-16224729_id-.ApprovingActionsv6.12.0-Explanation_of_approval_status">Approval Status</a>).</p>
<p   
>For more information on available Approval Profile fields, see the EJBCA User Guide section <a   href="http://confluence.primekey.com/display/EJBCADS/.Approval+Profiles+v6.15.2.6">Approval Profiles</a>.</p>
    </div>
    </div>
    <div class="section section-1" id="src-16224729_id-.ApprovingActionsv6.12.0-AuthorizingApprovingAdministratorsAuthorizing_Approving_Administrators">
        <h1 class="heading "><span id="src-16224729_id-.ApprovingActionsv6.12.0-Authorizing_Approving_Administrators" class="confluence-anchor-link"></span><span>Authorizing Approving Administrators </span></h1>
<p   
>In order to authorize an administrator to review approval requests do one of the following.</p>
    <div class="section section-2" id="src-16224729_id-.ApprovingActionsv6.12.0-UsingBasicRuleSets">
        <h2 class="heading "><span>Using Basic Rule Sets</span></h2>
<p   
>Give a role the role template of SuperAdmin, CAAdmin or RAAdmin with Approve End Entities selected.</p>
<p   
>The SuperAdmin and CAAdmin gives access to approve rules not associated with any end entity profile (i.e dual authenticated CA configuration (Not implemented yet)) while the RAAdmin only can approve actions related to authorized end entity profiles.</p>
    </div>
    <div class="section section-2" id="src-16224729_id-.ApprovingActionsv6.12.0-UsingAdvancedRuleSets">
        <h2 class="heading "><span>Using Advanced Rule Sets</span></h2>
<p   
>There are three new access rules:</p>
<ul class=" "><li class=" "><p   
><i class=" ">'/cafunctionality/approve_caaction'</i>, a rule that gives access to non end entity profile related actions like approving CA editing and creation (not implemented yet). An administrator must have either this rule or the '/rafunctionalty/approve_end_entity' in order to access the 'Approve Actions' web pages.</p>
</li><li class=" "><p   
><i class=" ">'/rafunctionalty/approve_end_entity'</i>, a rule (along with the corresponding end entity profile rule) that gives access to end entity profile related access rules, like adding and editing end entities. The administrator must also have the 'approve_end_entity rule' for at least one of the '/endentityprofilerules/' in order to approve any actions.</p>
</li><li class=" "><p   
><i class=" ">'/endentityprofilerules/&lt;endentityprofilename&gt;/approve_end_entity'</i>see previous rule.</p>
</li></ul>    </div>
    </div>
    <div class="section section-1" id="src-16224729_id-.ApprovingActionsv6.12.0-TwoDifferentApprovalRequestsTwo_Different_Approval_Requests">
        <h1 class="heading "><span id="src-16224729_id-.ApprovingActionsv6.12.0-Two_Different_Approval_Requests" class="confluence-anchor-link"></span><span>Two Different Approval Requests </span></h1>
<p   
>In the system there are basically two different classes of requests. One is requests to do some action, like adding an end entity, and that is executed directly after the last required administrator has approved the action. This type is called 'Executable Action Request'. The other type are requests to get hold of some information, like hard token PUK codes or archived keys. This kind of request is approved when the last administrator gives his consent and is valid for a defined period of time (set in the approval profile). In this case the requesting administrator is supposed to poll the approval request if it has been approved or not. These requests are called 'Non-Executable Action Requests'.</p>
    </div>
    <div class="section section-1" id="src-16224729_id-.ApprovingActionsv6.12.0-ApprovalStatusExplanation_of_approval_status">
        <h1 class="heading "><span id="src-16224729_id-.ApprovingActionsv6.12.0-Explanation_of_approval_status" class="confluence-anchor-link"></span><span>Approval Status </span></h1>
<p   
>The following lists the different approval request statuses:</p>
<ul class=" "><li class=" "><p   
><i class=" ">Waiting</i>: Means that the action request is waiting to be processed by authorized administrators, request are valid for the time specified in the approval profile (Request Expiration Period) before it is set to status Expired.</p>
</li><li class=" "><p   
><i class=" ">Approved</i>: Means that the action request is approved and is valid for the amount of time specified in the approval profile (Approval Expiration Period). After this, it is set to Expired. Used by action requests that are not executable.</p>
</li><li class=" "><p   
><i class=" ">Rejected</i>: Means that the action request is rejected and won't be allowed. The rejection lasts the amount of time specified in the approval profile (Approval Expiration Period). After this it is set to Expired and a new request can be done. Used by action requests that are not executable.</p>
</li><li class=" "><p   
><i class=" ">Expired</i>: Means that the action request isn't valid any more and cannot be processed. The requesting administrator has to make a new request in order to approve it.</p>
</li><li class=" "><p   
><i class=" ">Expired and Notified</i>: Same as <strong class=" ">Expired</strong> but also indicates that the requesting administrator has been notified about that his request have expired.</p>
</li><li class=" "><p   
><i class=" ">Executed</i>: Means that the action request have been executed successfully. Used by action requests that are executable.</p>
</li><li class=" "><p   
><i class=" ">Execution Failed</i>: Means that the action request failed for some reason during execution, see log for more information. Used by action requests that are executable.</p>
</li><li class=" "><p   
><i class=" ">Execution Denied</i>: Means that the action request hasn't been approved and will not be executed. The difference with status <strong class=" ">Rejected</strong> is that this status is only used with executable requests and do not have any expire time. This means that the requesting administrator can apply again directly after the rejection.</p>
</li></ul>    </div>
    <div class="section section-1" id="src-16224729_id-.ApprovingActionsv6.12.0-ApprovalNotificationApproval_Notification">
        <h1 class="heading "><span id="src-16224729_id-.ApprovingActionsv6.12.0-Approval_Notification" class="confluence-anchor-link"></span><span>Approval Notification </span></h1>
<p   
>EJBCA approval functionality have been enhanced to send e-mail notifications to administrators affected by the approval workflow and/or the end user.</p>
<p   
>Notifications are configured per approval partition. An approval notification is sent for a partition when the partition:</p>
<ul class=" "><li class=" "><p   
>Has been acted upon.</p>
</li><li class=" "><p   
>Becomes approvable due to the previous step being finished.</p>
</li><li class=" "><p   
>No longer is approvable since a parallel partition has been rejected or the request has expired.</p>
</li></ul><p   
>Ensure to configure mail-server settings in the mail.properties file.</p>
    <div class="section section-2" id="src-16224729_id-.ApprovingActionsv6.12.0-DynamicSubstitutionVariablesforapprovalnotificationsDynamic_Substitution_Variables_for_appro">
        <h2 class="heading "><span id="src-16224729_id-.ApprovingActionsv6.12.0-Dynamic_Substitution_Variables_for_appro" class="confluence-anchor-link"></span><span>Dynamic Substitution Variables for approval notifications </span></h2>
<p   
>Variables used with approval notifications:</p>
<ul class=" "><li class=" "><p   
>${approvalRequest.ID} The approval request identifier.</p>
</li><li class=" "><p   
>${approvalRequest.STEP_ID} The approval step that this notification concerns.</p>
</li><li class=" "><p   
>${approvalRequest.PARTITION_ID} The ID of the approval partition in the step that this notification concerns.</p>
</li><li class=" "><p   
>${approvalRequest.PARTITION_NAME} The name of the approval partition in the step that this notification concerns.</p>
</li><li class=" "><p   
>${approvalRequest.TYPE} The type of approval request.</p>
</li><li class=" "><p   
>${approvalRequest.WORKFLOWSTATE} The work flow state from the perspective of the one(s) responsible for handling the partition.</p>
</li><li class=" "><p   
>${approvalRequest.REQUESTOR} The human readable version of the authentication token that was used to create the request.</p>
</li><li class=" "><p   
>${approvalRequest.APPROVALADMIN} The human readable version of the authentication token that was used to last approve the request, if any.</p>
</li></ul><p   
>The work flow states are:</p>
<ul class=" "><li class=" "><p   
>APPROVED: The partition has been approved and no longer requires any action.</p>
</li><li class=" "><p   
>APPROVED_PARTIALLY: The partition has been approved, but is still pending additional approvals.</p>
</li><li class=" "><p   
>REJECTED: The partition has been rejected and no longer requires any action.</p>
</li><li class=" "><p   
>REQUIRES_ACTION: The partition requires an action from admin.</p>
</li><li class=" "><p   
>EXPIRED: The partition (and also currently the whole approval) has expired and no longer requires any action.</p>
</li></ul>    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Admin_GUI_Overview.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Admin GUI Overview</span>
        </a>
                <a href="Configure_an_RA_for_Public_Access.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Configure an RA for Public Access</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
