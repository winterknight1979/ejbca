<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Command Line Interfaces - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=16229404"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Operations.html">EJBCA Operations</a></li>
                                                                                     <li><a href="EJBCA_User_Guide.html">EJBCA User Guide</a></li>
                                                            </ul>
</div>            <h1 id="src-16229404"> <span>Command Line Interfaces</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>The following EJBCA Command Line Interfaces (CLI) are available:</p>
<ul class=" "><li class=" "><p   
><a   href="EJBCA_Client_Toolbox.html">EJBCA Client Toolbox</a>: Set of tools built as a stand-alone package, which can be put on any machine and run independently of EJBCA. Includes a <a   href="Web_Service_Interface.html#src-23856312_id-.WebServiceInterfacev6.15.0-Configuring_Web_Services_CLI">Web Service CLI</a>.</p>
</li></ul><ul class=" "><li class=" "><p   
><a   href="EJBCA_Validation_Conformance_Tool.html">EJBCA Validation/Conformance Tool</a>: Allows running tests on issued certificates or OCSP responses to see that they match the configured criteria.</p>
</li></ul><ul class=" "><li class=" "><p   
><a   href="#src-16229404_id-.CommandLineInterfacesv6.13.0-Local_Command_line_interface">Local Command Line Interface (EJBCA CLI)</a>: The Local CLI can be run directly on the CA machine and contains many functions that can be used in scripts, or come to rescue when your Admin certificate has expired, or you have accidentally revoked your Admin privileges for the Admin GUI.</p>
</li></ul><ul class=" "><li class=" "><p   
><a   href="#src-16229404_safe-id-aWQtLkNvbW1hbmRMaW5lSW50ZXJmYWNlc3Y2LjEzLjAtTG9jYWxfRGF0YWJhc2VfQ0xJXyhFSkJDQV9FbnRlcnByaXNlX29ubA">Local Database CLI</a>: Accessing a database, export and import, copy, verify audit log and OCSP monitoring.</p>
</li></ul><ul class=" "><li class=" "><p   
><a   href="#">CAA Lookup Tool</a>: Providing additional verification, fallback and troubleshooting for the built-in <a   href="Certificate_Field_Validators.html">CAA Validator</a>.</p>
</li></ul>    <div class="section section-1" id="src-16229404_safe-id-aWQtLkNvbW1hbmRMaW5lSW50ZXJmYWNlc3Y2LjEzLjAtTG9jYWxDb21tYW5kTGluZUludGVyZmFjZShFSkJDQUNMSSlMb2NhbF9Db21tYW5kX2xpbmVfaW50ZXJmYWNl">
        <h1 class="heading "><span id="src-16229404_id-.CommandLineInterfacesv6.13.0-Local_Command_line_interface" class="confluence-anchor-link"></span><span>Local Command Line Interface (EJBCA CLI) </span></h1>
<p   
>The Local CLI can be run directly on the CA machine and contains many functions that can be used in scripts, or come to rescue when your Admin certificate has expired, or you have accidentally revoked your Admin privileges for the Admin GUI.</p>
<p   
>EJBCA has command line interfaces to both the CA and RA, as well as some other operations.</p>
<p   
>To list available commands, run the CLI using for example:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">bin/ejbca.sh</code></div>
</div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">bin/ejbca.sh ca</code></div>
</div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">bin/ejbca.sh ra</code></div>
</div>
    </div>
<p   
>To list available options for a specific command, run the command without any options, for example:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">bin/ejbca.sh ra addendentity</code></div>
</div>
    </div>
<p   
>To access usage information for certain commands that do not take parameters, provide the <strong class=" ">-?</strong> option.</p>
<p   
>Note that when providing files as input to the CLI it is advisable to use full path names as the working directory may not be what you think.</p>
    <div class="section section-2" id="src-16229404_id-.CommandLineInterfacesv6.13.0-ReturnCodesReturn_Codes">
        <h2 class="heading "><span id="src-16229404_id-.CommandLineInterfacesv6.13.0-Return_Codes" class="confluence-anchor-link"></span><span>Return Codes </span></h2>
<p   
>The local CLI uses the following return codes to facilitate scripting:</p>
<ul class=" "><li class=" "><p   
><strong class=" ">0</strong> - Normal exit.</p>
</li><li class=" "><p   
><strong class=" ">1</strong> - Functional failure, command was entered correctly but failed for some other reason.</p>
</li><li class=" "><p   
><strong class=" ">2</strong> - Authentication failure.</p>
</li><li class=" "><p   
><strong class=" ">3</strong> - CLI failure, command failed due to incorrect parameter use.</p>
</li></ul>    </div>
    <div class="section section-2" id="src-16229404_id-.CommandLineInterfacesv6.13.0-LocalCLIAuthenticationLocal_CLI_Authentication">
        <h2 class="heading "><span id="src-16229404_id-.CommandLineInterfacesv6.13.0-Local_CLI_Authentication" class="confluence-anchor-link"></span><span>Local CLI Authentication </span></h2>
<p   
>By default, the CLI authenticates using a standard user defined in ejbca.properties. Disabling this user on the server will lead to all CLI operations demanding authentication in the form of the following flags appended to the argument list:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">-u &lt;username&gt; -p</code></div>
</div>
    </div>
<p   
>which will cause the console to prompt for the password. If instead the password should be included in the command line (such as) from a script, it can be specified using the following flags:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">-u &lt;username&gt; --clipassword=&lt;password&gt;</code></div>
</div>
    </div>
<p   
>You can also specify that the password is provided as the first line in a file, which can be useful for scripting. It can be specified prepending 'file:' to the password:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">-u &lt;username&gt; --clipassword=</code><code class="functions">file</code><code class="plain">:&lt;filename&gt;</code></div>
</div>
    </div>
<p   
>Where <i class=" ">filename</i> is a file, for example /tmp/pwd.txt, containing the password as a single line.</p>
<p   
>An example CLI command to list CAs can look like:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">bin</code><code class="plain">/ejbca</code><code class="plain">.sh ca listcas -u ejbca --clipassword=</code><code class="functions">file</code><code class="plain">:</code><code class="plain">/tmp/pwd</code><code class="plain">.txt</code></div>
</div>
    </div>
<p   
>Command line users are authenticated from the existing list of End Entities and are granted the same rights. You can find the default CLI user in the <strong class=" ">Super Administrator Role</strong> listed under <strong class=" ">Administrator Roles</strong> after a default install or upgrade. You can add new CLI users by adding an end entity and adding a member to a Role using the <strong class=" ">CLI:Username</strong> authentication token.</p>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Deleting this user or revoking all its privileges makes it impossible to use the CLI for any operation that requires administrator rights including renewing the Super Administrator certificate. Make sure to renew the administrator certificates using the Admin Web before they expire!</p>
        </div>
    </div>
    </div>
    <div class="section section-2" id="src-16229404_id-.CommandLineInterfacesv6.13.0-DisablingtheCommandLineInterfaceDisabling_the_Command_Line_Interface">
        <h2 class="heading "><span id="src-16229404_id-.CommandLineInterfacesv6.13.0-Disabling_the_Command_Line_Interface" class="confluence-anchor-link"></span><span>Disabling the Command Line Interface </span></h2>
<p   
>You can disable the command line interface to prevent a user running operations that require authorization. Go to <strong class=" ">System Functions&gt;System Configuration</strong> and clear the option <strong class=" ">Enable Command Line Interface Access</strong> to disable performing operations requiring authorization from the command line interface.</p>
<p   
>The <strong class=" ">Enable Command Line Interface Access</strong> option, in contrast to disabling the CLI users privileges in <strong class=" ">Administrator Roles</strong>, allows switching having the CLI enabled or disabled as long as you have access to the Admin GUI.</p>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Disabling <strong class=" ">Enable Command Line Interface Access</strong> makes it impossible to use the CLI for any operation that requires administrator rights, including renewing the Super Administrator certificate. <i class=" ">Make sure to renew the administrator certificates using the Admin Web before they expire</i>!</p>
        </div>
    </div>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>After changing this property, you may need to select <strong class=" ">Clear All Caches</strong> or run the following CLI command:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ bin</code><code class="plain">/ejbca</code><code class="plain">.sh clearcache -all</code></div>
</div>
    </div>
        </div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-16229404_safe-id-aWQtLkNvbW1hbmRMaW5lSW50ZXJmYWNlc3Y2LjEzLjAtTG9jYWxEYXRhYmFzZUNMSUxvY2FsX0RhdGFiYXNlX0NMSV8oRUpCQ0FfRW50ZXJwcmlzZV9vbmw">
        <h1 class="heading "><span id="src-16229404_safe-id-aWQtLkNvbW1hbmRMaW5lSW50ZXJmYWNlc3Y2LjEzLjAtTG9jYWxfRGF0YWJhc2VfQ0xJXyhFSkJDQV9FbnRlcnByaXNlX29ubA" class="confluence-anchor-link"></span><span>Local Database CLI </span></h1>
<p   
></p>
<p   
><span class="status blue " >ENTERPRISE</span>
 This is an EJBCA Enterprise feature.</p>
<p   
>You can build and run the local database CLI using the commands:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ ant ejbca-db-cli</code></div>
<div class="line"><code class="plain">$ </code><code class="functions">cd</code><code class="plain"> dist</code><code class="plain">/ejbca-db-cli</code></div>
<div class="line"><code class="plain">$ .</code><code class="plain">/run</code><code class="plain">.sh</code></div>
</div>
    </div>
<p   
>The CLI contains commands for directly accessing a database, export, import, copy, verify audit log and OCSP monitoring. Run the command to get a description about all available commands.</p>
<p   
>To verify database protection, make sure that you have conf/databaseprotection.properties configured. If you are using database protection for your CA, you can use the same file.</p>
<p   
>For verification, you can also use a verification token, without the private key, so you can do verification on another host from the CA. The file conf/databaseprotection.properties.sample provide example configuration and documentation for the various options.</p>
<p   
>You can also use the DB tool to create databaseprotection in case you started off not enabling it, and want to enable it later.</p>
<ul class=" "><li class=" "><p   
>Shut down EJBCA</p>
</li><li class=" "><p   
>Configure databaseprotection.properties and build ejbca-db-cli (so the propereties file is included in dist/ejbca-db-cli/conf)</p>
</li><li class=" "><p   
>Export the database with db-cli</p>
</li><li class=" "><p   
>Drop the database</p>
</li><li class=" "><p   
>Import the database with db-cli</p>
</li></ul>    </div>
    <div class="section section-1" id="src-16229404_id-.CommandLineInterfacesv6.13.0-CAALookupTool">
        <h1 class="heading "><span>CAA Lookup Tool</span></h1>
<p   
></p>
<p   
><span class="status blue " >ENTERPRISE</span>
 This is an EJBCA Enterprise feature.</p>
<p   
>As of EJBCA 6.9.0, full support is provided for CAs through the built-in <a   href="Certificate_Field_Validators.html">CAA Validator</a>. To provide additional verification, fallback and troubleshooting, a command line tool is provided, using the same underlying code to perform CAA requests from the command line. To build this tool and find out how it works, perform the following actions:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">$ ant ejbca-caa-cli</code></div>
<div class="line"><code class="plain">$ java -jar </code></div>
<div class="line"><code class="plain">$ java -jar dist</code><code class="plain">/caa-cli/caa-cli</code><code class="plain">.jar --help</code></div>
</div>
    </div>
<p   
></p>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Custom_RA_Stylesheets.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Custom RA Stylesheets</span>
        </a>
                <a href="EJBCA_Client_Toolbox.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>EJBCA Client Toolbox</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
