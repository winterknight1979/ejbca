<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>JBoss 7 GA / JBoss EAP 6 - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=16233895"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Installations.html">EJBCA Installations</a></li>
                                                                                     <li><a href="Application_Servers.html">Application Servers</a></li>
                                                            </ul>
</div>            <h1 id="src-16233895"> <span>JBoss 7 GA / JBoss EAP 6</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>JBoss 7 / EAP 6 are the official well tested platforms for EJBCA 6.x and the majority of the development is done against JBoss.</p>
<p   
>To run JBoss EAP 6 with Java 8 you will at least need EAP 6.4.1+ (OpenJDK 8) or EAP 6.3.4 (OracleJDK 8).</p>
<p   
>Note that JBoss AS 7.1.1.GA will not work with Java 8.</p>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3M3L0VBUDZHZW5lcmFsTm90ZXM">
        <h1 class="heading "><span>JBoss 7/EAP 6 General Notes</span></h1>
<p   
>Version JBoss AS 7.1.1.Final and EAP 6.1-6.4 (and possibly later ones) have been tested with EJBCA and works. However, note the following:</p>
<p   
></p>
<ul class=" "><li class=" "><p   
>Start and connect with the JBoss 7/EAP6 cli like this:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">./jboss-cli.sh</code></div>
<div class="line"><code class="plain">connect</code></div>
</div>
    </div>
</li><li class=" "><p   
>If you are having problems with HornetQ start-up, try switching to Java NIO with the following commands in JBoss CLI administration tool:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem=messaging/hornetq-server=default:write-attribute(name=journal-type,value=NIO)</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
</li><li class=" "><p   
>You don't need to start/stop JBoss 7. Deployment is done with a live system (in fact you should have the JBoss 7 running at all times).</p>
</li></ul><p   
></p>
    </div>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3M3L0VBUDZKREJDRHJpdmVyc2FuZERhdGFTb3VyY2Vz">
        <h1 class="heading "><span>JBoss 7/EAP 6 JDBC Drivers and Data Sources</span></h1>
<p   
>In JBoss 7/EAP6 it is not enough to just drop the JAR archive with a database JDBC driver into the deployments directory. Instead you will have to perform the following steps (for MySQL):</p>
<ol class=" "><li class=" "><pre class=" ">Create the necessary directories (relative to JBoss 7 base directory): <br/>On JBoss 7.1.1 or EAP 6.0:<code class=" "> mkdir -p modules/com/mysql/main/</code></pre><pre class=" ">On JBoss 7.2 or EAP 6.1/6.2:<code class=" "> mkdir -p modules/system/layers/base/com/mysql/main/</code></pre><pre class=" ">Or for MariaDB, mariadb-java-client-1.2.0.jar:<code class=" "> mkdir -p modules/org/mariadb/main/</code></pre><pre class=" ">On JBoss 7.2 or EAP 6.1/6.2:<code class=" "> mkdir -p modules/system/layers/base/org/mariadb/main/</code></pre><pre class=" "> </pre></li><li class=" "><p   
>Place the mysql.jar or mariadb.jar file in the directory you just created.</p>
</li><li class=" "><p   
>Create, in the created directory, the JDBC module configuration file module.xml with the following contents (replace mysql.jar with the full name of your jar file for example mysql-connector-java-5.1.18-bin.jar):</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;?</code><code class="keyword">xml</code><code class="plain"> </code><code class="color1">version</code><code class="plain">=</code><code class="string">"1.0"</code><code class="plain"> </code><code class="color1">encoding</code><code class="plain">=</code><code class="string">"UTF-8"</code><code class="plain">?&gt;</code></div>
<div class="line"><code class="plain">&lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">xmlns</code><code class="plain">=</code><code class="string">"urn:jboss:module:1.0"</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"com.mysql"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">resources</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">resource</code><code class="plain">-root </code><code class="color1">path</code><code class="plain">=</code><code class="string">"mysql.jar"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">  &lt;/</code><code class="keyword">resources</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">dependencies</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"javax.api"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"javax.transaction.api"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">  &lt;/</code><code class="keyword">dependencies</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">module</code><code class="plain">&gt;</code></div>
</div>
    </div>
<p   
>Or for MariaDB, mariadb-java-client-1.2.0.jar:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;?</code><code class="keyword">xml</code><code class="plain"> </code><code class="color1">version</code><code class="plain">=</code><code class="string">"1.0"</code><code class="plain"> </code><code class="color1">encoding</code><code class="plain">=</code><code class="string">"UTF-8"</code><code class="plain">?&gt;</code></div>
<div class="line"><code class="plain">&lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">xmlns</code><code class="plain">=</code><code class="string">"urn:jboss:module:1.0"</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"org.mariadb"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">resources</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">resource</code><code class="plain">-root </code><code class="color1">path</code><code class="plain">=</code><code class="string">"mariadb-java-client-1.2.0.jar"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">  &lt;/</code><code class="keyword">resources</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">dependencies</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"javax.api"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"javax.transaction.api"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"org.slf4j"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">  &lt;/</code><code class="keyword">dependencies</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">module</code><code class="plain">&gt;</code></div>
</div>
    </div>
</li><li class=" "><p   
>Register the driver by running the following commands in the JBoss 7 CLI administration tool:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem=datasources/jdbc-driver=com.mysql.jdbc.Driver:add(driver-name=com.mysql.jdbc.Driver,driver-class-name=com.mysql.jdbc.Driver,driver-module-name=com.mysql,driver-xa-datasource-class-name=com.mysql.jdbc.jdbc2.optional.MysqlXADataSource)</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
<p   
>Or for MariaDB, mariadb-java-client-1.2.0.jar:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem=datasources/jdbc-driver=org.mariadb.jdbc.Driver:add(driver-name=org.mariadb.jdbc.Driver,driver-module-name=org.mariadb,driver-xa-datasource-class-name=org.mariadb.jdbc.MySQLDataSource)</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
</li></ol><p   
>For PostgreSQL, use the following values instead:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">mkdir -p modules/system/layers/base/org/postgresql/main/</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">&lt;?</code><code class="keyword">xml</code><code class="plain"> </code><code class="color1">version</code><code class="plain">=</code><code class="string">"1.0"</code><code class="plain"> </code><code class="color1">encoding</code><code class="plain">=</code><code class="string">"UTF-8"</code><code class="plain">?&gt;</code></div>
<div class="line"><code class="plain">&lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">xmlns</code><code class="plain">=</code><code class="string">"urn:jboss:module:1.0"</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"org.postgresql"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">resources</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">resource</code><code class="plain">-root </code><code class="color1">path</code><code class="plain">=</code><code class="string">"postgresql-9.1-903.jdbc4.jar"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">  &lt;/</code><code class="keyword">resources</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">dependencies</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"javax.api"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">module</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"javax.transaction.api"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">  &lt;/</code><code class="keyword">dependencies</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">module</code><code class="plain">&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">/subsystem=datasources/jdbc-driver=org.postgresql.Driver:add(driver-name=org.postgresql.Driver,driver-module-name=org.postgresql,driver-xa-datasource-class-name=org.postgresql.xa.PGXADataSource)</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
<p   
>Datasources are normally created automatically by EJBCA during deployment and installation. Here we describe how to create a datasource in JBoss7/EAP6 for reference. The examples are for installing a MariaDB datasource using the jboss-cli with the driver installed as described above.</p>
<p   
>A normal datasource:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">data-source add --name=ejbcads --driver-name="org.mariadb.jdbc.Driver" --connection-url="jdbc:</code><code class="comments">mysql://127.0.0.1:3306/ejbca</code><code class="plain">" --jndi-name="java:/EjbcaDS" --use-ccm=true --driver-class="org.mariadb.jdbc.Driver" --user-name="ejbca" --password="ejbca" --validate-on-match=true --background-validation=false --prepared-statements-cache-size=50 --share-prepared-statements=true --min-pool-size=5 --max-pool-size=150 --pool-prefill=true --transaction-isolation=TRANSACTION_READ_COMMITTED --check-valid-connection-sql="select 1;"</code></div>
</div>
    </div>
<p   
>A no-tx / jta=&quot;false&quot; datasource (OCSP publisher and Unid):</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">data-source add --name=unidds --jta=false --driver-name="org.mariadb.jdbc.Driver" --connection-url="jdbc:</code><code class="comments">mysql://127.0.0.1:3306/unid</code><code class="plain">" --jndi-name="java:/UnidDS" --use-ccm=true --driver-class="org.mariadb.jdbc.Driver" --user-name="uniduser" --password="unidpass" --validate-on-match=true --background-validation=false --prepared-statements-cache-size=50 --share-prepared-statements=true --min-pool-size=5 --max-pool-size=150 --pool-prefill=true --transaction-isolation=TRANSACTION_READ_COMMITTED --check-valid-connection-sql="select 1"</code></div>
</div>
    </div>
<p   
><img  class="emoticon emoticon-warning"  src="images/s/en_US/8100/b0984b7297905b7c7bd946458f753ce0130bfc8c/_/images/icons/emoticons/warning.svg" alt="images/s/en_US/8100/b0984b7297905b7c7bd946458f753ce0130bfc8c/_/images/icons/emoticons/warning.svg"   />
 Note that <strong class=" ">select 1</strong> must be different for DB2 and Oracle.</p>
<p   
><img  class="emoticon emoticon-warning"  src="images/s/en_US/8100/b0984b7297905b7c7bd946458f753ce0130bfc8c/_/images/icons/emoticons/warning.svg" alt="images/s/en_US/8100/b0984b7297905b7c7bd946458f753ce0130bfc8c/_/images/icons/emoticons/warning.svg"   />
 For JBoss EAP 6, add <strong class=" ">--enabled=true</strong> to the commands above in order for the datasource to be enabled.</p>
    </div>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3M3YW5kRUFQNkxvZ2dpbmc">
        <h1 class="heading "><span>JBoss 7 and EAP 6 Logging</span></h1>
<p   
>Logging can be configured using the CLI:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/system-property=org.jboss.as.logging.per-deployment:add(value=false) </code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.ejbca:add </code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.ejbca:write-attribute(name=level, value=DEBUG) </code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore:add </code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore:write-attribute(name=level, value=DEBUG)</code></div>
</div>
    </div>
<p   
>The per-deployment feature was added in EAP 6.0.0 and is not present in GA 7.1.</p>
<p   
>In JBoss EAP 6 you can also configure a completely custom Log4J configuration by:</p>
<ul class=" "><li class=" "><p   
>Do not disable <code class=" ">org.jboss.as.logging.per-deployment</code> above. It is by default enabled and can also be set to true manually.</p>
</li><li class=" "><p   
>Create a $EJBCA_HOME/conf/log4j-jbosseap6.xml, you can use log4j-jbosseap6.xml.sample as a template. Set paths to the desired log files.</p>
</li><li class=" "><p   
>Redeploy with 'ant clean deployear'.</p>
</li></ul>    </div>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3M3L0VBUDZQS0NTMTE">
        <h1 class="heading subsubsection"><span>JBoss 7/EAP 6 PKCS11</span></h1>
<p   
>    <span style="color: #707070;">
    <span style="color: #000000;">
JBoss 7/EAP 6 by default isolates away most sun classes. As of version 6.6.3, EJBCA configures JBoss to expose these classes (sun/security/pkcs11/wrapper) by using a     </span>
    </span>
<code class=" ">jboss-deployment-structure.xml</code>. This makes configuration in <code class=" ">modules/sun/jdk/main/module.xml</code> (JBoss 7.1/EAP6.0) or <code class=" ">modules/system/layers/base/sun/jdk/main/module.xml </code>(JBoss EAP 6.1 and later and WildFly) not needed. For previous versions of EJBCA, refer to the documentation for the respective release</p>
<p   
></p>
    </div>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3M3L0VBUDZDTVBUQ1A">
        <h1 class="heading "><span>JBoss 7/EAP 6 CMP TCP</span></h1>
<p   
>Note that the TCP transport of the CMP protocol is deprecated in the standard draft. TCP transport may be removed in future EJBCA releases.</p>
<p   
>JBoss 7/EAP 6 isolates away most sun classes. This means that the CMP TCP library is not able to get system properties. The needed classes can be made available by editing the file <code class=" ">modules/sun/jdk/main/module.xml</code> (JBoss 7.1/EAP6.0) or <code class=" ">modules/system/layers/base/sun/jdk/main/module.xml</code> (JBoss 7.2/EAP6.1)) and adding the following package to the list of system export paths:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">path</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"sun/security/action"</code><code class="plain">/&gt;</code></div>
</div>
    </div>
<p   
></p>
    </div>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3M3L0VBUDZVUklFbmNvZGluZ2FuZFdTRExMb2NhdGlvbg">
        <h1 class="heading "><span>JBoss 7/EAP 6 URI Encoding and WSDL Location</span></h1>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>This section is a reference section, the configuration here are done automatically in JBoss 7 by the <code class=" ">ant deploy</code> command in EJBCA.</p>
        </div>
    </div>
<p   
>The following configuration is recommended to be able to use international characters during certificate and CRL download:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain"> /system-property=org.apache.catalina.connector.URI_ENCODING:add(value=UTF-8)</code></div>
<div class="line"><code class="plain"> /system-property=org.apache.catalina.connector.USE_BODY_ENCODING_FOR_QUERY_STRING:add(value=true)</code></div>
</div>
    </div>
<p   
>On JBoss 7.1.x (and EAP 6.0.x) the WSDL location gets incorrectly generated by default (JBoss bind address, plain http). This will cause the WS client to not work. This can be corrected using the JBoss CLI (the change requires a reload of JBoss server):</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem</code><code class="plain">=webservices:write-attribute(name=wsdl-host, value=jbossws.undefined.host)</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
<p   
>to force the location to be generated with info from the WSDL request. If this is not done you will get SSL errors about missing client certificate, or &quot;HTTP 302 Moved Temporarily&quot; errors when running the WS client.</p>
    </div>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3NNYWlsVExTQ29uZmlndXJhdGlvbg">
        <h1 class="heading subsubsection"><span>JBoss Mail TLS Configuration </span></h1>
<p   
>There are at least two ways to use TLS for SMTP connection:</p>
<ul class=" "><li class=" "><p   
>SMTP STARTTLS</p>
</li><li class=" "><p   
>TLS required</p>
</li></ul><p   
>The first method can be configured with the setting <i class=" ">mail.smtp.starttls.enable</i> in conf/mail.properties. Since mail configuration is done differently in different versions of JBoss we only provide guidance for the second version. There are two options that might be needed:</p>
<ul class=" "><li class=" "><pre class=" ">mail.smtp.ssl.enable=true</pre></li><li class=" "><pre class=" ">mail.smtp.socketFactory.class=<a  class="external-link" href="http://javax.net/">javax.net</a>.ssl.SSLSocketFactory</pre></li></ul><p   
>For JBoss 7/EAP 6 they should be set using the JBoss command line admin tool.</p>
<p   
></p>
    </div>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3NTZXJ2aWNlVGltZXJQZXJzaXN0ZW5jZQ">
        <h1 class="heading "><span>JBoss Service Timer Persistence</span></h1>
<p   
>EJBCA uses EJB timers to run services regularly (if you have services configured). By default JBoss persists timers in an internal, in memory, database. If you run services very often this can under some circumstances fill up the memory causing the server to be non-operational due to out of memory errors.</p>
<p   
>EJBCA does not need persistent timers since they are initialized during startup. Therefore it is recommended to run JBoss with non-persistent timers, something that can be configured.</p>
    <div class="section section-2" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3M3L0VBUDZjb25maWd1cmF0aW9uOg">
        <h2 class="heading "><span>JBoss 7/EAP6 configuration:</span></h2>
<p   
>JBoss 7 does not use the in memory database to persist timers, but instead stores them in <i class=" ">jboss/standalone/data/timer-service-data/ejbca.ejbca-ejb.ServiceSessionBean</i>. This is supposed to ensure that it will not fill up the memory as it did in JBoss 5.<br/>If persisted timers needs to be removed in JBoss 7 the directory <i class=" ">jboss/standalone/data/timer-service-data</i> can simply be deleted.</p>
    </div>
    </div>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3M3L0VBUDZEZXBsb3ltZW50VGltZW91dA">
        <h1 class="heading "><span>JBoss7/EAP6 Deployment Timeout</span></h1>
<p   
>In the case the deployment fails to complete within 60 seconds it will fail. You can increase this timeout with:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem=deployment-scanner/scanner=default:write-attribute(name=deployment-timeout,value=300) </code></div>
</div>
    </div>
<p   
>Unless there is a clear reason why this takes longer than 60 seconds (for example an HSM waiting for human input, or a very slow server, check that database indexes are applied and that your network and any used DNS server is fully operational.</p>
    </div>
    <div class="section section-1" id="src-16233895_safe-id-aWQtLkpCb3NzN0dBL0pCb3NzRUFQNnY2LjE0LjAtSkJvc3M3YW5kT3JhY2xlSkRLQkNJc3N1ZXM">
        <h1 class="heading "><span>JBoss 7 and Oracle JDK BC Issues</span></h1>
<p   
>In EJBCA 6.0.4 <a  class="external-link" href="https://jira.primekey.se/browse/ECA-3371">ECA-3371</a> solved the issue of deploying with OracleJDK.</p>
<p   
></p>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Application_Servers.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Application Servers</span>
        </a>
                <a href="WildFly_10___JBoss_EAP_7.0.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>WildFly 10 / JBoss EAP 7.0</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
