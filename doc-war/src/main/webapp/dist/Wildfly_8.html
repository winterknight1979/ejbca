<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Wildfly 8 - EJBCA - Documentation Space</title>

    
            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="85921598">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_6.15.2.6_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=16233903"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_6.15.2.6_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Installations.html">EJBCA Installations</a></li>
                                                                                     <li><a href="Application_Servers.html">Application Servers</a></li>
                                                            </ul>
</div>            <h1 id="src-16233903"> <span>Wildfly 8</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>EJBCA 6.x compiles, deploys and runs with WildFly 8 and WildFly 9 (release following 6.3.1.1).</p>
<p   
>For WildFly, deploy and install do not automatically configure the application server for you. Configure the application server according to the following instructions:</p>
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-16233903_id-.Wildfly8v6.14.0-AddDatabaseDriver">Add Database Driver</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_id-.Wildfly8v6.14.0-IncreaseallowedMemoryUsage">Increase allowed Memory Usage</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_id-.Wildfly8v6.14.0-AddDatasource">Add Datasource</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_id-.Wildfly8v6.14.0-ConfigureJBossRemoting">Configure JBoss Remoting</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_id-.Wildfly8v6.14.0-ConfigureLogging">Configure Logging</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_id-.Wildfly8v6.14.0-RemoveexistingTLSandHTTPConfiguration">Remove existing TLS and HTTP Configuration</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_id-.Wildfly8v6.14.0-DeployEJBCA">Deploy EJBCA</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_id-.Wildfly8v6.14.0-RunInstall">Run Install</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_id-.Wildfly8v6.14.0-ConfigureTLS">Configure TLS</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_safe-id-aWQtLldpbGRmbHk4djYuMTQuMC1PcHRpb25hbDpFbmFibGVBSlBDb25uZWN0b3I">Optional: Enable AJP Connector</a></p>
</li><li class=" "><p   
><a   href="#src-16233903_safe-id-aWQtLldpbGRmbHk4djYuMTQuMC1PcHRpb25hbDpBZGRTdXBwb3J0Zm9yUEtDUyMxMShIU01zKQ">Optional: Add Support for PKCS#11 (HSMs)</a></p>
</li></ul>    <div class="section section-1" id="src-16233903_id-.Wildfly8v6.14.0-AddDatabaseDriver">
        <h1 class="heading "><span>Add Database Driver</span></h1>
<p   
>Add MariaDB database driver by hot-deploying it into the Ddeployment directory. This will be picked up by WildFly and deployed so we can create a datasource straight away. You can use a generic name, without version number, in order to get a generic 'driver-name' for the data source command.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&gt;</code><code class="functions">cp</code><code class="plain"> mariadb-java-client-1.2.0.jar wildfly_home</code><code class="plain">/standalone/deployments/mariadb-java-client</code><code class="plain">.jar</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-16233903_id-.Wildfly8v6.14.0-IncreaseallowedMemoryUsage">
        <h1 class="heading "><span>Increase allowed Memory Usage</span></h1>
<p   
>By default, only 512MiB of heap and 256MiB perm gen space is allowed. Edit <strong class=" ">wildfly_home/bin/standalone.conf</strong> to increase this to a more suitable value, for example:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">  JAVA_OPTS=</code><code class="string">"-Xms2048m -Xmx2048m -XX:MaxPermSize=384m -Djava.net.preferIPv4Stack=true"</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-16233903_id-.Wildfly8v6.14.0-AddDatasource">
        <h1 class="heading "><span>Add Datasource</span></h1>
<p   
>Add data source for EJBCA to use. Start JBoss and run the following commands in JBoss CLI:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&gt; wildfly_home</code><code class="plain">/bin/jboss-cli</code><code class="plain">.sh -c</code></div>
<div class="line"><code class="plain">&gt; data-</code><code class="functions">source</code><code class="plain"> add --name=ejbcads --driver-name=</code><code class="string">"mariadb-java-client.jar"</code><code class="plain"> --connection-url=</code><code class="string">"jdbc:mysql://127.0.0.1:3306/ejbca"</code><code class="plain"> --jndi-name=</code><code class="string">"java:/EjbcaDS"</code><code class="plain"> --use-ccm=</code><code class="functions">true</code><code class="plain"> --driver-class=</code><code class="string">"org.mariadb.jdbc.Driver"</code><code class="plain"> --user-name=</code><code class="string">"ejbca"</code><code class="plain"> --password=</code><code class="string">"ejbca"</code><code class="plain"> --validate-on-match=</code><code class="functions">true</code><code class="plain"> --background-validation=</code><code class="functions">false</code><code class="plain"> --prepared-statements-cache-size=50 --share-prepared-statements=</code><code class="functions">true</code><code class="plain"> --min-pool-size=5 --max-pool-size=150 --pool-prefill=</code><code class="functions">true</code><code class="plain"> --transaction-isolation=TRANSACTION_READ_COMMITTED --check-valid-connection-sql=</code><code class="string">"select 1;"</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-16233903_id-.Wildfly8v6.14.0-ConfigureJBossRemoting">
        <h1 class="heading "><span>Configure JBoss Remoting</span></h1>
<p   
>EJBCA needs to use JBoss Remoting for the EJBCA CLI to work. We configure it to use a separate port (if any old configuration exists, start by removing it):</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/socket-binding-group</code><code class="plain">=standard-sockets</code><code class="plain">/socket-binding</code><code class="plain">=remoting:remove</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/http-listener</code><code class="plain">=remoting:remove</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=remoting</code><code class="plain">/http-connector</code><code class="plain">=http-remoting-connector:remove</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=remoting</code><code class="plain">/http-connector</code><code class="plain">=http-remoting-connector:add(connector-ref=</code><code class="string">"remoting"</code><code class="plain">,security-realm=</code><code class="string">"ApplicationRealm"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/socket-binding-group</code><code class="plain">=standard-sockets</code><code class="plain">/socket-binding</code><code class="plain">=remoting:add(port=</code><code class="string">"4447"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/http-listener</code><code class="plain">=remoting:add(socket-binding=remoting)</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-16233903_id-.Wildfly8v6.14.0-ConfigureLogging">
        <h1 class="heading "><span>Configure Logging</span></h1>
<p   
>To be able to dynamically change logging, configure logging in JBoss. In the following example, DEBUG is enabled:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem</code><code class="plain">=logging</code><code class="plain">/logger</code><code class="plain">=org.ejbca:add</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=logging</code><code class="plain">/logger</code><code class="plain">=org.ejbca:write-attribute(name=level, value=DEBUG)</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=logging</code><code class="plain">/logger</code><code class="plain">=org.cesecore:add</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=logging</code><code class="plain">/logger</code><code class="plain">=org.cesecore:write-attribute(name=level, value=DEBUG)</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-16233903_id-.Wildfly8v6.14.0-RemoveexistingTLSandHTTPConfiguration">
        <h1 class="heading "><span>Remove existing TLS and HTTP Configuration</span></h1>
<p   
>To remove existing TLS and HTTP configuration (just to be safe), run the following commands in JBoss CLI:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/core-service</code><code class="plain">=management</code><code class="plain">/security-realm</code><code class="plain">=SSLRealm</code><code class="plain">/authentication</code><code class="plain">=truststore:remove</code></div>
<div class="line"><code class="plain">/core-service</code><code class="plain">=management</code><code class="plain">/security-realm</code><code class="plain">=SSLRealm</code><code class="plain">/server-identity</code><code class="plain">=ssl:remove</code></div>
<div class="line"><code class="plain">/core-service</code><code class="plain">=management</code><code class="plain">/security-realm</code><code class="plain">=SSLRealm:remove</code></div>
<div class="line"><code class="plain">/socket-binding-group</code><code class="plain">=standard-sockets</code><code class="plain">/socket-binding</code><code class="plain">=httpspub:remove</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/https-listener</code><code class="plain">=httpspub:remove</code></div>
<div class="line"><code class="plain">/socket-binding-group</code><code class="plain">=standard-sockets</code><code class="plain">/socket-binding</code><code class="plain">=httpspriv:remove</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/https-listener</code><code class="plain">=httpspriv:remove</code></div>
<div class="line"><code class="plain">/socket-binding-group</code><code class="plain">=standard-sockets</code><code class="plain">/socket-binding</code><code class="plain">=http:remove</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/http-listener</code><code class="plain">=http:remove</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/http-listener</code><code class="plain">=default:remove</code></div>
<div class="line"><code class="plain">/system-property</code><code class="plain">=org.apache.catalina.connector.URI_ENCODING:remove</code></div>
<div class="line"><code class="plain">/system-property</code><code class="plain">=org.apache.catalina.connector.USE_BODY_ENCODING_FOR_QUERY_STRING:remove</code></div>
<div class="line"><code class="plain">/interfaces</code><code class="plain">=</code><code class="plain">/interface</code><code class="plain">=http:remove</code></div>
<div class="line"><code class="plain">/interfaces</code><code class="plain">=</code><code class="plain">/interface</code><code class="plain">=httpspub:remove</code></div>
<div class="line"><code class="plain">/interfaces</code><code class="plain">=</code><code class="plain">/interface</code><code class="plain">=httpspriv:remove</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
<p  class="subsubsection" 
>Wait for the reload to complete by checking the server log or the result of<code class=" "> :read-attribute(name=server-state)</code></p>
    </div>
    <div class="section section-1" id="src-16233903_id-.Wildfly8v6.14.0-DeployEJBCA">
        <h1 class="heading "><span>Deploy EJBCA</span></h1>
<p   
>Finally build and deploy the EJBCA (application ear file) to WildFly, without touching any WildFly configuration, by running the following EJBCA command:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ant clean deployear</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-16233903_id-.Wildfly8v6.14.0-RunInstall">
        <h1 class="heading "><span>Run Install</span></h1>
<p   
>Run the installation part of EJBCA creating the initial Management CA (for TLS and Super administrator), as well as TLS and Superadmin keystores.</p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>If you are moving an existing installation that already have TLS keystores available, this step is not needed.</p>
        </div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ant runinstall</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-16233903_id-.Wildfly8v6.14.0-ConfigureTLS">
        <h1 class="heading "><span>Configure TLS</span></h1>
<p   
>Copy keystores to WildFly:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">ant deploy-keystore</code></div>
</div>
    </div>
<p   
>Run the following commands in JBoss CLI to configure TLS (again removing any old configuration first just to be safe):</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/interfaces</code><code class="plain">=</code><code class="plain">/interface</code><code class="plain">=http:add(inet-address=</code><code class="string">"0.0.0.0"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/interfaces</code><code class="plain">=</code><code class="plain">/interface</code><code class="plain">=httpspub:add(inet-address=</code><code class="string">"0.0.0.0"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/interfaces</code><code class="plain">=</code><code class="plain">/interface</code><code class="plain">=httpspriv:add(inet-address=</code><code class="string">"0.0.0.0"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/socket-binding-group</code><code class="plain">=standard-sockets</code><code class="plain">/socket-binding</code><code class="plain">=http:add(port=</code><code class="string">"8080"</code><code class="plain">,interface=</code><code class="string">"http"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/http-listener</code><code class="plain">=http:add(socket-binding=http)</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/http-listener</code><code class="plain">=http:write-attribute(name=redirect-socket, value=</code><code class="string">"httpspriv"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
<p   
>Wait for the reload to complete by checking the server log or the result of <code class=" ">:read-attribute(name=server-state)</code>:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/core-service</code><code class="plain">=management</code><code class="plain">/security-realm</code><code class="plain">=SSLRealm:add()</code></div>
<div class="line"><code class="plain">/core-service</code><code class="plain">=management</code><code class="plain">/security-realm</code><code class="plain">=SSLRealm</code><code class="plain">/server-identity</code><code class="plain">=ssl:add(keystore-path=</code><code class="string">"${jboss.server.config.dir}/keystore/keystore.jks"</code><code class="plain">, keystore-password=</code><code class="string">"serverpwd"</code><code class="plain">, </code><code class="functions">alias</code><code class="plain">=</code><code class="string">"localhost"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/core-service</code><code class="plain">=management</code><code class="plain">/security-realm</code><code class="plain">=SSLRealm</code><code class="plain">/authentication</code><code class="plain">=truststore:add(keystore-path=</code><code class="string">"${jboss.server.config.dir}/keystore/truststore.jks"</code><code class="plain">, keystore-password=</code><code class="string">"changeit"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/socket-binding-group</code><code class="plain">=standard-sockets</code><code class="plain">/socket-binding</code><code class="plain">=httpspriv:add(port=</code><code class="string">"8443"</code><code class="plain">,interface=</code><code class="string">"httpspriv"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/https-listener</code><code class="plain">=httpspriv:add(socket-binding=httpspriv, security-realm=</code><code class="string">"SSLRealm"</code><code class="plain">, verify-client=REQUIRED)</code></div>
<div class="line"><code class="plain">/socket-binding-group</code><code class="plain">=standard-sockets</code><code class="plain">/socket-binding</code><code class="plain">=httpspub:add(port=</code><code class="string">"8442"</code><code class="plain">, interface=</code><code class="string">"httpspub"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/https-listener</code><code class="plain">=httpspub:add(socket-binding=httpspub, security-realm=</code><code class="string">"SSLRealm"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
<p   
>Wait for the reload to complete by checking the server log or the result of<code class=" "> :read-attribute(name=server-state)</code>:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/system-property</code><code class="plain">=org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH:add(value=</code><code class="functions">true</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/system-property</code><code class="plain">=org.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH:add(value=</code><code class="functions">true</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/system-property</code><code class="plain">=org.apache.catalina.connector.URI_ENCODING:add(value=</code><code class="string">"UTF-8"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/system-property</code><code class="plain">=org.apache.catalina.connector.USE_BODY_ENCODING_FOR_QUERY_STRING:add(value=</code><code class="functions">true</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=webservices:write-attribute(name=wsdl-host, value=jbossws.undefined.host)</code></div>
<div class="line"><code class="plain">/subsystem</code><code class="plain">=webservices:write-attribute(name=modify-wsdl-address, value=</code><code class="functions">true</code><code class="plain">)</code></div>
<div class="line"><code class="plain">:reload</code></div>
</div>
    </div>
<p   
>If you are using OCSP GET requests, setting URI encoding and allowing encoding for Query and backslash above are needed.</p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>At this point, WildFly will most likely need to be restarted with<code class=" "> :shutdown(restart=true)</code></p>
        </div>
    </div>
    </div>
    <div class="section section-1" id="src-16233903_safe-id-aWQtLldpbGRmbHk4djYuMTQuMC1PcHRpb25hbDpFbmFibGVBSlBDb25uZWN0b3I">
        <h1 class="heading "><span>Optional: Enable AJP Connector</span></h1>
<p   
>Only needed if you run an Apache front-end in front of WildFly.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem</code><code class="plain">=undertow</code><code class="plain">/server</code><code class="plain">=default-server</code><code class="plain">/ajp-listener</code><code class="plain">=ajp-listener:add(socket-binding=ajp, scheme=https, enabled=</code><code class="functions">true</code><code class="plain">)</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-16233903_safe-id-aWQtLldpbGRmbHk4djYuMTQuMC1PcHRpb25hbDpBZGRTdXBwb3J0Zm9yUEtDUyMxMShIU01zKQ">
        <h1 class="heading "><span>Optional: Add Support for PKCS#11 (HSMs)</span></h1>
<p   
>WildFly by default isolates most sun classes. EJBCA configures JBoss/WildFly to expose these classes (<strong class=" ">sun/security/pkcs11/wrapper</strong>) by using a <strong class=" ">jboss-deployment-structure.xml</strong>. This makes configuration in <strong class=" ">modules/system/layers/base/sun/jdk/main/module.xml</strong> not needed.</p>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="WildFly_12___JBoss_EAP_7.1.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>WildFly 12 / JBoss EAP 7.1</span>
        </a>
                <a href="Wildfly_9.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Wildfly 9</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

</body>
</html>
