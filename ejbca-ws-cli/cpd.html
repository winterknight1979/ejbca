<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.1 from org.apache.maven.plugins:maven-pmd-plugin:3.13.0:cpd at 2020-09-29
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.1" />
    <title>EJBCA Webservices CLI &#x2013; CPD Results</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>EJBCA Webservices CLI</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-09-29<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0.0-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-down"></span>Project Reports</a>
     <ul class="nav nav-list">
      <li><a href="checkstyle.html" title="Checkstyle"><span class="none"></span>Checkstyle</a></li>
      <li><a href="spotbugs.html" title="SpotBugs"><span class="none"></span>SpotBugs</a></li>
      <li class="active"><a href="#"><span class="none"></span>CPD</a></li>
      <li><a href="pmd.html" title="PMD"><span class="none"></span>PMD</a></li>
      <li><a href="surefire-report.html" title="Surefire Report"><span class="none"></span>Surefire Report</a></li>
      <li><a href="jacoco/index.html" title="JaCoCo"><span class="none"></span>JaCoCo</a></li>
     </ul></li>
   <li class="nav-header">Parent Project</li>
    <li><a href="../index.html" title="EJB-CA"><span class="none"></span>EJB-CA</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<section>
<h2><a name="CPD_Results"></a>CPD Results</h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">CPD</a> 6.21.0.</p></section><section>
<h2><a name="Duplications"></a>Duplications</h2>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByIssuerCommand.java</td>
<td>74</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByTypeCommand.java</td>
<td>74</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesCommand.java</td>
<td>72</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                    getPrintStream().println(&quot;No certificate will expire within &quot; + days + &quot; days and are issued by &quot; + issuerDN);
                }else{
                    getPrintStream().println(result.size() + &quot; certificate found, written to &quot; + outputPath);
                    Iterator&lt;Certificate&gt; iter = result.iterator();
                    int i=0;
                    while(iter.hasNext()){
                        i++;
                        Certificate cert = iter.next();
                        if(encoding.equals(&quot;DER&quot;)){
                            FileOutputStream fos = new FileOutputStream(outputPath + &quot;/&quot; + &quot;cert-&quot; + i +&quot;.cer&quot;);
                            fos.write(CertificateHelper.getCertificate(cert.getCertificateData()).getEncoded());
                            fos.close();
                        }else{
                            FileOutputStream fos = new FileOutputStream(outputPath + &quot;/&quot; + &quot;cert-&quot; + i +&quot;.pem&quot;);
                            ArrayList&lt;java.security.cert.Certificate&gt; list = new ArrayList&lt;java.security.cert.Certificate&gt;();
                            list.add(CertificateHelper.getCertificate(cert.getCertificateData()));
                            fos.write(CertTools.getPemFromCertificateChain(list));
                            fos.close();                                                        
                        }                        
                    }
                }
                             
            }catch(AuthorizationDeniedException_Exception e){
                getPrintStream().println(&quot;Error : &quot; + e.getMessage());
            }           
        } catch (Exception e) {
            ErrorAdminCommandException adminexp = new ErrorAdminCommandException(e);
            getPrintStream().println(&quot;Error: &quot; + adminexp.getLocalizedMessage());
        }
    }

    private String getOutputPath(String outputpath) {
        File dir = new File(outputpath);
        if(!dir.exists()){
            getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
            System.exit(-1); // NOPMD, it's not a JEE app
        }
        if(!dir.isDirectory()){
            getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
            System.exit(-1); // NOPMD, it's not a JEE app           
        }
        if(!dir.canWrite()){
            getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
            System.exit(-1); // NOPMD, it's not a JEE app

        }
        return outputpath;
    }

    private String getEncoding(String encoding) {
        if(!encoding.equalsIgnoreCase(&quot;PEM&quot;) &amp;&amp; !encoding.equalsIgnoreCase(&quot;DER&quot;)){
            usage();
            System.exit(-1); // NOPMD, it's not a JEE app
        }
        
        return encoding.toUpperCase();
    }

    protected void usage() {
        getPrintStream().println(&quot;Command used to find certificates that will expire within a specified number of days and are issued by a specific CA&quot;);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>158</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/PKCS10ReqCommand.java</td>
<td>82</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>             	CertificateResponse result = getEjbcaRAWS().pkcs10Request(username,password,pkcs10,hardtokensn,CertificateHelper.RESPONSETYPE_CERTIFICATE);
            	
            	if(result==null){
            		getPrintStream().println(&quot;No certificate could be generated for user, check server logs for error.&quot;);
            	}else{
            		String filepath = username;
            		if(encoding.equals(&quot;DER&quot;)){
            			filepath += &quot;.cer&quot;;
            		}else{
            			filepath += &quot;.pem&quot;;
            		}
            		if(outputPath != null){
            			filepath = outputPath + &quot;/&quot; + filepath;
            		}
            		
            		
            		if(encoding.equals(&quot;DER&quot;)){
            			FileOutputStream fos = new FileOutputStream(filepath);
            			fos.write(CertificateHelper.getCertificate(result.getData()).getEncoded());
            			fos.close();
            		}else{
            			FileOutputStream fos = new FileOutputStream(filepath);
            			ArrayList&lt;java.security.cert.Certificate&gt; list = new ArrayList&lt;java.security.cert.Certificate&gt;();
            			list.add(CertificateHelper.getCertificate(result.getData()));
            			fos.write(CertTools.getPemFromCertificateChain(list));
            			fos.close();            				            				
            		}
            		getPrintStream().println(&quot;Certificate generated, written to &quot; + filepath);
            	}
            }catch(AuthorizationDeniedException_Exception e){
            	getPrintStream().println(&quot;Error : &quot; + e.getMessage());
            }catch(UserDoesntFullfillEndEntityProfile_Exception e){</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/CertificateRequestCommand.java</td>
<td>117</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/PKCS10ReqCommand.java</td>
<td>88</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            		if(encoding.equals(&quot;DER&quot;)){
            			filepath += &quot;.cer&quot;;
            		}else{
            			filepath += &quot;.pem&quot;;
            		}
            		if(outputPath != null){
            			filepath = outputPath + &quot;/&quot; + filepath;
            		}
            		
            		
            		if(encoding.equals(&quot;DER&quot;)){
            			FileOutputStream fos = new FileOutputStream(filepath);
            			fos.write(CertificateHelper.getCertificate(result.getData()).getEncoded());
            			fos.close();
            		}else{
            			FileOutputStream fos = new FileOutputStream(filepath);
            			ArrayList&lt;java.security.cert.Certificate&gt; list = new ArrayList&lt;java.security.cert.Certificate&gt;();
            			list.add(CertificateHelper.getCertificate(result.getData()));
            			fos.write(CertTools.getPemFromCertificateChain(list));
            			fos.close();            				            				
            		}
            		getPrintStream().println(&quot;Certificate generated, written to &quot; + filepath);
            	}
            	             

            }catch(AuthorizationDeniedException_Exception e){
            	getPrintStream().println(&quot;Error : &quot; + e.getMessage());            
            }
        } catch (Exception e) {
            throw new ErrorAdminCommandException(e);
        }
    }



	

	private String getHardTokenSN(String hardtokensn) {
		if(hardtokensn.equalsIgnoreCase(&quot;NONE&quot;)){
		  return null;
		}
		
		return hardtokensn;
	}

	private String getRequestData(String regestDataPath) {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>234</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/PKCS10ReqCommand.java</td>
<td>141</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>			getPrintStream().println(&quot;Error : PKCS10 file could not found.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app		
		} catch (IOException e) {
			getPrintStream().println(&quot;Error reading content of PKCS10 file.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app	
		}
		
		
		return retval;
	}

	private String getOutputPath(String outputpath) {
		File dir = new File(outputpath);
		if(!dir.exists()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		if(!dir.isDirectory()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app			
		}
		if(!dir.canWrite()){
			getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app

		}
		return outputpath;
	}

	private String getEncoding(String encoding) {
		if(!encoding.equalsIgnoreCase(&quot;PEM&quot;) &amp;&amp; !encoding.equalsIgnoreCase(&quot;DER&quot;)){
			usage();
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		
		return encoding.toUpperCase();
	}


	protected void usage() {
		getPrintStream().println(&quot;Command used to add or edit userdata and to generate the certificate for the user. This command performs these two steps in a single command, but uses two WS calls to do it, editUser and pkcs10Request.&quot;);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/EditUserCommand.java</td>
<td>86</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>89</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            userdata.setPassword(pwd);
            userdata.setClearPwd(myArgs[ARG_CLEARPWD].equalsIgnoreCase(&quot;true&quot;));
            userdata.setSubjectDN(myArgs[ARG_SUBJECTDN]);
            if(!myArgs[ARG_SUBJECTALTNAME].equalsIgnoreCase(&quot;NULL&quot;)){                        
            	userdata.setSubjectAltName(myArgs[ARG_SUBJECTALTNAME]);
            }
            if(!myArgs[ARG_EMAIL].equalsIgnoreCase(&quot;NULL&quot;)){
            	userdata.setEmail(myArgs[ARG_EMAIL]);
            }
            userdata.setCaName(myArgs[ARG_CA]);
            userdata.setTokenType(myArgs[ARG_TOKEN]);
            userdata.setStatus(getStatus(myArgs[ARG_STATUS]));
            userdata.setEndEntityProfileName(myArgs[ARG_ENDENTITYPROFILE]);
            userdata.setCertificateProfileName(myArgs[ARG_CERTIFICATEPROFILE]);
            
            EndEntityType type = new EndEntityType(EndEntityTypes.getTypesFromHexCode(Integer.parseInt(myArgs[ARG_TYPE])));
            
            if(type.contains(EndEntityTypes.SENDNOTIFICATION)){
            	userdata.setSendNotification(true);
            }
            if(type.contains(EndEntityTypes.KEYRECOVERABLE)){
            	userdata.setKeyRecoverable(true);
            }

            if(myArgs.length &gt; ARG_ISSUERALIAS){</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/CertificateRequestCommand.java</td>
<td>117</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>164</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            		if(encoding.equals(&quot;DER&quot;)){
            			filepath += &quot;.cer&quot;;
            		}else{
            			filepath += &quot;.pem&quot;;
            		}
            		if(outputPath != null){
            			filepath = outputPath + &quot;/&quot; + filepath;
            		}
            		
            		
            		if(encoding.equals(&quot;DER&quot;)){
            			FileOutputStream fos = new FileOutputStream(filepath);
            			fos.write(CertificateHelper.getCertificate(result.getData()).getEncoded());
            			fos.close();
            		}else{
            			FileOutputStream fos = new FileOutputStream(filepath);
            			ArrayList&lt;java.security.cert.Certificate&gt; list = new ArrayList&lt;java.security.cert.Certificate&gt;();
            			list.add(CertificateHelper.getCertificate(result.getData()));
            			fos.write(CertTools.getPemFromCertificateChain(list));
            			fos.close();            				            				
            		}
            		getPrintStream().println(&quot;Certificate generated, written to &quot; + filepath);
            	}
            	             

            }catch(AuthorizationDeniedException_Exception e){
            	getPrintStream().println(&quot;Error : &quot; + e.getMessage());            
            }</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/CvcPemCommand.java</td>
<td>107</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/CvcPrintCommand.java</td>
<td>104</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>		} catch (Exception e) {
			throw new ErrorAdminCommandException(e);
		}
	}

	protected static CVCObject getCVCObject(String filename) throws IOException, CvcException, CertificateException {
		CVCObject ret = null;
		try {
			byte[] cvcdata = FileTools.readFiletoBuffer(filename);				
			ret = CertificateParser.parseCVCObject(cvcdata);
		} catch (Exception e) {
			try {
				// this was not parseable, try to see it it was a PEM certificate
				Collection&lt;Certificate&gt; col = CertTools.getCertsFromPEM(filename, Certificate.class);
				Certificate cert = (Certificate)col.iterator().next();
	        	ret = CertificateParser.parseCVCObject(cert.getEncoded());			
			} catch (Exception ie) {
				// this was not a PEM cert, try to see it it was a PEM certificate req
				byte[] cvcdata = FileTools.readFiletoBuffer(filename);				
				byte[] req = RequestMessageUtils.getRequestBytes(cvcdata);
				ret = CertificateParser.parseCVCObject(req);
			}
		}
		return ret;
	}

	protected void usage() {
		getPrintStream().println(&quot;Command used to convert between binary and PEM formats.&quot;);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/RevokeCertCommand.java</td>
<td>72</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/RevokeCertWithMetadataCommand.java</td>
<td>76</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>					getEjbcaRAWS().revokeCertBackdated(issuerdn,certsn,reason,time);
					getPrintStream().println(&quot;Certificate revoked (or unrevoked) successfully.&quot;);
				} else {
					getPrintStream().println(&quot;Certificate does not exist.&quot;);
				}
			} catch (AuthorizationDeniedException_Exception e) {
				getPrintStream().println(&quot;Error : &quot; + e.getMessage());
			} catch (AlreadyRevokedException_Exception e) {
				getPrintStream().println(&quot;The certificate was already revoked, or you tried to unrevoke a permanently revoked certificate.&quot;);
			} catch (WaitingForApprovalException_Exception e) {
				getPrintStream().println(&quot;The revocation request has been sent for approval.&quot;);
			} catch (ApprovalException_Exception e) {
				getPrintStream().println(&quot;This revocation has already been requested.&quot;);
			} catch (DateNotValidException_Exception e) {
				getPrintStream().println(e.getMessage());
				getPrintStream().println(justRevoke);
			} catch (RevokeBackDateNotAllowedForProfileException_Exception e) {
				getPrintStream().println(e.getMessage());
				getPrintStream().println(justRevoke);
			}
		} catch (Exception e) {
			throw new ErrorAdminCommandException(e);
		}
	}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>243</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByIssuerCommand.java</td>
<td>103</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByTypeCommand.java</td>
<td>103</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesCommand.java</td>
<td>101</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/PKCS10ReqCommand.java</td>
<td>150</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>	}

	private String getOutputPath(String outputpath) {
		File dir = new File(outputpath);
		if(!dir.exists()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		if(!dir.isDirectory()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app			
		}
		if(!dir.canWrite()){
			getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app

		}
		return outputpath;
	}

	private String getEncoding(String encoding) {
		if(!encoding.equalsIgnoreCase(&quot;PEM&quot;) &amp;&amp; !encoding.equalsIgnoreCase(&quot;DER&quot;)){
			usage();
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		
		return encoding.toUpperCase();
	}


	protected void usage() {
		getPrintStream().println(&quot;Command used to add or edit userdata and to generate the certificate for the user. This command performs these two steps in a single command, but uses two WS calls to do it, editUser and pkcs10Request.&quot;);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/CertificateRequestCommand.java</td>
<td>174</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>237</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/PKCS10ReqCommand.java</td>
<td>144</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>			getPrintStream().println(&quot;Error reading content of request data file.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app	
		}
		
		
		return retval;
	}

	private String getOutputPath(String outputpath) {
		File dir = new File(outputpath);
		if(!dir.exists()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		if(!dir.isDirectory()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app			
		}
		if(!dir.canWrite()){
			getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app

		}
		return outputpath;
	}

	private String getEncoding(String encoding) {
		if(!encoding.equalsIgnoreCase(&quot;PEM&quot;) &amp;&amp; !encoding.equalsIgnoreCase(&quot;DER&quot;)){
			usage();
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		
		return encoding.toUpperCase();
	}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/EditUserCommand.java</td>
<td>175</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>187</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            }catch(AuthorizationDeniedException_Exception e){
            	getPrintStream().println(&quot;Error : &quot; + e.getMessage());
            }catch(UserDoesntFullfillEndEntityProfile_Exception e){
            	getPrintStream().println(&quot;Error : Given userdata doesn't fulfill end entity profile. : &quot; +  e.getMessage());
            }
                      
        } catch (Exception e) {
            throw new ErrorAdminCommandException(e);
        }
    }
    private int getStatus(String status) {
		if(status.equalsIgnoreCase(&quot;NEW&quot;)){
			return EndEntityConstants.STATUS_NEW;
		}
		if(status.equalsIgnoreCase(&quot;INPROCESS&quot;)){
			return EndEntityConstants.STATUS_INPROCESS;
		}
		if(status.equalsIgnoreCase(&quot;FAILED&quot;)){
			return EndEntityConstants.STATUS_FAILED;
		}
		if(status.equalsIgnoreCase(&quot;HISTORICAL&quot;)){
			return EndEntityConstants.STATUS_HISTORICAL;
		}		
		
		getPrintStream().println(&quot;Error in status string : &quot; + status );
		usage();
		System.exit(-1); // NOPMD, this is not a JEE app
		return 0;
	}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/EditUserCommand.java</td>
<td>126</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>124</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            getPrintStream().println(&quot;Trying to add user:&quot;);
            getPrintStream().println(&quot;Username: &quot;+userdata.getUsername());
            getPrintStream().println(&quot;Subject DN: &quot;+userdata.getSubjectDN());
            getPrintStream().println(&quot;Subject Altname: &quot;+userdata.getSubjectAltName());
            getPrintStream().println(&quot;Email: &quot;+userdata.getEmail());
            getPrintStream().println(&quot;CA Name: &quot;+userdata.getCaName());                        
            getPrintStream().println(&quot;Type: &quot;+type.getHexValue());
            getPrintStream().println(&quot;Token: &quot;+userdata.getTokenType());
            getPrintStream().println(&quot;Status: &quot;+userdata.getStatus());
            getPrintStream().println(&quot;End entity profile: &quot;+userdata.getEndEntityProfileName());
            getPrintStream().println(&quot;Certificate profile: &quot;+userdata.getCertificateProfileName());</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/FindCertsCommand.java</td>
<td>98</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByIssuerCommand.java</td>
<td>101</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByTypeCommand.java</td>
<td>101</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesCommand.java</td>
<td>99</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            throw new ErrorAdminCommandException(e);
        }
    }



	

	private String getOutputPath(String outputpath) {
		File dir = new File(outputpath);
		if(!dir.exists()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		if(!dir.isDirectory()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app			
		}
		if(!dir.canWrite()){
			getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app

		}
		return outputpath;
	}

	private String getEncoding(String encoding) {
		if(!encoding.equalsIgnoreCase(&quot;PEM&quot;) &amp;&amp; !encoding.equalsIgnoreCase(&quot;DER&quot;)){
			usage();
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		
		return encoding.toUpperCase();
	}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/CertificateRequestCommand.java</td>
<td>180</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/FindCertsCommand.java</td>
<td>100</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>	}

	private String getOutputPath(String outputpath) {
		File dir = new File(outputpath);
		if(!dir.exists()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		if(!dir.isDirectory()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app			
		}
		if(!dir.canWrite()){
			getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app

		}
		return outputpath;
	}

	private String getEncoding(String encoding) {
		if(!encoding.equalsIgnoreCase(&quot;PEM&quot;) &amp;&amp; !encoding.equalsIgnoreCase(&quot;DER&quot;)){
			usage();
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		
		return encoding.toUpperCase();
	}

	private int getRequestType(String requestype) {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/CertificateRequestCommand.java</td>
<td>180</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByIssuerCommand.java</td>
<td>103</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByTypeCommand.java</td>
<td>103</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesCommand.java</td>
<td>101</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>	}

	private String getOutputPath(String outputpath) {
		File dir = new File(outputpath);
		if(!dir.exists()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		if(!dir.isDirectory()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app			
		}
		if(!dir.canWrite()){
			getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app

		}
		return outputpath;
	}

	private String getEncoding(String encoding) {
		if(!encoding.equalsIgnoreCase(&quot;PEM&quot;) &amp;&amp; !encoding.equalsIgnoreCase(&quot;DER&quot;)){
			usage();
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		
		return encoding.toUpperCase();
	}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/FindCertsCommand.java</td>
<td>100</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>243</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/PKCS10ReqCommand.java</td>
<td>150</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }



	

	private String getOutputPath(String outputpath) {
		File dir = new File(outputpath);
		if(!dir.exists()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		if(!dir.isDirectory()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app			
		}
		if(!dir.canWrite()){
			getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app

		}
		return outputpath;
	}

	private String getEncoding(String encoding) {
		if(!encoding.equalsIgnoreCase(&quot;PEM&quot;) &amp;&amp; !encoding.equalsIgnoreCase(&quot;DER&quot;)){
			usage();
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		
		return encoding.toUpperCase();
	}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/EditUserCommand.java</td>
<td>153</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>136</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            {
            	final List&lt;ExtendedInformationWS&gt; eil = userdata.getExtendedInformation();
            	if ( eil!=null ) {
            		getPrintStream().println(&quot;Extended information:&quot;);
            		for ( ExtendedInformationWS ei : eil ) {
            			getPrintStream().println(&quot;	'&quot;+ei.getName()+&quot;' = '&quot;+ei.getValue()+&quot;'&quot;);
            		}
            	}
            }
            {
            	final BigInteger bi = userdata.getCertificateSerialNumber();
            	if ( bi!=null ) {
                    getPrintStream().println(ParseUserData.certificateSerialNumber+&quot;=0x&quot;+bi.toString(16));
            	}
            }
            
           try{
            	getEjbcaRAWS().editUser(userdata);

            	
            	getPrintStream().println(&quot;User '&quot;+userdata.getUsername()+&quot;' has been added/edited.&quot;);
            	getPrintStream().println();              </pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/FindCertsCommand.java</td>
<td>95</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/KeyRecoverEnrollCommand.java</td>
<td>115</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            	getPrintStream().println(&quot;Error : &quot; + e.getMessage());
            }           
        } catch (Exception e) {
            throw new ErrorAdminCommandException(e);
        }
    }



	

	private String getOutputPath(String outputpath) {
		File dir = new File(outputpath);
		if(!dir.exists()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app
		}
		if(!dir.isDirectory()){
			getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app			
		}
		if(!dir.canWrite()){
			getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
			System.exit(-1); // NOPMD, it's not a JEE app

		}
		return outputpath;
	}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/StressTestCommand.java</td>
<td>377</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/StressTestCommand.java</td>
<td>432</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>		}
		@Override
		public boolean doIt() throws Exception {
			if ( this.doCreateNewUser ) {
				this.jobData.passWord = &quot;foo123&quot;;
				this.jobData.userName = &quot;WSTESTUSER&quot;+StressTestCommand.this.performanceTest.nextLong();
			}
			if ( this.bitsInCertificateSN&gt;0 &amp;&amp; this.doCreateNewUser ) {
				this.user.setCertificateSerialNumber(new BigInteger(this.bitsInCertificateSN, StressTestCommand.this.performanceTest.getRandom()));
			}
			this.user.setSubjectDN(this.jobData.getDN());
			this.user.setUsername(this.jobData.userName);
			this.user.setPassword(this.jobData.passWord);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/StressTestCommand.java</td>
<td>363</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/StressTestCommand.java</td>
<td>412</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>						JobData _jobData, boolean _doCreateNewUser, int _bitsInCertificateSN) {
			super(_jobData);
			this.doCreateNewUser = _doCreateNewUser;
			this.ejbcaWS = _ejbcaWS;
			this.user = new UserDataVOWS();
			this.user.setClearPwd(true);
			this.user.setCaName(caName);
			this.user.setEmail(null);
			this.user.setSubjectAltName(null);
			this.user.setStatus(EndEntityConstants.STATUS_NEW);
			this.user.setTokenType(org.ejbca.core.protocol.ws.objects.UserDataVOWS.TOKEN_TYPE_USERGENERATED);
			this.user.setEndEntityProfileName(endEntityProfileName);
			this.user.setCertificateProfileName(certificateProfileName);
			this.bitsInCertificateSN = _bitsInCertificateSN;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/AddSubjectToRoleCommand.java</td>
<td>83</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/RemoveSubjectFromRoleCommand.java</td>
<td>83</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        getPrintStream().println(&quot;Usage : addadmintorole &lt;rolename&gt; &lt;caname&gt; &lt;matchwith&gt; &lt;matchtype&gt; &lt;matchvalue&gt;&quot;);
        getPrintStream().println();
        
        String availableMatchers = &quot;&quot;;
        for (AccessMatchValue currentMatchWith : X500PrincipalAccessMatchValue.values()) {
            availableMatchers += (availableMatchers.length() == 0 ? &quot;&quot; : &quot;, &quot;) + currentMatchWith;
        }
        getPrintStream().println(&quot;Matchwith can be: &quot; + availableMatchers);
        getPrintStream().println();
        String availableMatchTypes = &quot;&quot;;
        for (AccessMatchType currentMatchType : AccessMatchType.values()) {
            availableMatchTypes += (availableMatchTypes.length() == 0 ? &quot;&quot; : &quot;, &quot;) + currentMatchType;
        }
        getPrintStream().println(&quot;Matchtype can be: &quot; + availableMatchTypes);
    }
}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/AddSubjectToRoleCommand.java</td>
<td>68</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/RemoveSubjectFromRoleCommand.java</td>
<td>68</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            getEjbcaRAWS().addSubjectToRole(rolename, caname, matchwith, matchtype, matchvalue);
            getPrintStream().println(&quot;Added admin to &quot; + rolename + &quot; successfully&quot;);
        } catch (Exception e) {
            if (e instanceof EjbcaException_Exception) {
                EjbcaException_Exception e1 = (EjbcaException_Exception)e;
                getPrintStream().println(&quot;Error code: &quot; + e1.getFaultInfo().getErrorCode().getInternalErrorCode());
            }
            ErrorAdminCommandException adminexp = new ErrorAdminCommandException(e);
            getPrintStream().println(&quot;Error message: &quot; + adminexp.getLocalizedMessage());
        }
    }

    protected void usage() {
        
        getPrintStream().println(&quot;Command used to add an administrator to an existing role&quot;);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/EditUserCommand.java</td>
<td>40</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GenerateNewUserCommand.java</td>
<td>44</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>public class EditUserCommand extends EJBCAWSRABaseCommand implements IAdminCommand{

	
	private static final int ARG_USERNAME           = 1;
	private static final int ARG_PASSWORD           = 2;
	private static final int ARG_CLEARPWD           = 3;
	private static final int ARG_SUBJECTDN          = 4;
	private static final int ARG_SUBJECTALTNAME     = 5;
	private static final int ARG_EMAIL              = 6;
	private static final int ARG_CA                 = 7;
	private static final int ARG_TYPE               = 8;
	private static final int ARG_TOKEN              = 9;
	private static final int ARG_STATUS             = 10;
	private static final int ARG_ENDENTITYPROFILE   = 11;
	private static final int ARG_CERTIFICATEPROFILE = 12;
	private static final int ARG_ISSUERALIAS        = 13;
	private static final int ARG_STARTTIME          = 14;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByIssuerCommand.java</td>
<td>101</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesByTypeCommand.java</td>
<td>101</td></tr>
<tr class="b">
<td>org/ejbca/core/protocol/ws/client/GetExpiredCertificatesCommand.java</td>
<td>99</td></tr>
<tr class="a">
<td>org/ejbca/core/protocol/ws/client/KeyRecoverEnrollCommand.java</td>
<td>119</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            getPrintStream().println(&quot;Error: &quot; + adminexp.getLocalizedMessage());
        }
    }

    private String getOutputPath(String outputpath) {
        File dir = new File(outputpath);
        if(!dir.exists()){
            getPrintStream().println(&quot;Error : Output directory doesn't seem to exist.&quot;);
            System.exit(-1); // NOPMD, it's not a JEE app
        }
        if(!dir.isDirectory()){
            getPrintStream().println(&quot;Error : Output directory doesn't seem to be a directory.&quot;);
            System.exit(-1); // NOPMD, it's not a JEE app           
        }
        if(!dir.canWrite()){
            getPrintStream().println(&quot;Error : Output directory isn't writeable.&quot;);
            System.exit(-1); // NOPMD, it's not a JEE app

        }
        return outputpath;
    }</pre></div></td></tr></table></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2020
</p>
        </div>
      </div>
    </footer>
  </body>
</html>