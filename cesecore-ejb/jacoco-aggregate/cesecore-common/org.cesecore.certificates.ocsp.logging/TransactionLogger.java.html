<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>TransactionLogger.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">cesecore-ejb</a> &gt; <a href="../index.html" class="el_bundle">cesecore-common</a> &gt; <a href="index.source.html" class="el_package">org.cesecore.certificates.ocsp.logging</a> &gt; <span class="el_source">TransactionLogger.java</span></div><h1>TransactionLogger.java</h1><pre class="source lang-java linenums">/*************************************************************************
 *                                                                       *
 *  CESeCore: CE Security Core                                           *
 *                                                                       *
 *  This software is free software; you can redistribute it and/or       *
 *  modify it under the terms of the GNU Lesser General Public           *
 *  License as published by the Free Software Foundation; either         *
 *  version 2.1 of the License, or any later version.                    *
 *                                                                       *
 *  See terms of license at gnu.org.                                     *
 *                                                                       *
 *************************************************************************/
package org.cesecore.certificates.ocsp.logging;

import org.cesecore.certificates.certificateprofile.CertificateProfileConstants;
import org.cesecore.certificates.crl.RevocationReasons;
import org.cesecore.config.OcspConfiguration;

/**
 * OCSP transaction logger.
 * 
 * @version $Id: TransactionLogger.java 25218 2017-02-08 13:45:12Z anatom $
 *
 */
public class TransactionLogger extends PatternLogger {

    private static final long serialVersionUID = 1722398387512931482L;
    /**
     * The BC normalized subject Distinguished Name of the client making the request
     */
    public static final String REQ_NAME = &quot;REQ_NAME&quot;;
    /** 
     * The Unnormalized subject Distinguished Name of the client making the request
     */
    public static final String REQ_NAME_RAW = &quot;REQ_NAME_RAW&quot;;
    /**
     * The BC normalized issuer Distinguished Name of the certificate used to sign the request.
     */
    public static final String SIGN_ISSUER_NAME_DN = &quot;SIGN_ISSUER_NAME_DN&quot;;
    /**
     * The BC normalized Subject Distinguished Name of the certificate used to sign the request.
     */
    public static final String SIGN_SUBJECT_NAME = &quot;SIGN_SUBJECT_NAME&quot;;
    /**
     * Certificate serial number of the certificate used to sign the request.
     */
    public static final String SIGN_SERIAL_NO = &quot;SIGN_SERIAL_NO&quot;;
    /**
     * The BC normalized issuer Distinguished Name of the requested certificate
     */
    public static final String ISSUER_NAME_DN = &quot;ISSUER_NAME_DN&quot;;
    /**
     * The unnormalized issuer Distinguished Name of the requested certificate
     */
    public static final String ISSUER_NAME_DN_RAW = &quot;ISSUER_NAME_DN_RAW&quot;;
    
    /**
     * Algorithm used by requested certificate to hash issuer key and issuer name
     */
    public static final String DIGEST_ALGOR = &quot;DIGEST_ALGOR&quot;;
    
    /**
     * The number of certificates to check revocation status for
     */
    public static final String NUM_CERT_ID = &quot;NUM_CERT_ID&quot;;

    /**
     * The requested certificate revocation status, 0=good, 1=revoked, 2=unknown (see OCSPResponseItem).
     */
    public static final String CERT_STATUS = &quot;CERT_STATUS&quot;;

    /**
     * The requested certificate revocation reason, or NOT_REVOKED, if unrevoked (see RevocationReasons).
     * Set to 6 (certificateHold) when certificate is unknown, even if status returned is good.
     */
    public static final String REV_REASON = &quot;REV_REASON&quot;;

    /** The id of the certificate profile that was used to issue the requested certificate. */
    public static final String CERT_PROFILE_ID = &quot;CERT_PROFILE_ID&quot;;

    /** The HTTP X-Forwarded-For header value. */
    public static final String FORWARDED_FOR = &quot;FORWARDED_FOR&quot;;

    public TransactionLogger(Integer logId, String sessionId, String clientIp) {
<span class="fc" id="L85">        super(OcspConfiguration.getTransactionLog(), TransactionLogger.class, OcspConfiguration.getTransactionLogPattern(),</span>
<span class="fc" id="L86">                OcspConfiguration.getTransactionLogOrder(), OcspConfiguration.getLogDateFormat(), OcspConfiguration.getLogTimeZone());</span>
<span class="fc" id="L87">        paramPut(PatternLogger.LOG_ID, logId);</span>
<span class="fc" id="L88">        paramPut(PatternLogger.SESSION_ID, sessionId);</span>
<span class="fc" id="L89">        paramPut(PatternLogger.CLIENT_IP, clientIp);</span>
<span class="fc" id="L90">        paramPut(PatternLogger.STATUS, &quot;0&quot;);</span>
<span class="fc" id="L91">        paramPut(REQ_NAME, &quot;0&quot;);</span>
<span class="fc" id="L92">        paramPut(REQ_NAME_RAW, &quot;0&quot;);</span>
<span class="fc" id="L93">        paramPut(SIGN_ISSUER_NAME_DN, &quot;0&quot;);</span>
<span class="fc" id="L94">        paramPut(SIGN_SUBJECT_NAME, &quot;0&quot;);</span>
<span class="fc" id="L95">        paramPut(SIGN_SERIAL_NO, &quot;0&quot;);</span>
<span class="fc" id="L96">        paramPut(NUM_CERT_ID, &quot;0&quot;);</span>
<span class="fc" id="L97">        paramPut(ISSUER_NAME_DN, &quot;0&quot;);</span>
<span class="fc" id="L98">        paramPut(ISSUER_NAME_DN_RAW, &quot;0&quot;);</span>
<span class="fc" id="L99">        paramPut(PatternLogger.ISSUER_NAME_HASH, &quot;0&quot;);</span>
<span class="fc" id="L100">        paramPut(PatternLogger.ISSUER_KEY, &quot;0&quot;);</span>
<span class="fc" id="L101">        paramPut(DIGEST_ALGOR, &quot;0&quot;);</span>
<span class="fc" id="L102">        paramPut(PatternLogger.SERIAL_NOHEX, &quot;0&quot;);</span>
<span class="fc" id="L103">        paramPut(CERT_STATUS, &quot;0&quot;);</span>
<span class="fc" id="L104">        paramPut(PatternLogger.PROCESS_TIME, &quot;-1&quot;);</span>
<span class="fc" id="L105">        paramPut(CERT_PROFILE_ID, String.valueOf(CertificateProfileConstants.CERTPROFILE_NO_PROFILE));</span>
<span class="fc" id="L106">        paramPut(FORWARDED_FOR, &quot;&quot;);</span>
<span class="fc" id="L107">        paramPut(REV_REASON, String.valueOf(RevocationReasons.NOT_REVOKED.getDatabaseValue()));</span>
<span class="fc" id="L108">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>